<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="What&#39;s new in Celery 2.5" href="whatsnew-2.5.html" /><link rel="prev" title="What&#39;s new in Celery 3.0 (Chiastic Slide)" href="whatsnew-3.0.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Change history for Celery 3.0 - Celery 5.5.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css?v=112ca36d" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Celery 5.5.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/celery_512_1.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Celery 5.5.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">版权</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">快速开始</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 快速开始</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/introduction.html">Celery 简介</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/backends-and-brokers/index.html">Backends 和 Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Backends 和 Brokers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/rabbitmq.html">使用 RabbitMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/redis.html">使用 Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/sqs.html">使用 Amazon SQS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/kafka.html">使用 Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/gcpubsub.html">使用 Google Pub/Sub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/first-steps-with-celery.html">使用 Celery 的第一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/next-steps.html">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/resources.html">资源</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../userguide/index.html">用户指南</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 用户指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../userguide/application.html">应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/tasks.html">任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/calling.html">调用任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/canvas.html">Canvas：设计工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/workers.html">Workers 指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/daemonizing.html">守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/periodic-tasks.html">周期性任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/routing.html">路由任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/monitoring.html">监控和管理指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/optimizing.html">优化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/debugging.html">调试</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../userguide/concurrency/index.html">并发</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 并发</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/eventlet.html">Eventlet 并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/gevent.html">gevent 并发</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/signals.html">信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/testing.html">使用 Celery 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/extending.html">扩展 和 Bootsteps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/configuration.html">配置和默认值</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/sphinx.html">使用 Sphinx 文档化任务</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../django/index.html">Django</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Django</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../django/first-steps-with-django.html">使用 Django 的第一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">社区资源</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/task-cookbook.html">Task Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">更改历史</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API 参考</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API 参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">命令行接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code> --- Distributed processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html">Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.task.html"><code class="docutils literal notranslate"><span class="pre">celery.app.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html">AMQP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html#queues">Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.defaults.html"><code class="docutils literal notranslate"><span class="pre">celery.app.defaults</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.control.html"><code class="docutils literal notranslate"><span class="pre">celery.app.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.registry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.registry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.app.backends</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.builtins.html"><code class="docutils literal notranslate"><span class="pre">celery.app.builtins</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.events.html"><code class="docutils literal notranslate"><span class="pre">celery.app.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.log.html"><code class="docutils literal notranslate"><span class="pre">celery.app.log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.app.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.autoretry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.autoretry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bootsteps.html"><code class="docutils literal notranslate"><span class="pre">celery.bootsteps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.result.html"><code class="docutils literal notranslate"><span class="pre">celery.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.schedules.html"><code class="docutils literal notranslate"><span class="pre">celery.schedules</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.signals.html"><code class="docutils literal notranslate"><span class="pre">celery.signals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.security.html"><code class="docutils literal notranslate"><span class="pre">celery.security</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.utils.debug.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.debug</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.exceptions.html"><code class="docutils literal notranslate"><span class="pre">celery.exceptions</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.app.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.default.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.base.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html">States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#sets">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.FAILURE"><code class="docutils literal notranslate"><span class="pre">FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.PENDING"><code class="docutils literal notranslate"><span class="pre">PENDING</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RECEIVED"><code class="docutils literal notranslate"><span class="pre">RECEIVED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RETRY"><code class="docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.REVOKED"><code class="docutils literal notranslate"><span class="pre">REVOKED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.STARTED"><code class="docutils literal notranslate"><span class="pre">STARTED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.SUCCESS"><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.precedence"><code class="docutils literal notranslate"><span class="pre">precedence()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.abortable.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.django.task.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.django.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.pytest.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.pytest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.sphinx.html">celery.contrib.sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.app.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.manager.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.manager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.mocks.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.mocks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.rdb.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.html"><code class="docutils literal notranslate"><span class="pre">celery.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.receiver.html"><code class="docutils literal notranslate"><span class="pre">celery.events.receiver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.dispatcher.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.event.html"><code class="docutils literal notranslate"><span class="pre">celery.events.event</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.state.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.request.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.request</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.state.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.strategy.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.agent.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.connection.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.events.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.gossip.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.gossip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.heart.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.heart</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.mingle.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.mingle</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.tasks.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.tasks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.base.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.celery.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.celery</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.events.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.logtool.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.logtool</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.amqp.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.amqp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.graph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.call.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.call</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.control.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.list.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.list</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.purge.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.purge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.result.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.shell.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.shell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.upgrade.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.upgrade</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/index.html">内部</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/guide.html">代码贡献指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/deprecation.html">Celery 弃用时间表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/worker.html">内部的 worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/protocol.html">消息协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/app-overview.html">“大实例”重构</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../internals/reference/index.html">内部模块参考</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 内部模块参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.components.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.loops.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.loops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.heartbeat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.pidbox.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.pidbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.autoscale.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.autoscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.solo.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.solo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.eventlet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.gevent.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.gevent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.thread.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.base.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.backends</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.base.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.asynchronous.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.asynchronous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.azureblockblob.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.azureblockblob</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.rpc.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cache.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.consul.html">celery.backends.consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchdb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.mongodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.mongodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.elasticsearch.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.elasticsearch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.redis.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cassandra.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cassandra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchbase.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchbase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.arangodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.arangodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.dynamodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.dynamodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.filesystem.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.filesystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cosmosdbsql.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cosmosdbsql</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.s3.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.s3</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.gcs.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.gcs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.trace.html"><code class="docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.annotations.html"><code class="docutils literal notranslate"><span class="pre">celery.app.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.routes.html"><code class="docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.certificate.html"><code class="docutils literal notranslate"><span class="pre">celery.security.certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.key.html"><code class="docutils literal notranslate"><span class="pre">celery.security.key</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.security.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.security.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.snapshot.html"><code class="docutils literal notranslate"><span class="pre">celery.events.snapshot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.cursesmon.html"><code class="docutils literal notranslate"><span class="pre">celery.events.cursesmon</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.dumper.html"><code class="docutils literal notranslate"><span class="pre">celery.events.dumper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.models.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.session.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.session</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.abstract.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.abstract</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.collections.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.collections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.nodenames.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.nodenames</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.deprecated.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.deprecated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.functional.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.graph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.objects.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.term.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.term</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.time.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.iso8601.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.iso8601</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.saferepr.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.saferepr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.sysinfo.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.sysinfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.threads.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.timer2.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.timer2</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.imports.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.log.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.text.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch.signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.platforms.html"><code class="docutils literal notranslate"><span class="pre">celery.platforms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery._state.html"><code class="docutils literal notranslate"><span class="pre">celery._state</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">历史</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 历史</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.5.html">What's new in Celery 5.5 (Immunity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.5.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.4.html">What's new in Celery 5.4 (Opalescent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.3.html">What's new in Celery 5.3 (Emerald Rush)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.1.html">What's new in Celery 5.1 (Sun Harmonics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.0.html">What's new in Celery 5.0 (singularity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.4.html">What's new in Celery 4.4 (Cliffs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.3.html">What's new in Celery 4.3 (rhubarb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.2.html">What's new in Celery 4.2 (windowlicker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.2.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.1.html">What's new in Celery 4.1 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.0.html">What's new in Celery 4.0 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-3.1.html">What's new in Celery 3.1 (Cipater)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-3.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-3.0.html">What's new in Celery 3.0 (Chiastic Slide)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Change history for Celery 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-2.5.html">What's new in Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.5.html">Change history for Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.4.html">Change history for Celery 2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.3.html">Change history for Celery 2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.2.html">Change history for Celery 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.1.html">Change history for Celery 2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.0.html">Change history for Celery 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-1.0.html">Change history for Celery 1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

</div>
<!-- <iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe> -->
<div id="donate">
  <h5>捐赠</h5>
  <p>请捐赠以支持这个社区项目</p>
  <a href="https://opencollective.com/celery/donate" target="_blank">
    <!-- <img src="https://opencollective.com/celery/donate/button@2x.png?color=blue" /> -->
    <img src="https://opencollective.com/celery/donate/button.png?color=blue" />
  </a>
</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/history/changelog-3.0.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="change-history-for-celery-3-0">
<span id="changelog-3-0"></span><h1>Change history for Celery 3.0<a class="headerlink" href="#change-history-for-celery-3-0" title="Link to this heading">¶</a></h1>
<p>If you're looking for versions prior to 3.0.x you should go to <a class="reference internal" href="index.html#history"><span class="std std-ref">历史</span></a>.</p>
<section id="version-3-0-24">
<span id="id1"></span><h2>3.0.24<a class="headerlink" href="#version-3-0-24" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-10-11 04:40 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-15" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.5.15</span></a>.</p></li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> version 2.7.3.34.</p></li>
<li><p>AMQP Result backend:  No longer caches queue declarations.</p>
<blockquote>
<div><p>The queues created by the AMQP result backend are always unique,
so caching the declarations caused a slow memory leak.</p>
</div></blockquote>
</li>
<li><p>Worker: Fixed crash when hostname contained Unicode characters.</p>
<blockquote>
<div><p>Contributed by Daodao.</p>
</div></blockquote>
</li>
<li><p>The worker would no longer start if the <cite>-P solo</cite> pool was selected
(<span class="xref issue">Issue #1548</span>).</p></li>
<li><p>Redis/Cache result backends wouldn't complete chords
if any of the tasks were retried (<span class="xref issue">Issue #1401</span>).</p></li>
<li><p>Task decorator is no longer lazy if app is finalized.</p></li>
<li><p>AsyncResult: Fixed bug with <code class="docutils literal notranslate"><span class="pre">copy(AsyncResult)</span></code> when no
<code class="docutils literal notranslate"><span class="pre">current_app</span></code> available.</p></li>
<li><p>ResultSet: Now properly propagates app when passed string id's.</p></li>
<li><p>Loader now ignores <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_CONFIG_MODULE</span></code> if value is empty string.</p></li>
<li><p>Fixed race condition in Proxy object where it tried to
delete an attribute twice, resulting in <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#AttributeError" title="（在 Python v3.15）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code></a>.</p></li>
<li><p>Task methods now works with the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ALWAYS_EAGER</span></code> setting
(<span class="xref issue">Issue #1478</span>).</p></li>
<li><p><a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.common.html#kombu.common.Broadcast" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Broadcast</span></code></a> queues were accidentally declared
when publishing tasks (<span class="xref issue">Issue #1540</span>).</p></li>
<li><p>New <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">C_FAKEFORK</span></code> environment variable can be used to
debug the init-scripts.</p>
<blockquote>
<div><p>Setting this will skip the daemonization step so that errors
printed to stderr after standard outs are closed can be seen:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>C_FAKEFORK<span class="w"> </span>/etc/init.d/celeryd<span class="w"> </span>start
</pre></div>
</div>
<p>This works with the <cite>celery multi</cite> command in general.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_pickleable_etype</span></code> didn't always return a value (<span class="xref issue">Issue #1556</span>).</p></li>
<li><p>Fixed bug where <code class="docutils literal notranslate"><span class="pre">app.GroupResult.restore</span></code> would fall back to the default
app.</p></li>
<li><p>Fixed rare bug where built-in tasks would use the current_app.</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">maybe_fileno()</span></code> now handles <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#ValueError" title="（在 Python v3.15）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a>.</p></li>
</ul>
</section>
<section id="version-3-0-23">
<span id="id2"></span><h2>3.0.23<a class="headerlink" href="#version-3-0-23" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-09-02 01:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-14" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.5.14</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">send_task</span></code> didn't honor <code class="docutils literal notranslate"><span class="pre">link</span></code> and <code class="docutils literal notranslate"><span class="pre">link_error</span></code> arguments.</p>
<blockquote>
<div><p>This had the side effect of chains not calling unregistered tasks,
silently discarding them.</p>
<p>Fix contributed by Taylor Nelson.</p>
</div></blockquote>
</li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.state</span></code>: Optimized precedence lookup.</p>
<blockquote>
<div><p>Contributed by Matt Robenolt.</p>
</div></blockquote>
</li>
<li><p>POSIX: Daemonization didn't redirect <code class="docutils literal notranslate"><span class="pre">sys.stdin</span></code> to <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code>.</p>
<blockquote>
<div><p>Fix contributed by Alexander Smirnov.</p>
</div></blockquote>
</li>
<li><p>Canvas: group bug caused fallback to default app when <code class="docutils literal notranslate"><span class="pre">.apply_async</span></code> used
(<span class="xref issue">Issue #1516</span>)</p></li>
<li><p>Canvas: generator arguments wasn't always pickleable.</p></li>
</ul>
</section>
<section id="version-3-0-22">
<span id="id3"></span><h2>3.0.22<a class="headerlink" href="#version-3-0-22" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-08-16 04:30 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-13" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.5.13</span></a>.</p></li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> 2.7.3.32</p></li>
<li><p>Fixed bug with monthly and yearly Crontabs (<span class="xref issue">Issue #1465</span>).</p>
<blockquote>
<div><p>Fix contributed by Guillaume Gauvrit.</p>
</div></blockquote>
</li>
<li><p>Fixed memory leak caused by time limits (<span class="xref issue">Issue #1129</span>, <span class="xref issue">Issue #1427</span>)</p></li>
<li><p>Worker will now sleep if being restarted more than 5 times
in one second to avoid spamming with <code class="docutils literal notranslate"><span class="pre">worker-online</span></code> events.</p></li>
<li><p>Includes documentation fixes</p>
<blockquote>
<div><p>Contributed by: Ken Fromm, Andreas Savvides, Alex Kiriukha,
Michael Fladischer.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-21">
<span id="id4"></span><h2>3.0.21<a class="headerlink" href="#version-3-0-21" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-07-05 04:30 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> 2.7.3.31.</p>
<blockquote>
<div><p>This version fixed a bug when running without the billiard C extension.</p>
</div></blockquote>
</li>
<li><p>3.0.20 broke eventlet/gevent support (worker not starting).</p></li>
<li><p>Fixed memory leak problem when MongoDB result backend was used with the
gevent pool.</p>
<blockquote>
<div><p>Fix contributed by Ross Lawley.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-20">
<span id="id5"></span><h2>3.0.20<a class="headerlink" href="#version-3-0-20" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-06-28 04:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Contains workaround for deadlock problems.</p>
<blockquote>
<div><p>A better solution will be part of Celery 3.1.</p>
</div></blockquote>
</li>
<li><p>Now depends on <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-12" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.5.12</span></a>.</p></li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> 2.7.3.30.</p></li>
<li><p><a class="reference internal" href="../reference/cli.html#cmdoption-celery-loader"><code class="xref std std-option docutils literal notranslate"><span class="pre">--loader</span></code></a> argument no longer supported
importing loaders from the current directory.</p></li>
<li><p>[Worker] Fixed memory leak when restarting after connection lost
(<span class="xref issue">Issue #1325</span>).</p></li>
<li><p>[Worker] Fixed UnicodeDecodeError at start-up (<span class="xref issue">Issue #1373</span>).</p>
<blockquote>
<div><p>Fix contributed by Jessica Tallon.</p>
</div></blockquote>
</li>
<li><p>[Worker] Now properly rewrites unpickleable exceptions again.</p></li>
<li><p>Fixed possible race condition when evicting items from the revoked task set.</p></li>
<li><p>[generic-init.d] Fixed compatibility with Ubuntu's minimal Dash
shell (<span class="xref issue">Issue #1387</span>).</p>
<blockquote>
<div><p>Fix contributed by <a class="extlink-github_user reference external" href="https://github.com/monkut/">&#64;monkut</a>.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Task.apply</span></code>/<code class="docutils literal notranslate"><span class="pre">ALWAYS_EAGER</span></code> now also executes callbacks and errbacks
(<span class="xref issue">Issue #1336</span>).</p></li>
<li><p>[Worker] The <code class="xref std std-signal docutils literal notranslate"><span class="pre">worker-shutdown</span></code> signal was no longer being dispatched
(<span class="xref issue">Issue #1339</span>)j</p></li>
<li><p>[Python 3] Fixed problem with threading.Event.</p>
<blockquote>
<div><p>Fix contributed by Xavier Ordoquy.</p>
</div></blockquote>
</li>
<li><p>[Python 3] Now handles <code class="docutils literal notranslate"><span class="pre">io.UnsupportedOperation</span></code> that may be raised
by <code class="docutils literal notranslate"><span class="pre">file.fileno()</span></code> in Python 3.</p></li>
<li><p>[Python 3] Fixed problem with <code class="docutils literal notranslate"><span class="pre">qualname</span></code>.</p></li>
<li><p>[events.State] Now ignores unknown event-groups.</p></li>
<li><p>[MongoDB backend] No longer uses deprecated <code class="docutils literal notranslate"><span class="pre">safe</span></code> parameter.</p>
<blockquote>
<div><p>Fix contributed by <a class="extlink-github_user reference external" href="https://github.com/rfkrocktk/">&#64;rfkrocktk</a>.</p>
</div></blockquote>
</li>
<li><p>The eventlet pool now imports on Windows.</p></li>
<li><p>[Canvas] Fixed regression where immutable chord members may receive
arguments (<span class="xref issue">Issue #1340</span>).</p>
<blockquote>
<div><p>Fix contributed by Peter Brook.</p>
</div></blockquote>
</li>
<li><p>[Canvas] chain now accepts generator argument again (<span class="xref issue">Issue #1319</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery.migrate</span></code> command now consumes from all queues if no queues
specified.</p>
<blockquote>
<div><p>Fix contributed by John Watson.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-19">
<span id="id6"></span><h2>3.0.19<a class="headerlink" href="#version-3-0-19" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-04-17 04:30:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> 2.7.3.28</p></li>
<li><p>A Python 3 related fix managed to disable the deadlock fix
announced in 3.0.18.</p>
<blockquote>
<div><p>Tests have been added to make sure this doesn't happen again.</p>
</div></blockquote>
</li>
<li><p>Task retry policy:  Default max_retries is now 3.</p>
<blockquote>
<div><p>This ensures clients won't be hanging while the broker is down.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>You can set a longer retry for the worker by
using the <a class="reference internal" href="../userguide/signals.html#std-signal-celeryd_after_setup"><code class="xref std std-signal docutils literal notranslate"><span class="pre">celeryd_after_setup</span></code></a> signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_after_setup</span>

<span class="nd">@celeryd_after_setup</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_worker</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">CELERY_TASK_PUBLISH_RETRY_POLICY</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;max_retries&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;interval_start&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;interval_max&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;interval_step&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Worker: Will now properly display message body in error messages
even if the body is a buffer instance.</p></li>
<li><p>3.0.18 broke the MongoDB result backend (<span class="xref issue">Issue #1303</span>).</p></li>
</ul>
</section>
<section id="version-3-0-18">
<span id="id7"></span><h2>3.0.18<a class="headerlink" href="#version-3-0-18" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-04-12 05:00:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/kombu/">https://pypi.org/project/kombu/</a> 2.5.10.</p>
<blockquote>
<div><p>See the <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-10" title="（在 Kombu v5.5）"><span class="xref std std-ref">kombu changelog</span></a>.</p>
</div></blockquote>
</li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> 2.7.3.27.</p></li>
<li><p>Can now specify a white-list of accepted serializers using
the new <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ACCEPT_CONTENT</span></code> setting.</p>
<blockquote>
<div><p>This means that you can force the worker to discard messages
serialized with pickle and other untrusted serializers.
For example to only allow JSON serialized messages use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_ACCEPT_CONTENT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;json&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>you can also specify MIME types in the white-list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_ACCEPT_CONTENT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;application/json&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Fixed deadlock in multiprocessing's pool caused by the
semaphore not being released when terminated by signal.</p></li>
<li><p>Processes Pool: It's now possible to debug pool processes using GDB.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">report</span></code> now censors possibly secret settings, like passwords
and secret tokens.</p>
<blockquote>
<div><p>You should still check the output before pasting anything
on the internet.</p>
</div></blockquote>
</li>
<li><p>Connection URLs now ignore multiple '+' tokens.</p></li>
<li><p>Worker/<code class="docutils literal notranslate"><span class="pre">statedb</span></code>: Now uses pickle protocol 2 (Python 2.5+)</p></li>
<li><p>Fixed Python 3 compatibility issues.</p></li>
<li><p>Worker:  A warning is now given if a worker is started with the
same node name as an existing worker.</p></li>
<li><p>Worker: Fixed a deadlock that could occur while revoking tasks (<span class="xref issue">Issue #1297</span>).</p></li>
<li><p>Worker: The <code class="xref std std-sig docutils literal notranslate"><span class="pre">HUP</span></code> handler now closes all open file descriptors
before restarting to ensure file descriptors doesn't leak (<span class="xref issue">Issue #1270</span>).</p></li>
<li><p>Worker: Optimized storing/loading the revoked tasks list (<span class="xref issue">Issue #1289</span>).</p>
<blockquote>
<div><p>After this change the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-S"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">--statedb</span></code></a> file will
take up more disk space, but loading from and storing the revoked
tasks will be considerably faster (what before took 5 minutes will
now take less than a second).</p>
</div></blockquote>
</li>
<li><p>Celery will now suggest alternatives if there's a typo in the
broker transport name (e.g., <code class="docutils literal notranslate"><span class="pre">ampq</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">amqp</span></code>).</p></li>
<li><p>Worker: The auto-reloader would cause a crash if a monitored file
was unlinked.</p>
<blockquote>
<div><p>Fix contributed by Agris Ameriks.</p>
</div></blockquote>
</li>
<li><p>Fixed AsyncResult pickling error.</p>
<blockquote>
<div><p>Fix contributed by Thomas Minor.</p>
</div></blockquote>
</li>
<li><p>Fixed handling of Unicode in logging output when using log colors
(<span class="xref issue">Issue #427</span>).</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationView</span></code> is now a <code class="docutils literal notranslate"><span class="pre">MutableMapping</span></code>.</p>
<blockquote>
<div><p>Contributed by Aaron Harnly.</p>
</div></blockquote>
</li>
<li><p>Fixed memory leak in LRU cache implementation.</p>
<blockquote>
<div><p>Fix contributed by Romuald Brunet.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code>: Now works when sockets are in non-blocking mode.</p>
<blockquote>
<div><p>Fix contributed by Theo Spears.</p>
</div></blockquote>
</li>
<li><p>The <cite>inspect reserved</cite> remote control command included active (started) tasks
with the reserved tasks (<span class="xref issue">Issue #1030</span>).</p></li>
<li><p>The <a class="reference internal" href="../userguide/signals.html#std-signal-task_failure"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_failure</span></code></a> signal received a modified traceback object
meant for pickling purposes, this has been fixed so that it now
receives the real traceback instead.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">&#64;task</span></code> decorator silently ignored positional arguments,
it now raises the expected <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#TypeError" title="（在 Python v3.15）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> instead (<span class="xref issue">Issue #1125</span>).</p></li>
<li><p>The worker will now properly handle messages with invalid
ETA/expires fields (<span class="xref issue">Issue #1232</span>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pool_restart</span></code> remote control command now reports
an error if the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_POOL_RESTARTS</span></code> setting isn't set.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_defaults`()</span></code> can now be used with non-dict objects.</p></li>
<li><p>Fixed compatibility problems in the Proxy class (<span class="xref issue">Issue #1087</span>).</p>
<blockquote>
<div><p>The class attributes <code class="docutils literal notranslate"><span class="pre">__module__</span></code>, <code class="docutils literal notranslate"><span class="pre">__name__</span></code> and <code class="docutils literal notranslate"><span class="pre">__doc__</span></code>
are now meaningful string objects.</p>
<p>Thanks to Marius Gedminas.</p>
</div></blockquote>
</li>
<li><p>MongoDB Backend: The <code class="xref std std-setting docutils literal notranslate"><span class="pre">MONGODB_BACKEND_SETTINGS</span></code> setting
now accepts a <code class="docutils literal notranslate"><span class="pre">option</span></code> key that lets you forward arbitrary kwargs
to the underlying <code class="docutils literal notranslate"><span class="pre">pymongo.Connection</span></code> object (<span class="xref issue">Issue #1015</span>).</p></li>
<li><p>Beat: The daily backend cleanup task is no longer enabled
for result backends that support automatic result expiration (<span class="xref issue">Issue #1031</span>).</p></li>
<li><p>Canvas list operations now takes application instance from the first
task in the list, instead of depending on the <code class="docutils literal notranslate"><span class="pre">current_app</span></code> (<span class="xref issue">Issue #1249</span>).</p></li>
<li><p>Worker: Message decoding error log message now includes traceback
information.</p></li>
<li><p>Worker: The start-up banner now includes system platform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">inspect|status|control</span></code> now gives an error if used
with a SQL based broker transport.</p></li>
</ul>
</section>
<section id="version-3-0-17">
<span id="id8"></span><h2>3.0.17<a class="headerlink" href="#version-3-0-17" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-03-22 04:00:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.5.8</p></li>
<li><p>Now depends on billiard 2.7.3.23</p></li>
<li><p>RabbitMQ/Redis: thread-less and lock-free rate-limit implementation.</p>
<blockquote>
<div><p>This means that rate limits pose minimal overhead when used with
RabbitMQ/Redis or future transports using the event-loop,
and that the rate-limit implementation is now thread-less and lock-free.</p>
<p>The thread-based transports will still use the old implementation for
now, but the plan is to use the timer also for other
broker transports in Celery 3.1.</p>
</div></blockquote>
</li>
<li><p>Rate limits now works with eventlet/gevent if using RabbitMQ/Redis as the
broker.</p></li>
<li><p>A regression caused <code class="docutils literal notranslate"><span class="pre">task.retry</span></code> to ignore additional keyword arguments.</p>
<blockquote>
<div><p>Extra keyword arguments are now used as execution options again.
Fix contributed by Simon Engledew.</p>
</div></blockquote>
</li>
<li><p>Windows: Fixed problem with the worker trying to pickle the Django settings
module at worker start-up.</p></li>
<li><p>generic-init.d:  No longer double quotes <code class="docutils literal notranslate"><span class="pre">$CELERYD_CHDIR</span></code> (<span class="xref issue">Issue #1235</span>).</p></li>
<li><p>generic-init.d: Removes bash-specific syntax.</p>
<blockquote>
<div><p>Fix contributed by Pär Wieslander.</p>
</div></blockquote>
</li>
<li><p>Cassandra Result Backend: Now handles the
<code class="xref py py-exc docutils literal notranslate"><span class="pre">AllServersUnavailable</span></code> error (<span class="xref issue">Issue #1010</span>).</p>
<blockquote>
<div><p>Fix contributed by Jared Biel.</p>
</div></blockquote>
</li>
<li><p>Result: Now properly forwards apps to GroupResults when deserializing
(<span class="xref issue">Issue #1249</span>).</p>
<blockquote>
<div><p>Fix contributed by Charles-Axel Dein.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroupResult.revoke</span></code> now supports the <code class="docutils literal notranslate"><span class="pre">terminate</span></code> and <code class="docutils literal notranslate"><span class="pre">signal</span></code>
keyword arguments.</p></li>
<li><p>Worker: Multiprocessing pool workers now import task modules/configuration
before setting up the logging system so that logging signals can be
connected before they're dispatched.</p></li>
<li><p>chord:  The <code class="docutils literal notranslate"><span class="pre">AsyncResult</span></code> instance returned now has its <code class="docutils literal notranslate"><span class="pre">parent</span></code>
attribute set to the header <code class="docutils literal notranslate"><span class="pre">GroupResult</span></code>.</p>
<blockquote>
<div><p>This is consistent with how <code class="docutils literal notranslate"><span class="pre">chain</span></code> works.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-16">
<span id="id9"></span><h2>3.0.16<a class="headerlink" href="#version-3-0-16" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-03-07 04:00:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Happy International Women's Day!</p>
<blockquote>
<div><p>We have a long way to go, so this is a chance for you to get involved in one
of the organizations working for making our communities more
diverse.</p>
<blockquote>
<div><ul class="simple">
<li><p>PyLadies — <a class="reference external" href="http://pyladies.com">http://pyladies.com</a></p></li>
<li><p>Girls Who Code — <a class="reference external" href="http://www.girlswhocode.com">http://www.girlswhocode.com</a></p></li>
<li><p>Women Who Code — <a class="reference external" href="http://www.meetup.com/Women-Who-Code-SF/">http://www.meetup.com/Women-Who-Code-SF/</a></p></li>
</ul>
</div></blockquote>
</div></blockquote>
</li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/kombu/">https://pypi.org/project/kombu/</a> version 2.5.7</p></li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> version 2.7.3.22</p></li>
<li><p>AMQP heartbeats are now disabled by default.</p>
<blockquote>
<div><p>Some users experiences issues with heartbeats enabled,
and it's not strictly necessary to use them.</p>
<p>If you're experiencing problems detecting connection failures,
you can re-enable heartbeats by configuring the <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_HEARTBEAT</span></code>
setting.</p>
</div></blockquote>
</li>
<li><p>Worker: Now propagates connection errors occurring in multiprocessing
callbacks, so that the connection can be reset (<span class="xref issue">Issue #1226</span>).</p></li>
<li><p>Worker: Now propagates connection errors occurring in timer callbacks,
so that the connection can be reset.</p></li>
<li><p>The modules in <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_IMPORTS</span></code> and <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_INCLUDE</span></code>
are now imported in the original order (<span class="xref issue">Issue #1161</span>).</p>
<blockquote>
<div><p>The modules in <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_IMPORTS</span></code> will be imported first,
then continued by <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_INCLUDE</span></code>.</p>
<p>Thanks to Joey Wilhelm.</p>
</div></blockquote>
</li>
<li><p>New bash completion for <code class="docutils literal notranslate"><span class="pre">celery</span></code> available in the git repository:</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/celery/celery/tree/3.0/extra/bash-completion">https://github.com/celery/celery/tree/3.0/extra/bash-completion</a></p>
<p>You can source this file or put it in <code class="docutils literal notranslate"><span class="pre">bash_completion.d</span></code> to
get auto-completion for the <code class="docutils literal notranslate"><span class="pre">celery</span></code> command-line utility.</p>
</div></blockquote>
</li>
<li><p>The node name of a worker can now include unicode characters (<span class="xref issue">Issue #1186</span>).</p></li>
<li><p>The repr of a <code class="docutils literal notranslate"><span class="pre">crontab</span></code> object now displays correctly (<span class="xref issue">Issue #972</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">events.State</span></code> no longer modifies the original event dictionary.</p></li>
<li><p>No longer uses <code class="docutils literal notranslate"><span class="pre">Logger.warn</span></code> deprecated in Python 3.</p></li>
<li><p>Cache Backend: Now works with chords again (<span class="xref issue">Issue #1094</span>).</p></li>
<li><p>Chord unlock now handles errors occurring while calling the callback.</p></li>
<li><p>Generic worker init.d script: Status check is now performed by
querying the pid of the instance instead of sending messages.</p>
<blockquote>
<div><p>Contributed by Milen Pavlov.</p>
</div></blockquote>
</li>
<li><p>Improved init-scripts for CentOS.</p>
<blockquote>
<div><ul class="simple">
<li><p>Updated to support Celery 3.x conventions.</p></li>
<li><p>Now uses CentOS built-in <code class="docutils literal notranslate"><span class="pre">status</span></code> and <code class="docutils literal notranslate"><span class="pre">killproc</span></code></p></li>
<li><p>Support for multi-node / multi-pid worker services.</p></li>
<li><p>Standard color-coded CentOS service-init output.</p></li>
<li><p>A test suite.</p></li>
</ul>
<p>Contributed by Milen Pavlov.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ResultSet.join</span></code> now always works with empty result set (<span class="xref issue">Issue #1219</span>).</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">group</span></code> consisting of a single task is now supported (<span class="xref issue">Issue #1219</span>).</p></li>
<li><p>Now supports the <code class="docutils literal notranslate"><span class="pre">pycallgraph</span></code> program (<span class="xref issue">Issue #1051</span>).</p></li>
<li><p>Fixed Jython compatibility problems.</p></li>
<li><p>Django tutorial: Now mentions that the example app must be added to
<code class="docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code> (<span class="xref issue">Issue #1192</span>).</p></li>
</ul>
</section>
<section id="version-3-0-15">
<span id="id10"></span><h2>3.0.15<a class="headerlink" href="#version-3-0-15" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-02-11 04:30:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul class="simple">
<li><p>Now depends on billiard 2.7.3.21 which fixed a syntax error crash.</p></li>
<li><p>Fixed bug with <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_SEND_TASK_SENT_EVENT</span></code>.</p></li>
</ul>
</section>
<section id="version-3-0-14">
<span id="id11"></span><h2>3.0.14<a class="headerlink" href="#version-3-0-14" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-02-08 05:00:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on Kombu 2.5.6</p></li>
<li><p>Now depends on billiard 2.7.3.20</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">execv</span></code> is now disabled by default.</p>
<blockquote>
<div><p>It was causing too many problems for users, you can still enable
it using the <cite>CELERYD_FORCE_EXECV</cite> setting.</p>
<p>execv was only enabled when transports other than AMQP/Redis was used,
and it's there to prevent deadlocks caused by mutexes not being released
before the process forks. Unfortunately it also changes the environment
introducing many corner case bugs that're hard to fix without adding
horrible hacks. Deadlock issues are reported far less often than the
bugs that execv are causing, so we now disable it by default.</p>
<p>Work is in motion to create non-blocking versions of these transports
so that execv isn't necessary (which is the situation with the amqp
and redis broker transports)</p>
</div></blockquote>
</li>
<li><p>Chord exception behavior defined (<span class="xref issue">Issue #1172</span>).</p>
<blockquote>
<div><p>From Celery 3.1 the chord callback will change state to FAILURE
when a task part of a chord raises an exception.</p>
<p>It was never documented what happens in this case,
and the actual behavior was very unsatisfactory, indeed
it will just forward the exception value to the chord callback.</p>
<p>For backward compatibility reasons we don't change to the new
behavior in a bugfix release, even if the current behavior was
never documented. Instead you can enable the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_CHORD_PROPAGATES</span></code> setting to get the new behavior
that'll be default from Celery 3.1.</p>
<p>See more at <a class="reference internal" href="../userguide/canvas.html#chord-errors"><span class="std std-ref">错误处理</span></a>.</p>
</div></blockquote>
</li>
<li><p>worker: Fixes bug with ignored and retried tasks.</p>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">on_chord_part_return</span></code> and <code class="docutils literal notranslate"><span class="pre">Task.after_return</span></code> callbacks,
nor the <code class="docutils literal notranslate"><span class="pre">task_postrun</span></code> signal should be called when the task was
retried/ignored.</p>
<p>Fix contributed by Vlad.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroupResult.join_native</span></code> now respects the <code class="docutils literal notranslate"><span class="pre">propagate</span></code> argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subtask.id</span></code> added as an alias to <code class="docutils literal notranslate"><span class="pre">subtask['options'].id</span></code></p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s1">&#39;my-id&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;options&#39;</span><span class="p">]</span>
<span class="go">{&#39;task_id&#39;: &#39;my-id&#39;}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">id</span>
<span class="go">&#39;my-id&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>worker: Fixed error <cite>Could not start worker processes</cite> occurring
when restarting after connection failure (<span class="xref issue">Issue #1118</span>).</p></li>
<li><p>Adds new signal <code class="xref std std-signal docutils literal notranslate"><span class="pre">task-retried</span></code> (<span class="xref issue">Issue #1169</span>).</p></li>
<li><p><cite>celery events --dumper</cite> now handles connection loss.</p></li>
<li><p>Will now retry sending the task-sent event in case of connection failure.</p></li>
<li><p>amqp backend:  Now uses <code class="docutils literal notranslate"><span class="pre">Message.requeue</span></code> instead of republishing
the message after poll.</p></li>
<li><p>New <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_HEARTBEAT_CHECKRATE</span></code> setting introduced to modify the
rate at which broker connection heartbeats are monitored.</p>
<blockquote>
<div><p>The default value was also changed from 3.0 to 2.0.</p>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="../reference/celery.events.state.html#celery.events.state.State" title="celery.events.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.events.state.State</span></code></a> is now pickleable.</p>
<blockquote>
<div><p>Fix contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="../internals/reference/celery.utils.functional.html#celery.utils.functional.LRUCache" title="celery.utils.functional.LRUCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.utils.functional.LRUCache</span></code></a> is now pickleable.</p>
<blockquote>
<div><p>Fix contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>The stats broadcast command now includes the workers pid.</p>
<blockquote>
<div><p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">conf</span></code> remote control command to get a workers current configuration.</p>
<blockquote>
<div><p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>Adds the ability to modify the chord unlock task's countdown
argument (<span class="xref issue">Issue #1146</span>).</p>
<blockquote>
<div><p>Contributed by Jun Sakai</p>
</div></blockquote>
</li>
<li><p>beat: The scheduler now uses the <cite>now()`</cite> method of the schedule,
so that schedules can provide a custom way to get the current date and time.</p>
<blockquote>
<div><p>Contributed by Raphaël Slinckx</p>
</div></blockquote>
</li>
<li><p>Fixed pickling of configuration modules on Windows or when execv is used
(<span class="xref issue">Issue #1126</span>).</p></li>
<li><p>Multiprocessing logger is now configured with loglevel <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>
by default.</p>
<blockquote>
<div><p>Since 3.0 the multiprocessing loggers were disabled by default
(only configured when the <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MP_LOG</span></code> environment variable was set).</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-13">
<span id="id12"></span><h2>3.0.13<a class="headerlink" href="#version-3-0-13" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2013-01-07 04:00:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on Kombu 2.5</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/amqp/">https://pypi.org/project/amqp/</a> has replaced <a class="extlink-pypi reference external" href="https://pypi.org/project/amqplib/">https://pypi.org/project/amqplib/</a> as the default transport,
gaining support for AMQP 0.9, and the RabbitMQ extensions,
including Consumer Cancel Notifications and heartbeats.</p></li>
<li><p>support for multiple connection URLs for failover.</p></li>
<li><p>Read more in the <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-5-0" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.5 changelog</span></a>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Now depends on billiard 2.7.3.19</p></li>
<li><p>Fixed a deadlock issue that could occur when the producer pool
inherited the connection pool instance of the parent process.</p></li>
<li><p>The <a class="reference internal" href="../reference/cli.html#cmdoption-celery-loader"><code class="xref std std-option docutils literal notranslate"><span class="pre">--loader</span></code></a> option now works again (<span class="xref issue">Issue #1066</span>).</p></li>
<li><p><strong class="program">celery</strong> umbrella command: All sub-commands now supports
the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-workdir"><code class="xref std std-option docutils literal notranslate"><span class="pre">--workdir</span></code></a> option (<span class="xref issue">Issue #1063</span>).</p></li>
<li><p>Groups included in chains now give GroupResults (<span class="xref issue">Issue #1057</span>)</p>
<blockquote>
<div><p>Previously it would incorrectly add a regular result instead of a group
result, but now this works:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># [4 + 4, 4 + 8, 16 + 8]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">16</span><span class="p">)))()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">&lt;GroupResult: a0acf905-c704-499e-b03a-8d445e6398f7 [</span>
<span class="go">    4346501c-cb99-4ad8-8577-12256c7a22b1,</span>
<span class="go">    b12ead10-a622-4d44-86e9-3193a778f345,</span>
<span class="go">    26c7a420-11f3-4b33-8fac-66cd3b62abfd]&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Chains can now chain other chains and use partial arguments (<span class="xref issue">Issue #1057</span>).</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">c3</span> <span class="o">=</span> <span class="p">(</span><span class="n">c1</span> <span class="o">|</span> <span class="n">c2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 8 + 2 + 4 + 8 + 16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">c3</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">38</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Subtasks can now be used with unregistered tasks.</p>
<blockquote>
<div><p>You can specify subtasks even if you just have the name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">subtask</span><span class="p">(</span><span class="n">task_name</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The <strong class="program">celery shell</strong> command now always adds the current
directory to the module path.</p></li>
<li><p>The worker will now properly handle the <code class="xref py py-exc docutils literal notranslate"><span class="pre">pytz.AmbiguousTimeError</span></code>
exception raised when an ETA/countdown is prepared while being in DST
transition (<span class="xref issue">Issue #1061</span>).</p></li>
<li><p>force_execv: Now makes sure that task symbols in the original
task modules will always use the correct app instance (<span class="xref issue">Issue #1072</span>).</p></li>
<li><p>AMQP Backend: Now republishes result messages that have been polled
(using <code class="docutils literal notranslate"><span class="pre">result.ready()</span></code> and friends, <code class="docutils literal notranslate"><span class="pre">result.get()</span></code> won't do this
in this version).</p></li>
<li><p>Crontab schedule values can now &quot;wrap around&quot;</p>
<blockquote>
<div><p>This means that values like <code class="docutils literal notranslate"><span class="pre">11-1</span></code> translates to <code class="docutils literal notranslate"><span class="pre">[11,</span> <span class="pre">12,</span> <span class="pre">1]</span></code>.</p>
<p>Contributed by Loren Abrams.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">multi</span> <span class="pre">stopwait</span></code> command now shows the pid of processes.</p>
<blockquote>
<div><p>Contributed by Loren Abrams.</p>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>Handling of ETA/countdown fixed when the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code></dt><dd><p>setting is disabled (<span class="xref issue">Issue #1065</span>).</p>
</dd>
</dl>
</li>
<li><p>A number of unneeded properties were included in messages,
caused by accidentally passing <code class="docutils literal notranslate"><span class="pre">Queue.as_dict</span></code> as message properties.</p></li>
<li><p>Rate limit values can now be float</p>
<blockquote>
<div><p>This also extends the string format so that values like <code class="docutils literal notranslate"><span class="pre">&quot;0.5/s&quot;</span></code> works.</p>
<p>Contributed by Christoph Krybus</p>
</div></blockquote>
</li>
<li><p>Fixed a typo in the broadcast routing documentation (<span class="xref issue">Issue #1026</span>).</p></li>
<li><p>Rewrote confusing section about idempotence in the task user guide.</p></li>
<li><p>Fixed typo in the daemonization tutorial (<span class="xref issue">Issue #1055</span>).</p></li>
<li><p>Fixed several typos in the documentation.</p>
<blockquote>
<div><p>Contributed by Marius Gedminas.</p>
</div></blockquote>
</li>
<li><p>Batches: Now works when using the eventlet pool.</p>
<blockquote>
<div><p>Fix contributed by Thomas Grainger.</p>
</div></blockquote>
</li>
<li><p>Batches: Added example sending results to <code class="docutils literal notranslate"><span class="pre">celery.contrib.batches</span></code>.</p>
<blockquote>
<div><p>Contributed by Thomas Grainger.</p>
</div></blockquote>
</li>
<li><p>MongoDB backend: Connection <code class="docutils literal notranslate"><span class="pre">max_pool_size</span></code> can now be set in
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_MONGODB_BACKEND_SETTINGS</span></code>.</p>
<blockquote>
<div><p>Contributed by Craig Younkins.</p>
</div></blockquote>
</li>
<li><p>Fixed problem when using earlier versions of <a class="extlink-pypi reference external" href="https://pypi.org/project/pytz/">https://pypi.org/project/pytz/</a>.</p>
<blockquote>
<div><p>Fix contributed by Vlad.</p>
</div></blockquote>
</li>
<li><p>Docs updated to include the default value for the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code> setting.</p></li>
<li><p>Improvements to the <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> tutorial.</p>
<blockquote>
<div><p>Contributed by Locker537.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">add_consumer</span></code> control command didn't properly persist
the addition of new queues so that they survived connection failure
(<span class="xref issue">Issue #1079</span>).</p></li>
</ul>
</section>
<section id="id13">
<h2>3.0.12<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-11-06 02:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.4.8</p>
<blockquote>
<div><ul class="simple">
<li><p>[Redis] New and improved fair queue cycle algorithm (Kevin McCarthy).</p></li>
<li><p>[Redis] Now uses a Redis-based mutex when restoring messages.</p></li>
<li><dl class="simple">
<dt>[Redis] Number of messages that can be restored in one interval is no</dt><dd><p>longer limited (but can be set using the
<code class="docutils literal notranslate"><span class="pre">unacked_restore_limit</span></code>
<code class="xref std std-setting docutils literal notranslate"><span class="pre">transport</span> <span class="pre">option</span></code>).</p>
</dd>
</dl>
</li>
<li><p>Heartbeat value can be specified in broker URLs (Mher Movsisyan).</p></li>
<li><p>Fixed problem with msgpack on Python 3 (Jasper Bryant-Greene).</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Now depends on billiard 2.7.3.18</p></li>
<li><p>Celery can now be used with static analysis tools like PyDev/PyCharm/pylint
etc.</p></li>
<li><p>Development documentation has moved to Read The Docs.</p>
<blockquote>
<div><p>The new URL is: <a class="reference external" href="https://docs.celeryq.dev/en/master">https://docs.celeryq.dev/en/master</a></p>
</div></blockquote>
</li>
<li><p>New <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_QUEUE_HA_POLICY</span></code> setting used to set the default
HA policy for queues when using RabbitMQ.</p></li>
<li><p>New method <code class="docutils literal notranslate"><span class="pre">Task.subtask_from_request</span></code> returns a subtask using the current
request.</p></li>
<li><p>Results get_many method didn't respect timeout argument.</p>
<blockquote>
<div><p>Fix contributed by Remigiusz Modrzejewski</p>
</div></blockquote>
</li>
<li><p>generic_init.d scripts now support setting <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_CREATE_DIRS</span></code> to
always create log and pid directories (<span class="xref issue">Issue #1045</span>).</p>
<blockquote>
<div><p>This can be set in your <code class="file docutils literal notranslate"><span class="pre">/etc/default/celeryd</span></code>.</p>
</div></blockquote>
</li>
<li><p>Fixed strange kombu import problem on Python 3.2 (<span class="xref issue">Issue #1034</span>).</p></li>
<li><p>Worker: ETA scheduler now uses millisecond precision (<span class="xref issue">Issue #1040</span>).</p></li>
<li><p>The <a class="reference internal" href="../reference/cli.html#cmdoption-celery-config"><code class="xref std std-option docutils literal notranslate"><span class="pre">--config</span></code></a> argument to programs is
now supported by all loaders.</p></li>
<li><p>The <code class="xref std std-setting docutils literal notranslate"><span class="pre">CASSANDRA_OPTIONS</span></code> setting has now been documented.</p>
<blockquote>
<div><p>Contributed by Jared Biel.</p>
</div></blockquote>
</li>
<li><p>Task methods (<code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.methods</span></code>) cannot be used with the old
task base class, the task decorator in that module now inherits from the new.</p></li>
<li><p>An optimization was too eager and caused some logging messages to never emit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery.contrib.batches</span></code> now works again.</p></li>
<li><p>Fixed missing white-space in <code class="docutils literal notranslate"><span class="pre">bdist_rpm</span></code> requirements (<span class="xref issue">Issue #1046</span>).</p></li>
<li><p>Event state's <code class="docutils literal notranslate"><span class="pre">tasks_by_name</span></code> applied limit before filtering by name.</p>
<blockquote>
<div><p>Fix contributed by Alexander A. Sosnovskiy.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-11">
<span id="id14"></span><h2>3.0.11<a class="headerlink" href="#version-3-0-11" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-09-26 04:00 p.m. UTC</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>[security:low] generic-init.d scripts changed permissions of /var/log &amp; /var/run</p>
<blockquote>
<div><p>In the daemonization tutorial the recommended directories were as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">CELERYD_LOG_FILE</span><span class="o">=</span><span class="s2">&quot;/var/log/celery/%n.log&quot;</span>
<span class="nv">CELERYD_PID_FILE</span><span class="o">=</span><span class="s2">&quot;/var/run/celery/%n.pid&quot;</span>
</pre></div>
</div>
<p>But in the scripts themselves the default files were <code class="docutils literal notranslate"><span class="pre">/var/log/celery%n.log</span></code>
and <code class="docutils literal notranslate"><span class="pre">/var/run/celery%n.pid</span></code>, so if the user didn't change the location
by configuration, the directories <code class="docutils literal notranslate"><span class="pre">/var/log</span></code> and <code class="docutils literal notranslate"><span class="pre">/var/run</span></code> would be
created - and worse have their permissions and owners changed.</p>
<p>This change means that:</p>
<blockquote>
<div><ul class="simple">
<li><p>Default pid file is <code class="docutils literal notranslate"><span class="pre">/var/run/celery/%n.pid</span></code></p></li>
<li><p>Default log file is <code class="docutils literal notranslate"><span class="pre">/var/log/celery/%n.log</span></code></p></li>
<li><p>The directories are only created and have their permissions
changed if <em>no custom locations are set</em>.</p></li>
</ul>
</div></blockquote>
<p>Users can force paths to be created by calling the <code class="docutils literal notranslate"><span class="pre">create-paths</span></code>
sub-command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>/etc/init.d/celeryd<span class="w"> </span>create-paths
</pre></div>
</div>
<div class="admonition-upgrading-celery-won-t-update-init-scripts admonition">
<p class="admonition-title">Upgrading Celery won't update init-scripts</p>
<p>To update the init-scripts you have to re-download
the files from source control and update them manually.
You can find the init-scripts for version 3.0.x at:</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/celery/celery/tree/3.0/extra/generic-init.d">https://github.com/celery/celery/tree/3.0/extra/generic-init.d</a></p>
</div></blockquote>
</div>
</div></blockquote>
</li>
<li><p>Now depends on billiard 2.7.3.17</p></li>
<li><p>Fixes request stack protection when app is initialized more than
once (<span class="xref issue">Issue #1003</span>).</p></li>
<li><p>ETA tasks now properly works when system timezone isn't same
as the configured timezone (<span class="xref issue">Issue #1004</span>).</p></li>
<li><p>Terminating a task now works if the task has been sent to the
pool but not yet acknowledged by a pool process (<span class="xref issue">Issue #1007</span>).</p>
<blockquote>
<div><p>Fix contributed by Alexey Zatelepin</p>
</div></blockquote>
</li>
<li><p>Terminating a task now properly updates the state of the task to revoked,
and sends a <code class="docutils literal notranslate"><span class="pre">task-revoked</span></code> event.</p></li>
<li><p>Generic worker init-script now waits for workers to shutdown by default.</p></li>
<li><p>Multi: No longer parses --app option (<span class="xref issue">Issue #1008</span>).</p></li>
<li><p>Multi: <code class="docutils literal notranslate"><span class="pre">stop_verify</span></code> command renamed to <code class="docutils literal notranslate"><span class="pre">stopwait</span></code>.</p></li>
<li><p>Daemonization: Now delays trying to create pidfile/logfile until after
the working directory has been changed into.</p></li>
<li><p><strong class="program">celery worker</strong> and <strong class="program">celery beat</strong> commands now respects
the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-C"><code class="xref std std-option docutils literal notranslate"><span class="pre">--no-color</span></code></a> option (<span class="xref issue">Issue #999</span>).</p></li>
<li><p>Fixed typos in eventlet examples (<span class="xref issue">Issue #1000</span>)</p>
<blockquote>
<div><p>Fix contributed by Bryan Bishop.
Congratulations on opening bug #1000!</p>
</div></blockquote>
</li>
<li><p>Tasks that raise <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.Ignore" title="celery.exceptions.Ignore"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Ignore</span></code></a> are now acknowledged.</p></li>
<li><p>Beat: Now shows the name of the entry in <code class="docutils literal notranslate"><span class="pre">sending</span> <span class="pre">due</span> <span class="pre">task</span></code> logs.</p></li>
</ul>
</section>
<section id="version-3-0-10">
<span id="id15"></span><h2>3.0.10<a class="headerlink" href="#version-3-0-10" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-09-20 05:30 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.4.7</p></li>
<li><p>Now depends on billiard 2.7.3.14</p>
<blockquote>
<div><ul>
<li><p>Fixes crash at start-up when using Django and pre-1.4 projects
(<code class="docutils literal notranslate"><span class="pre">setup_environ</span></code>).</p></li>
<li><p>Hard time limits now sends the KILL signal shortly after TERM,
to terminate processes that have signal handlers blocked by C extensions.</p></li>
<li><p>Billiard now installs even if the C extension cannot be built.</p>
<blockquote>
<div><p>It's still recommended to build the C extension if you're using
a transport other than RabbitMQ/Redis (or use forced execv for some
other reason).</p>
</div></blockquote>
</li>
<li><p>Pool now sets a <code class="docutils literal notranslate"><span class="pre">current_process().index</span></code> attribute that can be used to create
as many log files as there are processes in the pool.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Canvas: chord/group/chain no longer modifies the state when called</p>
<blockquote>
<div><p>Previously calling a chord/group/chain would modify the ids of subtasks
so that:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">chord</span><span class="p">([</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">()</span> <span class="o">&lt;--</span> <span class="n">call</span> <span class="n">again</span>
</pre></div>
</div>
<p>at the second time the ids for the tasks would be the same as in the
previous invocation. This is now fixed, so that calling a subtask
won't mutate any options.</p>
</div></blockquote>
</li>
<li><p>Canvas: Chaining a chord to another task now works (<span class="xref issue">Issue #965</span>).</p></li>
<li><p>Worker: Fixed a bug where the request stack could be corrupted if
relative imports are used.</p>
<blockquote>
<div><p>Problem usually manifested itself as an exception while trying to
send a failed task result (<code class="docutils literal notranslate"><span class="pre">NoneType</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">have</span> <span class="pre">id</span> <span class="pre">attribute</span></code>).</p>
<p>Fix contributed by Sam Cooke.</p>
</div></blockquote>
</li>
<li><p>Tasks can now raise <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.Ignore" title="celery.exceptions.Ignore"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Ignore</span></code></a> to skip updating states
or events after return.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ignore</span>

<span class="nd">@task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">custom_revokes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">redis</span><span class="o">.</span><span class="n">sismember</span><span class="p">(</span><span class="s1">&#39;tasks.revoked&#39;</span><span class="p">,</span> <span class="n">custom_revokes</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">Ignore</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>The worker now makes sure the request/task stacks aren't modified
by the initial <code class="docutils literal notranslate"><span class="pre">Task.__call__</span></code>.</p>
<blockquote>
<div><p>This would previously be a problem if a custom task class defined
<code class="docutils literal notranslate"><span class="pre">__call__</span></code> and also called <code class="docutils literal notranslate"><span class="pre">super()</span></code>.</p>
</div></blockquote>
</li>
<li><p>Because of problems the fast local optimization has been disabled,
and can only be enabled by setting the <span class="target" id="index-4"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">USE_FAST_LOCALS</span></code> attribute.</p></li>
<li><p>Worker: Now sets a default socket timeout of 5 seconds at shutdown
so that broken socket reads don't hinder proper shutdown (<span class="xref issue">Issue #975</span>).</p></li>
<li><p>More fixes related to late eventlet/gevent patching.</p></li>
<li><p>Documentation for settings out of sync with reality:</p>
<blockquote>
<div><ul>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_PUBLISH_RETRY</span></code></p>
<blockquote>
<div><p>Documented as disabled by default, but it was enabled by default
since 2.5 as stated by the 2.5 changelog.</p>
</div></blockquote>
</li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_PUBLISH_RETRY_POLICY</span></code></p>
<blockquote>
<div><p>The default max_retries had been set to 100, but documented as being
3, and the interval_max was set to 1 but documented as 0.2.
The default setting are now set to 3 and 0.2 as it was originally
documented.</p>
</div></blockquote>
</li>
</ul>
<p>Fix contributed by Matt Long.</p>
</div></blockquote>
</li>
<li><p>Worker: Log messages when connection established and lost have been improved.</p></li>
<li><p>The repr of a Crontab schedule value of '0' should be '*'  (<span class="xref issue">Issue #972</span>).</p></li>
<li><p>Revoked tasks are now removed from reserved/active state in the worker
(<span class="xref issue">Issue #969</span>)</p>
<blockquote>
<div><p>Fix contributed by Alexey Zatelepin.</p>
</div></blockquote>
</li>
<li><p>gevent: Now supports hard time limits using <code class="docutils literal notranslate"><span class="pre">gevent.Timeout</span></code>.</p></li>
<li><p>Documentation: Links to init-scripts now point to the 3.0 branch instead
of the development branch (master).</p></li>
<li><p>Documentation: Fixed typo in signals user guide (<span class="xref issue">Issue #986</span>).</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">instance.app.queues</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">instance.app.amqp.queues</span></code>.</p>
</div></blockquote>
</li>
<li><p>Eventlet/gevent: The worker didn't properly set the custom app
for new greenlets.</p></li>
<li><p>Eventlet/gevent: Fixed a bug where the worker could not recover
from connection loss (<span class="xref issue">Issue #959</span>).</p>
<blockquote>
<div><p>Also, because of a suspected bug in gevent the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_CONNECTION_TIMEOUT</span></code> setting has been disabled
when using gevent</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="id16">
<h2>3.0.9<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-08-31 06:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Important note for users of Django and the database scheduler!</p>
<blockquote>
<div><p>Recently a timezone issue has been fixed for periodic tasks,
but erroneous timezones could have already been stored in the
database, so for the fix to work you need to reset
the <code class="docutils literal notranslate"><span class="pre">last_run_at</span></code> fields.</p>
<p>You can do this by executing the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>manage.py<span class="w"> </span>shell
<span class="go">&gt;&gt;&gt; from djcelery.models import PeriodicTask</span>
<span class="go">&gt;&gt;&gt; PeriodicTask.objects.update(last_run_at=None)</span>
</pre></div>
</div>
<p>You also have to do this if you change the timezone or
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code> setting.</p>
</div></blockquote>
</li>
<li><p>Note about the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code> setting.</p>
<blockquote>
<div><p>If you previously disabled this just to force periodic tasks to work with
your timezone, then you're now <em>encouraged to re-enable it</em>.</p>
</div></blockquote>
</li>
<li><p>Now depends on Kombu 2.4.5 which fixes PyPy + Jython installation.</p></li>
<li><p>Fixed bug with timezones when <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code> is disabled
(<span class="xref issue">Issue #952</span>).</p></li>
<li><p>Fixed a typo in the <code class="docutils literal notranslate"><span class="pre">celerybeat</span></code> upgrade mechanism (<span class="xref issue">Issue #951</span>).</p></li>
<li><p>Make sure the <cite>exc_info</cite> argument to logging is resolved (<span class="xref issue">Issue #899</span>).</p></li>
<li><p>Fixed problem with Python 3.2 and thread join timeout overflow (<span class="xref issue">Issue #796</span>).</p></li>
<li><p>A test case was occasionally broken for Python 2.5.</p></li>
<li><p>Unit test suite now passes for PyPy 1.9.</p></li>
<li><p>App instances now supports the <a class="reference external" href="https://docs.python.org/dev/reference/compound_stmts.html#with" title="（在 Python v3.15）"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">with</span></code></a> statement.</p>
<blockquote>
<div><p>This calls the new <a class="reference internal" href="../reference/celery.html#celery.Celery.close" title="celery.Celery.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.close()</span></code></a> method at exit, which
cleans up after the app like closing pool connections.</p>
<p>Note that this is only necessary when dynamically creating apps,
for example &quot;temporary&quot; apps.</p>
</div></blockquote>
</li>
<li><p>Support for piping a subtask to a chain.</p>
<blockquote>
<div><p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">sometask</span><span class="o">.</span><span class="n">s</span><span class="p">()</span> <span class="o">|</span> <span class="n">othertask</span><span class="o">.</span><span class="n">s</span><span class="p">()</span>
<span class="n">new_pipe</span> <span class="o">=</span> <span class="n">mytask</span><span class="o">.</span><span class="n">s</span><span class="p">()</span> <span class="o">|</span> <span class="n">pipe</span>
</pre></div>
</div>
<p>Contributed by Steve Morin.</p>
</div></blockquote>
</li>
<li><p>Fixed problem with group results on non-pickle serializers.</p>
<blockquote>
<div><p>Fix contributed by Steeve Morin.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-8">
<span id="id17"></span><h2>3.0.8<a class="headerlink" href="#version-3-0-8" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-08-29 05:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on Kombu 2.4.4</p></li>
<li><p>Fixed problem with <a class="extlink-pypi reference external" href="https://pypi.org/project/amqplib/">https://pypi.org/project/amqplib/</a> and receiving larger message payloads
(<span class="xref issue">Issue #922</span>).</p>
<blockquote>
<div><p>The problem would manifest itself as either the worker hanging,
or occasionally a <code class="docutils literal notranslate"><span class="pre">Framing</span> <span class="pre">error</span></code> exception appearing.</p>
<p>Users of the new <code class="docutils literal notranslate"><span class="pre">pyamqp://</span></code> transport must upgrade to
<a class="extlink-pypi reference external" href="https://pypi.org/project/amqp/">https://pypi.org/project/amqp/</a> 0.9.3.</p>
</div></blockquote>
</li>
<li><p>Beat: Fixed another timezone bug with interval and Crontab schedules
(<span class="xref issue">Issue #943</span>).</p></li>
<li><p>Beat: The schedule file is now automatically cleared if the timezone
is changed.</p>
<blockquote>
<div><p>The schedule is also cleared when you upgrade to 3.0.8 from an earlier
version, this to register the initial timezone info.</p>
</div></blockquote>
</li>
<li><p>Events: The <a class="reference internal" href="../userguide/monitoring.html#std-event-worker-heartbeat"><code class="xref std std-event docutils literal notranslate"><span class="pre">worker-heartbeat</span></code></a> event now include processed and active
count fields.</p>
<blockquote>
<div><p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>Fixed error with error email and new task classes (<span class="xref issue">Issue #931</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BaseTask.__call__</span></code> is no longer optimized away if it has been monkey
patched.</p></li>
<li><p>Fixed shutdown issue when using gevent (<span class="xref issue">Issue #911</span> &amp; <span class="xref issue">Issue #936</span>).</p>
<blockquote>
<div><p>Fix contributed by Thomas Meson.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-7">
<span id="id18"></span><h2>3.0.7<a class="headerlink" href="#version-3-0-7" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-08-24 05:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Fixes several problems with periodic tasks and timezones (<span class="xref issue">Issue #937</span>).</p></li>
<li><p>Now depends on kombu 2.4.2</p>
<blockquote>
<div><ul class="simple">
<li><p>Redis: Fixes a race condition crash</p></li>
<li><p>Fixes an infinite loop that could happen when retrying establishing
the broker connection.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Daemons now redirect standard file descriptors to <code class="file docutils literal notranslate"><span class="pre">/dev/null</span></code></p>
<blockquote>
<div><p>Though by default the standard outs are also redirected
to the logger instead, but you can disable this by changing
the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_REDIRECT_STDOUTS</span></code> setting.</p>
</div></blockquote>
</li>
<li><p>Fixes possible problems when eventlet/gevent is patched too late.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LoggingProxy</span></code> no longer defines <code class="docutils literal notranslate"><span class="pre">fileno()</span></code> (<span class="xref issue">Issue #928</span>).</p></li>
<li><p>Results are now ignored for the chord unlock task.</p>
<blockquote>
<div><p>Fix contributed by Steeve Morin.</p>
</div></blockquote>
</li>
<li><p>Cassandra backend now works if result expiry is disabled.</p>
<blockquote>
<div><p>Fix contributed by Steeve Morin.</p>
</div></blockquote>
</li>
<li><p>The traceback object is now passed to signal handlers instead
of the string representation.</p>
<blockquote>
<div><p>Fix contributed by Adam DePue.</p>
</div></blockquote>
</li>
<li><p>Celery command: Extensions are now sorted by name.</p></li>
<li><p>A regression caused the <a class="reference internal" href="../userguide/monitoring.html#std-event-task-failed"><code class="xref std std-event docutils literal notranslate"><span class="pre">task-failed</span></code></a> event to be sent
with the exception object instead of its string representation.</p></li>
<li><p>The worker daemon would try to create the pid file before daemonizing
to catch errors, but this file wasn't immediately released (<span class="xref issue">Issue #923</span>).</p></li>
<li><p>Fixes Jython compatibility.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">billiard.forking_enable</span></code> was called by all pools not just the
processes pool, which would result in a useless warning if the billiard
C extensions weren't installed.</p></li>
</ul>
</section>
<section id="version-3-0-6">
<span id="id19"></span><h2>3.0.6<a class="headerlink" href="#version-3-0-6" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-08-17 11:00 p.mp.m. Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.4.0</p></li>
<li><p>Now depends on billiard 2.7.3.12</p></li>
<li><p>Redis: Celery now tries to restore messages whenever there are no messages
in the queue.</p></li>
<li><p>Crontab schedules now properly respects <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TIMEZONE</span></code> setting.</p>
<blockquote>
<div><p>It's important to note that Crontab schedules uses UTC time by default
unless this setting is set.</p>
<p><span class="xref issue">Issue #904</span> and <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> #150.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">billiard.enable_forking</span></code> is now only set by the processes pool.</p></li>
<li><p>The transport is now properly shown by <strong class="program">celery report</strong>
(<span class="xref issue">Issue #913</span>).</p></li>
<li><p>The <cite>--app</cite> argument now works if the last part is a module name
(<span class="xref issue">Issue #921</span>).</p></li>
<li><p>Fixed problem with unpickleable exceptions (billiard #12).</p></li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">task_name</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">EagerResult</span></code> which is always
<code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> (<span class="xref issue">Issue #907</span>).</p></li>
<li><p>Old Task class in <code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.task</span></code> no longer accepts magic kwargs by
default (<span class="xref issue">Issue #918</span>).</p>
<blockquote>
<div><p>A regression long ago disabled magic kwargs for these, and since
no one has complained about it we don't have any incentive to fix it now.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">inspect</span> <span class="pre">reserved</span></code> control command didn't work properly.</p></li>
<li><p>Should now play better with tools for static analysis by explicitly
specifying dynamically created attributes in the <a class="reference internal" href="../reference/celery.html#module-celery" title="celery: Distributed processing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code></a> and
<code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.task</span></code> modules.</p></li>
<li><p>Terminating a task now results in
<code class="xref py py-exc docutils literal notranslate"><span class="pre">RevokedTaskError</span></code> instead of a <code class="docutils literal notranslate"><span class="pre">WorkerLostError</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AsyncResult.revoke</span></code> now accepts <code class="docutils literal notranslate"><span class="pre">terminate</span></code> and <code class="docutils literal notranslate"><span class="pre">signal</span></code> arguments.</p></li>
<li><p>The <a class="reference internal" href="../userguide/monitoring.html#std-event-task-revoked"><code class="xref std std-event docutils literal notranslate"><span class="pre">task-revoked</span></code></a> event now includes new fields: <code class="docutils literal notranslate"><span class="pre">terminated</span></code>,
<code class="docutils literal notranslate"><span class="pre">signum</span></code>, and <code class="docutils literal notranslate"><span class="pre">expired</span></code>.</p></li>
<li><p>The argument to <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.TaskRevokedError" title="celery.exceptions.TaskRevokedError"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskRevokedError</span></code></a> is now one
of the reasons <code class="docutils literal notranslate"><span class="pre">revoked</span></code>, <code class="docutils literal notranslate"><span class="pre">expired</span></code> or <code class="docutils literal notranslate"><span class="pre">terminated</span></code>.</p></li>
<li><p>Old Task class does no longer use <code class="xref py py-class docutils literal notranslate"><span class="pre">classmethod</span></code> for <code class="docutils literal notranslate"><span class="pre">push_request</span></code>
and <code class="docutils literal notranslate"><span class="pre">pop_request</span></code>  (<span class="xref issue">Issue #912</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroupResult</span></code> now supports the <code class="docutils literal notranslate"><span class="pre">children</span></code> attribute (<span class="xref issue">Issue #916</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AsyncResult.collect</span></code> now respects the <code class="docutils literal notranslate"><span class="pre">intermediate</span></code> argument
(<span class="xref issue">Issue #917</span>).</p></li>
<li><p>Fixes example task in documentation (<span class="xref issue">Issue #902</span>).</p></li>
<li><p>Eventlet fixed so that the environment is patched as soon as possible.</p></li>
<li><p>eventlet: Now warns if Celery related modules that depends on threads
are imported before eventlet is patched.</p></li>
<li><p>Improved event and camera examples in the monitoring guide.</p></li>
<li><p>Disables celery command setuptools entry-points if the command can't be
loaded.</p></li>
<li><p>Fixed broken <code class="docutils literal notranslate"><span class="pre">dump_request</span></code> example in the tasks guide.</p></li>
</ul>
</section>
<section id="version-3-0-5">
<span id="id20"></span><h2>3.0.5<a class="headerlink" href="#version-3-0-5" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-08-01 04:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.3.1 + billiard 2.7.3.11</p></li>
<li><p>Fixed a bug with the -B option (<code class="docutils literal notranslate"><span class="pre">cannot</span> <span class="pre">pickle</span> <span class="pre">thread.lock</span> <span class="pre">objects</span></code>)
(<span class="xref issue">Issue #894</span> + <span class="xref issue">Issue #892</span>, + <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> #154).</p></li>
<li><p>The <code class="xref std std-control docutils literal notranslate"><span class="pre">restart_pool</span></code> control command now requires the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_POOL_RESTARTS</span></code> setting to be enabled</p>
<blockquote>
<div><p>This change was necessary as the multiprocessing event that the restart
command depends on is responsible for creating many semaphores/file
descriptors, resulting in problems in some environments.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain.apply</span></code> now passes args to the first task (<span class="xref issue">Issue #889</span>).</p></li>
<li><p>Documented previously secret options to the <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> monitor
in the monitoring user guide (<span class="xref issue">Issue #396</span>).</p></li>
<li><p>Old changelog are now organized in separate documents for each series,
see <a class="reference internal" href="index.html#history"><span class="std std-ref">历史</span></a>.</p></li>
</ul>
</section>
<section id="version-3-0-4">
<span id="id21"></span><h2>3.0.4<a class="headerlink" href="#version-3-0-4" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-07-26 07:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on Kombu 2.3</p></li>
<li><p>New experimental standalone Celery monitor: Flower</p>
<blockquote>
<div><p>See <a class="reference internal" href="../userguide/monitoring.html#monitoring-flower"><span class="std std-ref">Flower：实时 Celery web-monitor</span></a> to read more about it!</p>
<p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>Now supports AMQP heartbeats if using the new <code class="docutils literal notranslate"><span class="pre">pyamqp://</span></code> transport.</p>
<blockquote>
<div><ul>
<li><p>The <a class="extlink-pypi reference external" href="https://pypi.org/project/amqp/">https://pypi.org/project/amqp/</a> transport requires the <a class="extlink-pypi reference external" href="https://pypi.org/project/amqp/">https://pypi.org/project/amqp/</a> library to be installed:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>amqp
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Then you need to set the transport URL prefix to <code class="docutils literal notranslate"><span class="pre">pyamqp://</span></code>.</p></li>
<li><p>The default heartbeat value is 10 seconds, but this can be changed using
the <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_HEARTBEAT</span></code> setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BROKER_HEARTBEAT</span> <span class="o">=</span> <span class="mf">5.0</span>
</pre></div>
</div>
</li>
<li><p>If the broker heartbeat is set to 10 seconds, the heartbeats will be
monitored every 5 seconds (double the heartbeat rate).</p></li>
</ul>
<p>See the <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-3-0" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.3 changelog</span></a> for more information.</p>
</div></blockquote>
</li>
<li><p>Now supports RabbitMQ Consumer Cancel Notifications, using the <code class="docutils literal notranslate"><span class="pre">pyamqp://</span></code>
transport.</p>
<blockquote>
<div><p>This is essential when running RabbitMQ in a cluster.</p>
<p>See the <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-2-3-0" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 2.3 changelog</span></a> for more information.</p>
</div></blockquote>
</li>
<li><p>Delivery info is no longer passed directly through.</p>
<blockquote>
<div><p>It was discovered that the SQS transport adds objects that can't
be pickled to the delivery info mapping, so we had to go back
to using the white-list again.</p>
<p>Fixing this bug also means that the SQS transport is now working again.</p>
</div></blockquote>
</li>
<li><p>The semaphore wasn't properly released when a task was revoked (<span class="xref issue">Issue #877</span>).</p>
<blockquote>
<div><p>This could lead to tasks being swallowed and not released until a worker
restart.</p>
<p>Thanks to Hynek Schlawack for debugging the issue.</p>
</div></blockquote>
</li>
<li><p>Retrying a task now also forwards any linked tasks.</p>
<blockquote>
<div><p>This means that if a task is part of a chain (or linked in some other
way) and that even if the task is retried, then the next task in the chain
will be executed when the retry succeeds.</p>
</div></blockquote>
</li>
<li><p>Chords: Now supports setting the interval and other keyword arguments
to the chord unlock task.</p>
<blockquote>
<div><ul>
<li><p>The interval can now be set as part of the chord subtasks kwargs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chord</span><span class="p">(</span><span class="n">header</span><span class="p">)(</span><span class="n">body</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>In addition the chord unlock task now honors the Task.default_retry_delay
option, used when none is specified, which also means that the default
interval can also be changed using annotations:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_ANNOTATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;celery.chord_unlock&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;default_retry_delay&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>New <a class="reference internal" href="../reference/celery.html#celery.Celery.add_defaults" title="celery.Celery.add_defaults"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.add_defaults()</span></code></a> method can add new default configuration
dictionaries to the applications configuration.</p>
<blockquote>
<div><p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FOO&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_defaults</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p>is the same as <code class="docutils literal notranslate"><span class="pre">app.conf.update(config)</span></code> except that data won't be
copied, and that it won't be pickled when the worker spawns child
processes.</p>
<p>In addition the method accepts a callable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initialize_config</span><span class="p">():</span>
    <span class="c1"># insert heavy stuff that can&#39;t be done at import time here.</span>

<span class="n">app</span><span class="o">.</span><span class="n">add_defaults</span><span class="p">(</span><span class="n">initialize_config</span><span class="p">)</span>
</pre></div>
</div>
<p>which means the same as the above except that it won't happen
until the Celery configuration is actually used.</p>
<p>As an example, Celery can lazily use the configuration of a Flask app:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flask_app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">()</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">add_defaults</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">flask_app</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Revoked tasks weren't marked as revoked in the result backend (<span class="xref issue">Issue #871</span>).</p>
<blockquote>
<div><p>Fix contributed by Hynek Schlawack.</p>
</div></blockquote>
</li>
<li><p>Event-loop now properly handles the case when the <em class="manpage">epoll</em> poller
object has been closed (<span class="xref issue">Issue #882</span>).</p></li>
<li><p>Fixed syntax error in <code class="docutils literal notranslate"><span class="pre">funtests/test_leak.py</span></code></p>
<blockquote>
<div><p>Fix contributed by Catalin Iacob.</p>
</div></blockquote>
</li>
<li><p>group/chunks: Now accepts empty task list (<span class="xref issue">Issue #873</span>).</p></li>
<li><p>New method names:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Celery.default_connection()</span></code> ➠  <a class="reference internal" href="../reference/celery.html#celery.Celery.connection_or_acquire" title="celery.Celery.connection_or_acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">connection_or_acquire()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Celery.default_producer()</span></code>   ➠  <a class="reference internal" href="../reference/celery.html#celery.Celery.producer_or_acquire" title="celery.Celery.producer_or_acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">producer_or_acquire()</span></code></a>.</p></li>
</ul>
<p>The old names still work for backward compatibility.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="version-3-0-3">
<span id="id22"></span><h2>3.0.3<a class="headerlink" href="#version-3-0-3" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-07-20 09:17 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul class="simple">
<li><p><a class="extlink-pypi reference external" href="https://pypi.org/project/amqplib/">https://pypi.org/project/amqplib/</a> passes the channel object as part of the delivery_info
and it's not pickleable, so we now remove it.</p></li>
</ul>
</section>
<section id="version-3-0-2">
<span id="id23"></span><h2>3.0.2<a class="headerlink" href="#version-3-0-2" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-07-20 04:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><dl>
<dt>A bug caused the following task options to not take defaults from the</dt><dd><p>configuration (<span class="xref issue">Issue #867</span> + <span class="xref issue">Issue #858</span>)</p>
<blockquote>
<div><p>The following settings were affected:</p>
<ul class="simple">
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_IGNORE_RESULT</span></code></p></li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_SEND_TASK_ERROR_EMAILS</span></code></p></li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TRACK_STARTED</span></code></p></li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CElERY_STORE_ERRORS_EVEN_IF_IGNORED</span></code></p></li>
</ul>
<p>Fix contributed by John Watson.</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><p>Task Request: <code class="docutils literal notranslate"><span class="pre">delivery_info</span></code> is now passed through as-is (<span class="xref issue">Issue #807</span>).</p></li>
<li><p>The ETA argument now supports datetime's with a timezone set (<span class="xref issue">Issue #855</span>).</p></li>
<li><p>The worker's banner displayed the autoscale settings in the wrong order
(<span class="xref issue">Issue #859</span>).</p></li>
<li><p>Extension commands are now loaded after concurrency is set up
so that they don't interfere with things like eventlet patching.</p></li>
<li><p>Fixed bug in the threaded pool (<span class="xref issue">Issue #863</span>)</p></li>
<li><p>The task failure handler mixed up the fields in <a class="reference external" href="https://docs.python.org/dev/library/sys.html#sys.exc_info" title="（在 Python v3.15）"><code class="xref py py-func docutils literal notranslate"><span class="pre">sys.exc_info()</span></code></a>.</p>
<blockquote>
<div><p>Fix contributed by Rinat Shigapov.</p>
</div></blockquote>
</li>
<li><p>Fixed typos and wording in the docs.</p>
<blockquote>
<div><p>Fix contributed by Paul McMillan</p>
</div></blockquote>
</li>
<li><p>New setting: <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_WORKER_DIRECT</span></code></p>
<blockquote>
<div><p>If enabled each worker will consume from their own dedicated queue
which can be used to route tasks to specific workers.</p>
</div></blockquote>
</li>
<li><p>Fixed several edge case bugs in the add consumer remote control command.</p></li>
<li><p><a class="reference internal" href="../reference/celery.contrib.migrate.html#module-celery.contrib.migrate" title="celery.contrib.migrate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">migrate</span></code></a>: Can now filter and move tasks to specific
workers if <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_WORKER_DIRECT</span></code> is enabled.</p>
<blockquote>
<div><p>Among other improvements, the following functions have been added:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">move_direct(filterfun,</span> <span class="pre">**opts)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">move_direct_by_id(task_id,</span> <span class="pre">worker_hostname,</span> <span class="pre">**opts)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">move_direct_by_idmap({task_id:</span> <span class="pre">worker_hostname,</span> <span class="pre">...},</span> <span class="pre">**opts)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">move_direct_by_taskmap({task_name:</span> <span class="pre">worker_hostname,</span> <span class="pre">...},</span> <span class="pre">**opts)</span></code></p></li>
</ul>
</div></blockquote>
</div></blockquote>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">default_connection()</span></code> now accepts a pool argument that
if set to false causes a new connection to be created instead of acquiring
one from the pool.</p></li>
<li><p>New signal: <a class="reference internal" href="../userguide/signals.html#std-signal-celeryd_after_setup"><code class="xref std std-signal docutils literal notranslate"><span class="pre">celeryd_after_setup</span></code></a>.</p></li>
<li><p>Default loader now keeps lowercase attributes from the configuration module.</p></li>
</ul>
</section>
<section id="version-3-0-1">
<span id="id24"></span><h2>3.0.1<a class="headerlink" href="#version-3-0-1" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-07-10 06:00 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<ul>
<li><p>Now depends on kombu 2.2.5</p></li>
<li><p>inspect now supports limit argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myapp</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ping</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Beat: now works with timezone aware datetime's.</p></li>
<li><p>Task classes inheriting <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">celery</span> <span class="pre">import</span> <span class="pre">Task</span></code>
mistakenly enabled <code class="docutils literal notranslate"><span class="pre">accept_magic_kwargs</span></code>.</p></li>
<li><p>Fixed bug in <code class="docutils literal notranslate"><span class="pre">inspect</span> <span class="pre">scheduled</span></code> (<span class="xref issue">Issue #829</span>).</p></li>
<li><p>Beat: Now resets the schedule to upgrade to UTC.</p></li>
<li><p>The <strong class="program">celery worker</strong> command now works with eventlet/gevent.</p>
<blockquote>
<div><p>Previously it wouldn't patch the environment early enough.</p>
</div></blockquote>
</li>
<li><p>The <strong class="program">celery</strong> command now supports extension commands
using setuptools entry-points.</p>
<blockquote>
<div><p>Libraries can add additional commands to the <strong class="program">celery</strong>
command by adding an entry-point like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;celery.commands&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;foo = my.module:Command&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">],</span>
<span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The command must then support the interface of
<code class="xref py py-class docutils literal notranslate"><span class="pre">celery.bin.base.Command</span></code>.</p>
</div></blockquote>
</li>
<li><p>contrib.migrate: New utilities to move tasks from one queue to another.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">move_tasks()</span></code></p></li>
<li><p><a class="reference internal" href="../reference/celery.contrib.migrate.html#celery.contrib.migrate.move_task_by_id" title="celery.contrib.migrate.move_task_by_id"><code class="xref py py-func docutils literal notranslate"><span class="pre">move_task_by_id()</span></code></a></p></li>
</ul>
</div></blockquote>
</li>
<li><p>The <a class="reference internal" href="../userguide/monitoring.html#std-event-task-sent"><code class="xref std std-event docutils literal notranslate"><span class="pre">task-sent</span></code></a> event now contains <code class="docutils literal notranslate"><span class="pre">exchange</span></code> and <code class="docutils literal notranslate"><span class="pre">routing_key</span></code>
fields.</p></li>
<li><p>Fixes bug with installing on Python 3.</p>
<blockquote>
<div><p>Fix contributed by Jed Smith.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="chiastic-slide">
<span id="version-3-0-0"></span><h2>3.0.0 (Chiastic Slide)<a class="headerlink" href="#chiastic-slide" title="Link to this heading">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">release-date<span class="colon">:</span></dt>
<dd class="field-odd"><p>2012-07-07 01:30 p.m. BST</p>
</dd>
<dt class="field-even">release-by<span class="colon">:</span></dt>
<dd class="field-even"><p>Ask Solem</p>
</dd>
</dl>
<p>See <a class="reference internal" href="whatsnew-3.0.html#whatsnew-3-0"><span class="std std-ref">What's new in Celery 3.0 (Chiastic Slide)</span></a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="whatsnew-2.5.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">What's new in Celery 2.5</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="whatsnew-3.0.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">What's new in Celery 3.0 (Chiastic Slide)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2009-2023, Ask Solem &amp; contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Change history for Celery 3.0</a><ul>
<li><a class="reference internal" href="#version-3-0-24">3.0.24</a></li>
<li><a class="reference internal" href="#version-3-0-23">3.0.23</a></li>
<li><a class="reference internal" href="#version-3-0-22">3.0.22</a></li>
<li><a class="reference internal" href="#version-3-0-21">3.0.21</a></li>
<li><a class="reference internal" href="#version-3-0-20">3.0.20</a></li>
<li><a class="reference internal" href="#version-3-0-19">3.0.19</a></li>
<li><a class="reference internal" href="#version-3-0-18">3.0.18</a></li>
<li><a class="reference internal" href="#version-3-0-17">3.0.17</a></li>
<li><a class="reference internal" href="#version-3-0-16">3.0.16</a></li>
<li><a class="reference internal" href="#version-3-0-15">3.0.15</a></li>
<li><a class="reference internal" href="#version-3-0-14">3.0.14</a></li>
<li><a class="reference internal" href="#version-3-0-13">3.0.13</a></li>
<li><a class="reference internal" href="#id13">3.0.12</a></li>
<li><a class="reference internal" href="#version-3-0-11">3.0.11</a></li>
<li><a class="reference internal" href="#version-3-0-10">3.0.10</a></li>
<li><a class="reference internal" href="#id16">3.0.9</a></li>
<li><a class="reference internal" href="#version-3-0-8">3.0.8</a></li>
<li><a class="reference internal" href="#version-3-0-7">3.0.7</a></li>
<li><a class="reference internal" href="#version-3-0-6">3.0.6</a></li>
<li><a class="reference internal" href="#version-3-0-5">3.0.5</a></li>
<li><a class="reference internal" href="#version-3-0-4">3.0.4</a></li>
<li><a class="reference internal" href="#version-3-0-3">3.0.3</a></li>
<li><a class="reference internal" href="#version-3-0-2">3.0.2</a></li>
<li><a class="reference internal" href="#version-3-0-1">3.0.1</a></li>
<li><a class="reference internal" href="#chiastic-slide">3.0.0 (Chiastic Slide)</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8156d91f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>