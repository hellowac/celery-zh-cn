<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="Change history" href="changelog-3.1.html" /><link rel="prev" title="Change history" href="changelog-4.0.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>What&#39;s new in Celery 3.1 (Cipater) - Celery 5.5.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css?v=112ca36d" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Celery 5.5.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/celery_512_1.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Celery 5.5.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">版权</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">快速开始</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 快速开始</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/introduction.html">Celery 简介</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/backends-and-brokers/index.html">Backends 和 Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Backends 和 Brokers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/rabbitmq.html">使用 RabbitMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/redis.html">使用 Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/sqs.html">使用 Amazon SQS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/kafka.html">使用 Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/gcpubsub.html">使用 Google Pub/Sub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/first-steps-with-celery.html">使用 Celery 的第一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/next-steps.html">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/resources.html">资源</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../userguide/index.html">用户指南</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 用户指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../userguide/application.html">应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/tasks.html">任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/calling.html">调用任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/canvas.html">Canvas：设计工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/workers.html">Workers 指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/daemonizing.html">守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/periodic-tasks.html">周期性任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/routing.html">路由任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/monitoring.html">监控和管理指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/optimizing.html">优化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/debugging.html">调试</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../userguide/concurrency/index.html">并发</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 并发</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/eventlet.html">Eventlet 并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/gevent.html">gevent 并发</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/signals.html">信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/testing.html">使用 Celery 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/extending.html">扩展 和 Bootsteps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/configuration.html">配置和默认值</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/sphinx.html">使用 Sphinx 文档化任务</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../django/index.html">Django</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Django</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../django/first-steps-with-django.html">使用 Django 的第一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">社区资源</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/task-cookbook.html">Task Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">更改历史</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API 参考</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API 参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">命令行接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code> --- Distributed processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html">Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.task.html"><code class="docutils literal notranslate"><span class="pre">celery.app.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html">AMQP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html#queues">Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.defaults.html"><code class="docutils literal notranslate"><span class="pre">celery.app.defaults</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.control.html"><code class="docutils literal notranslate"><span class="pre">celery.app.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.registry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.registry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.app.backends</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.builtins.html"><code class="docutils literal notranslate"><span class="pre">celery.app.builtins</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.events.html"><code class="docutils literal notranslate"><span class="pre">celery.app.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.log.html"><code class="docutils literal notranslate"><span class="pre">celery.app.log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.app.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.autoretry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.autoretry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bootsteps.html"><code class="docutils literal notranslate"><span class="pre">celery.bootsteps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.result.html"><code class="docutils literal notranslate"><span class="pre">celery.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.schedules.html"><code class="docutils literal notranslate"><span class="pre">celery.schedules</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.signals.html"><code class="docutils literal notranslate"><span class="pre">celery.signals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.security.html"><code class="docutils literal notranslate"><span class="pre">celery.security</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.utils.debug.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.debug</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.exceptions.html"><code class="docutils literal notranslate"><span class="pre">celery.exceptions</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.app.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.default.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.base.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html">States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#sets">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.FAILURE"><code class="docutils literal notranslate"><span class="pre">FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.PENDING"><code class="docutils literal notranslate"><span class="pre">PENDING</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RECEIVED"><code class="docutils literal notranslate"><span class="pre">RECEIVED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RETRY"><code class="docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.REVOKED"><code class="docutils literal notranslate"><span class="pre">REVOKED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.STARTED"><code class="docutils literal notranslate"><span class="pre">STARTED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.SUCCESS"><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.precedence"><code class="docutils literal notranslate"><span class="pre">precedence()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.abortable.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.django.task.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.django.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.pytest.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.pytest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.sphinx.html">celery.contrib.sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.app.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.manager.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.manager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.mocks.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.mocks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.rdb.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.html"><code class="docutils literal notranslate"><span class="pre">celery.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.receiver.html"><code class="docutils literal notranslate"><span class="pre">celery.events.receiver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.dispatcher.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.event.html"><code class="docutils literal notranslate"><span class="pre">celery.events.event</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.state.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.request.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.request</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.state.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.strategy.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.agent.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.connection.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.events.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.gossip.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.gossip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.heart.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.heart</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.mingle.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.mingle</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.tasks.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.tasks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.base.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.celery.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.celery</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.events.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.logtool.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.logtool</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.amqp.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.amqp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.graph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.call.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.call</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.control.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.list.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.list</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.purge.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.purge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.result.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.shell.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.shell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.upgrade.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.upgrade</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/index.html">内部</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/guide.html">代码贡献指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/deprecation.html">Celery 弃用时间表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/worker.html">内部的 worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/protocol.html">消息协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/app-overview.html">“大实例”重构</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../internals/reference/index.html">内部模块参考</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 内部模块参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.components.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.loops.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.loops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.heartbeat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.pidbox.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.pidbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.autoscale.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.autoscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.solo.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.solo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.eventlet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.gevent.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.gevent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.thread.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.base.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.backends</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.base.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.asynchronous.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.asynchronous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.azureblockblob.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.azureblockblob</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.rpc.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cache.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.consul.html">celery.backends.consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchdb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.mongodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.mongodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.elasticsearch.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.elasticsearch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.redis.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cassandra.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cassandra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchbase.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchbase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.arangodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.arangodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.dynamodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.dynamodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.filesystem.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.filesystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cosmosdbsql.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cosmosdbsql</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.s3.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.s3</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.gcs.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.gcs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.trace.html"><code class="docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.annotations.html"><code class="docutils literal notranslate"><span class="pre">celery.app.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.routes.html"><code class="docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.certificate.html"><code class="docutils literal notranslate"><span class="pre">celery.security.certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.key.html"><code class="docutils literal notranslate"><span class="pre">celery.security.key</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.security.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.security.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.snapshot.html"><code class="docutils literal notranslate"><span class="pre">celery.events.snapshot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.cursesmon.html"><code class="docutils literal notranslate"><span class="pre">celery.events.cursesmon</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.dumper.html"><code class="docutils literal notranslate"><span class="pre">celery.events.dumper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.models.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.session.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.session</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.abstract.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.abstract</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.collections.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.collections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.nodenames.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.nodenames</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.deprecated.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.deprecated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.functional.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.graph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.objects.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.term.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.term</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.time.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.iso8601.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.iso8601</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.saferepr.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.saferepr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.sysinfo.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.sysinfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.threads.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.timer2.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.timer2</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.imports.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.log.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.text.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch.signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.platforms.html"><code class="docutils literal notranslate"><span class="pre">celery.platforms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery._state.html"><code class="docutils literal notranslate"><span class="pre">celery._state</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">历史</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 历史</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.5.html">What's new in Celery 5.5 (Immunity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.5.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.4.html">What's new in Celery 5.4 (Opalescent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.3.html">What's new in Celery 5.3 (Emerald Rush)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.1.html">What's new in Celery 5.1 (Sun Harmonics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.0.html">What's new in Celery 5.0 (singularity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.4.html">What's new in Celery 4.4 (Cliffs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.3.html">What's new in Celery 4.3 (rhubarb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.2.html">What's new in Celery 4.2 (windowlicker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.2.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.1.html">What's new in Celery 4.1 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.0.html">What's new in Celery 4.0 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.0.html">Change history</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">What's new in Celery 3.1 (Cipater)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-3.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-3.0.html">What's new in Celery 3.0 (Chiastic Slide)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-3.0.html">Change history for Celery 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-2.5.html">What's new in Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.5.html">Change history for Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.4.html">Change history for Celery 2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.3.html">Change history for Celery 2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.2.html">Change history for Celery 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.1.html">Change history for Celery 2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.0.html">Change history for Celery 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-1.0.html">Change history for Celery 1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

</div>
<!-- <iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe> -->
<div id="donate">
  <h5>捐赠</h5>
  <p>请捐赠以支持这个社区项目</p>
  <a href="https://opencollective.com/celery/donate" target="_blank">
    <!-- <img src="https://opencollective.com/celery/donate/button@2x.png?color=blue" /> -->
    <img src="https://opencollective.com/celery/donate/button.png?color=blue" />
  </a>
</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/history/whatsnew-3.1.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="what-s-new-in-celery-3-1-cipater">
<span id="whatsnew-3-1"></span><h1>What's new in Celery 3.1 (Cipater)<a class="headerlink" href="#what-s-new-in-celery-3-1-cipater" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ask Solem (<code class="docutils literal notranslate"><span class="pre">ask</span> <span class="pre">at</span> <span class="pre">celeryproject.org</span></code>)</p>
</dd>
</dl>
<aside class="sidebar">
<p class="sidebar-title">Change history</p>
<p>What's new documents describe the changes in major versions,
we also have a <a class="reference internal" href="../changelog.html#changelog"><span class="std std-ref">更改历史</span></a> that lists the changes in bugfix
releases (0.0.x), while older series are archived under the <a class="reference internal" href="index.html#history"><span class="std std-ref">历史</span></a>
section.</p>
</aside>
<p>Celery is a simple, flexible, and reliable distributed system to
process vast amounts of messages, while providing operations with
the tools required to maintain such a system.</p>
<p>It's a task queue with focus on real-time processing, while also
supporting task scheduling.</p>
<p>Celery has a large and diverse community of users and contributors,
you should come join us <span class="xref std std-ref">on IRC</span>
or <span class="xref std std-ref">our mailing-list</span>.</p>
<p>To read more about Celery you should go read the <a class="reference internal" href="../getting-started/introduction.html#intro"><span class="std std-ref">introduction</span></a>.</p>
<p>While this version is backward compatible with previous versions
it's important that you read the following section.</p>
<p>This version is officially supported on CPython 2.6, 2.7, and 3.3,
and also supported on PyPy.</p>
<aside class="topic">
<p class="topic-title">Table of Contents</p>
<p>Make sure you read the important notes before upgrading to this version.</p>
</aside>
<section id="preface">
<h2>Preface<a class="headerlink" href="#preface" title="Link to this heading">¶</a></h2>
<p>Deadlocks have long plagued our workers, and while uncommon they're
not acceptable. They're also infamous for being extremely hard to diagnose
and reproduce, so to make this job easier I wrote a stress test suite that
bombards the worker with different tasks in an attempt to break it.</p>
<p>What happens if thousands of worker child processes are killed every
second? what if we also kill the broker connection every 10
seconds?  These are examples of what the stress test suite will do to the
worker, and it reruns these tests using different configuration combinations
to find edge case bugs.</p>
<p>The end result was that I had to rewrite the prefork pool to avoid the use
of the POSIX semaphore. This was extremely challenging, but after
months of hard work the worker now finally passes the stress test suite.</p>
<p>There's probably more bugs to find, but the good news is
that we now have a tool to reproduce them, so should you be so unlucky to
experience a bug then we'll write a test for it and squash it!</p>
<p>Note that I've also moved many broker transports into experimental status:
the only transports recommended for production use today is RabbitMQ and
Redis.</p>
<p>I don't have the resources to maintain all of them, so bugs are left
unresolved. I wish that someone will step up and take responsibility for
these transports or donate resources to improve them, but  as the situation
is now I don't think the quality is up to date with the rest of the code-base
so I cannot recommend them for production use.</p>
<p>The next version of Celery 4.0 will focus on performance and removing
rarely used parts of the library. Work has also started on a new message
protocol, supporting multiple languages and more. The initial draft can
be found <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">here</span></a>.</p>
<p>This has probably been the hardest release I've worked on, so no
introduction to this changelog would be complete without a massive
thank you to everyone who contributed and helped me test it!</p>
<p>Thank you for your support!</p>
<p><em>— Ask Solem</em></p>
</section>
<section id="important-notes">
<span id="v310-important"></span><h2>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading">¶</a></h2>
<section id="dropped-support-for-python-2-5">
<h3>Dropped support for Python 2.5<a class="headerlink" href="#dropped-support-for-python-2-5" title="Link to this heading">¶</a></h3>
<p>Celery now requires Python 2.6 or later.</p>
<p>The new dual code base runs on both Python 2 and 3, without
requiring the <code class="docutils literal notranslate"><span class="pre">2to3</span></code> porting tool.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>This is also the last version to support Python 2.6! From Celery 4.0 and
on-wards Python 2.7 or later will be required.</p>
</div>
</section>
<section id="last-version-to-enable-pickle-by-default">
<span id="last-version-to-enable-pickle"></span><h3>Last version to enable Pickle by default<a class="headerlink" href="#last-version-to-enable-pickle-by-default" title="Link to this heading">¶</a></h3>
<p>Starting from Celery 4.0 the default serializer will be json.</p>
<p>If you depend on pickle being accepted you should be prepared
for this change by explicitly allowing your worker
to consume pickled messages using the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ACCEPT_CONTENT</span></code>
setting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_ACCEPT_CONTENT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;msgpack&#39;</span><span class="p">,</span> <span class="s1">&#39;yaml&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Make sure you only select the serialization formats you'll actually be using,
and make sure you've properly secured your broker from unwanted access
(see the <a class="reference internal" href="../userguide/security.html#guide-security"><span class="std std-ref">Security Guide</span></a>).</p>
<p>The worker will emit a deprecation warning if you don't define this setting.</p>
<aside class="topic">
<p class="topic-title">for Kombu users</p>
<p>Kombu 3.0 no longer accepts pickled messages by default, so if you
use Kombu directly then you have to configure your consumers:
see the <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-3-0-0" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 3.0 Changelog</span></a> for more
information.</p>
</aside>
</section>
<section id="old-command-line-programs-removed-and-deprecated">
<h3>Old command-line programs removed and deprecated<a class="headerlink" href="#old-command-line-programs-removed-and-deprecated" title="Link to this heading">¶</a></h3>
<p>Everyone should move to the new <strong class="program">celery</strong> umbrella
command, so we're incrementally deprecating the old command names.</p>
<p>In this version we've removed all commands that aren't used
in init-scripts. The rest will be removed in 4.0.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Program</p></th>
<th class="head"><p>New Status</p></th>
<th class="head"><p>Replacement</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">celeryd</span></code></p></td>
<td><p><em>DEPRECATED</em></p></td>
<td><p><strong class="program">celery worker</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">celerybeat</span></code></p></td>
<td><p><em>DEPRECATED</em></p></td>
<td><p><strong class="program">celery beat</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">celeryd-multi</span></code></p></td>
<td><p><em>DEPRECATED</em></p></td>
<td><p><strong class="program">celery multi</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">celeryctl</span></code></p></td>
<td><p><strong>REMOVED</strong></p></td>
<td><p><strong class="program">celery inspect|control</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">celeryev</span></code></p></td>
<td><p><strong>REMOVED</strong></p></td>
<td><p><strong class="program">celery events</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">camqadm</span></code></p></td>
<td><p><strong>REMOVED</strong></p></td>
<td><p><strong class="program">celery amqp</strong></p></td>
</tr>
</tbody>
</table>
</div>
<p>If this isn't a new installation then you may want to remove the old
commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>uninstall<span class="w"> </span>celery
<span class="gp">$ </span><span class="c1"># repeat until it fails</span>
<span class="gp"># </span>...
<span class="gp">$ </span>pip<span class="w"> </span>uninstall<span class="w"> </span>celery
<span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>celery
</pre></div>
</div>
<p>Please run <strong class="program">celery --help</strong> for help using the umbrella command.</p>
</section>
</section>
<section id="news">
<span id="v310-news"></span><h2>News<a class="headerlink" href="#news" title="Link to this heading">¶</a></h2>
<section id="prefork-pool-improvements">
<h3>Prefork Pool Improvements<a class="headerlink" href="#prefork-pool-improvements" title="Link to this heading">¶</a></h3>
<p>These improvements are only active if you use an async capable
transport. This means only RabbitMQ (AMQP) and Redis are supported
at this point and other transports will still use the thread-based fallback
implementation.</p>
<ul>
<li><p>Pool is now using one IPC queue per child process.</p>
<blockquote>
<div><p>Previously the pool shared one queue between all child processes,
using a POSIX semaphore as a mutex to achieve exclusive read and write
access.</p>
<p>The POSIX semaphore has now been removed and each child process
gets a dedicated queue. This means that the worker will require more
file descriptors (two descriptors per process), but it also means
that performance is improved and we can send work to individual child
processes.</p>
<p>POSIX semaphores aren't released when a process is killed, so killing
processes could lead to a deadlock if it happened while the semaphore was
acquired. There's no good solution to fix this, so the best option
was to remove the semaphore.</p>
</div></blockquote>
</li>
<li><p>Asynchronous write operations</p>
<blockquote>
<div><p>The pool now uses async I/O to send work to the child processes.</p>
</div></blockquote>
</li>
<li><p>Lost process detection is now immediate.</p>
<blockquote>
<div><p>If a child process is killed or exits mysteriously the pool previously
had to wait for 30 seconds before marking the task with a
<a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.WorkerLostError" title="celery.exceptions.WorkerLostError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">WorkerLostError</span></code></a>. It had to do this because
the out-queue was shared between all processes, and the pool couldn't
be certain whether the process completed the task or not. So an arbitrary
timeout of 30 seconds was chosen, as it was believed that the out-queue
would've been drained by this point.</p>
<p>This timeout is no longer necessary, and so the task can be marked as
failed as soon as the pool gets the notification that the process exited.</p>
</div></blockquote>
</li>
<li><p>Rare race conditions fixed</p>
<blockquote>
<div><p>Most of these bugs were never reported to us, but were discovered while
running the new stress test suite.</p>
</div></blockquote>
</li>
</ul>
<section id="caveats">
<h4>Caveats<a class="headerlink" href="#caveats" title="Link to this heading">¶</a></h4>
<aside class="topic">
<p class="topic-title">Long running tasks</p>
<p>The new pool will send tasks to a child process as long as the process
in-queue is writable, and since the socket is buffered this means
that the processes are, in effect, prefetching tasks.</p>
<p>This benefits performance but it also means that other tasks may be stuck
waiting for a long running task to complete:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-&gt;</span> <span class="n">send</span> <span class="n">T1</span> <span class="n">to</span> <span class="n">Process</span> <span class="n">A</span>
<span class="c1"># A executes T1</span>
<span class="o">-&gt;</span> <span class="n">send</span> <span class="n">T2</span> <span class="n">to</span> <span class="n">Process</span> <span class="n">B</span>
<span class="c1"># B executes T2</span>
<span class="o">&lt;-</span> <span class="n">T2</span> <span class="n">complete</span>

<span class="o">-&gt;</span> <span class="n">send</span> <span class="n">T3</span> <span class="n">to</span> <span class="n">Process</span> <span class="n">A</span>
<span class="c1"># A still executing T1, T3 stuck in local buffer and</span>
<span class="c1"># won&#39;t start until T1 returns</span>
</pre></div>
</div>
<p>The buffer size varies based on the operating system: some may
have a buffer as small as 64KB but on recent Linux versions the buffer
size is 1MB (can only be changed system wide).</p>
<p>You can disable this prefetching behavior by enabling the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-O"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Ofair</span></code></a> worker option:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-l<span class="w"> </span>info<span class="w"> </span>-Ofair
</pre></div>
</div>
<p>With this option enabled the worker will only write to workers that are
available for work, disabling the prefetch behavior.</p>
</aside>
<aside class="topic">
<p class="topic-title">Max tasks per child</p>
<p>If a process exits and pool prefetch is enabled the worker may have
already written many tasks to the process in-queue, and these tasks
must then be moved back and rewritten to a new process.</p>
<p>This is very expensive if you have the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-max-tasks-per-child"><code class="xref std std-option docutils literal notranslate"><span class="pre">--max-tasks-per-child</span></code></a>
option set to a low value (e.g., less than 10), you should not be
using the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-O"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Ofast</span></code></a> scheduler option.</p>
</aside>
</section>
</section>
<section id="django-supported-out-of-the-box">
<h3>Django supported out of the box<a class="headerlink" href="#django-supported-out-of-the-box" title="Link to this heading">¶</a></h3>
<p>Celery 3.0 introduced a shiny new API, but unfortunately didn't
have a solution for Django users.</p>
<p>The situation changes with this version as Django is now supported
in core and new Django users coming to Celery are now expected
to use the new API directly.</p>
<p>The Django community has a convention where there's a separate
<code class="docutils literal notranslate"><span class="pre">django-x</span></code> package for every library, acting like a bridge between
Django and the library.</p>
<p>Having a separate project for Django users has been a pain for Celery,
with multiple issue trackers and multiple documentation
sources, and then lastly since 3.0 we even had different APIs.</p>
<p>With this version we challenge that convention and Django users will
use the same library, the same API and the same documentation as
everyone else.</p>
<p>There's no rush to port your existing code to use the new API,
but if you'd like to experiment with it you should know that:</p>
<ul>
<li><p>You need to use a Celery application instance.</p>
<blockquote>
<div><p>The new Celery API introduced in 3.0 requires users to instantiate the
library by creating an application:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>You need to explicitly integrate Celery with Django</p>
<blockquote>
<div><p>Celery won't automatically use the Django settings, so you can
either configure Celery separately or you can tell it to use the Django
settings with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">config_from_object</span><span class="p">(</span><span class="s1">&#39;django.conf:settings&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Neither will it automatically traverse your installed apps to find task
modules. If you want this behavior, you must explicitly pass a list of
Django instances to the Celery app:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">django.conf</span><span class="w"> </span><span class="kn">import</span> <span class="n">settings</span>
<span class="n">app</span><span class="o">.</span><span class="n">autodiscover_tasks</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">INSTALLED_APPS</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>You no longer use <code class="docutils literal notranslate"><span class="pre">manage.py</span></code></p>
<blockquote>
<div><p>Instead you use the <strong class="program">celery</strong> command directly:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-l<span class="w"> </span>info
</pre></div>
</div>
<p>For this to work your app module must store the  <span class="target" id="index-0"></span><a class="reference external" href="http://docs.djangoproject.com/en/dev/topics/settings/#envvar-DJANGO_SETTINGS_MODULE" title="（在 Django v6.0）"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DJANGO_SETTINGS_MODULE</span></code></a>
environment variable, see the example in the <a class="reference internal" href="../django/first-steps-with-django.html#django-first-steps"><span class="std std-ref">Django
guide</span></a>.</p>
</div></blockquote>
</li>
</ul>
<p>To get started with the new API you should first read the <a class="reference internal" href="../getting-started/first-steps-with-celery.html#first-steps"><span class="std std-ref">使用 Celery 的第一步</span></a>
tutorial, and then you should read the Django-specific instructions in
<a class="reference internal" href="../django/first-steps-with-django.html#django-first-steps"><span class="std std-ref">使用 Django 的第一步</span></a>.</p>
<p>The fixes and improvements applied by the <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> library
are now automatically applied by core Celery when it detects that
the <span class="target" id="index-1"></span><a class="reference external" href="http://docs.djangoproject.com/en/dev/topics/settings/#envvar-DJANGO_SETTINGS_MODULE" title="（在 Django v6.0）"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DJANGO_SETTINGS_MODULE</span></code></a> environment variable is set.</p>
<p>The distribution ships with a new example project using Django
in <code class="file docutils literal notranslate"><span class="pre">examples/django</span></code>:</p>
<p><a class="reference external" href="https://github.com/celery/celery/tree/3.1/examples/django">https://github.com/celery/celery/tree/3.1/examples/django</a></p>
<p>Some features still require the <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a> library:</p>
<blockquote>
<div><ul class="simple">
<li><p>Celery doesn't implement the Django database or cache result backends.</p></li>
<li><dl class="simple">
<dt>Celery doesn't ship with the database-based periodic task</dt><dd><p>scheduler.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>If you're still using the old API when you upgrade to Celery 3.1
then you must make sure that your settings module contains
the <code class="docutils literal notranslate"><span class="pre">djcelery.setup_loader()</span></code> line, since this will
no longer happen as a side-effect of importing the <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">https://pypi.org/project/django-celery/</a>
module.</p>
<p>New users (or if you've ported to the new API) don't need the <code class="docutils literal notranslate"><span class="pre">setup_loader</span></code>
line anymore, and must make sure to remove it.</p>
</div>
</section>
<section id="events-are-now-ordered-using-logical-time">
<h3>Events are now ordered using logical time<a class="headerlink" href="#events-are-now-ordered-using-logical-time" title="Link to this heading">¶</a></h3>
<p>Keeping physical clocks in perfect sync is impossible, so using
time-stamps to order events in a distributed system isn't reliable.</p>
<p>Celery event messages have included a logical clock value for some time,
but starting with this version that field is also used to order them.</p>
<p>Also, events now record timezone information
by including a new <code class="docutils literal notranslate"><span class="pre">utcoffset</span></code> field in the event message.
This is a signed integer telling the difference from UTC time in hours,
so for example, an event sent from the Europe/London timezone in daylight savings
time will have an offset of 1.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">app.events.Receiver</span></code> will automatically convert the time-stamps
to the local timezone.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The logical clock is synchronized with other nodes
in the same cluster (neighbors), so this means that the logical
epoch will start at the point when the first worker in the cluster
starts.</p>
<p>If all of the workers are shutdown the clock value will be lost
and reset to 0. To protect against this, you should specify the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-S"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">--statedb</span></code></a> option such that the worker can
persist the clock value at shutdown.</p>
<p>You may notice that the logical clock is an integer value and
increases very rapidly. Don't worry about the value overflowing
though, as even in the most busy clusters it may take several
millennium before the clock exceeds a 64 bits value.</p>
</div>
</section>
<section id="new-worker-node-name-format-name-host">
<h3>New worker node name format (<code class="docutils literal notranslate"><span class="pre">name&#64;host</span></code>)<a class="headerlink" href="#new-worker-node-name-format-name-host" title="Link to this heading">¶</a></h3>
<p>Node names are now constructed by two elements: name and host-name
separated by '&#64;'.</p>
<p>This change was made to more easily identify multiple instances running
on the same machine.</p>
<p>If a custom name isn't specified then the
worker will use the name 'celery' by default, resulting in a
fully qualified node name of <a class="reference external" href="mailto:'celery&#37;&#52;&#48;hostname">'celery<span>&#64;</span>hostname</a>':</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>-n<span class="w"> </span>example.com
<span class="go">celery@example.com</span>
</pre></div>
</div>
<p>To also set the name you must include the &#64;:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>-n<span class="w"> </span>worker1@example.com
<span class="go">worker1@example.com</span>
</pre></div>
</div>
<p>The worker will identify itself using the fully qualified
node name in events and broadcast messages, so where before
a worker would identify itself as 'worker1.example.com', it'll now
use <a class="reference external" href="mailto:'celery&#37;&#52;&#48;worker1&#46;example&#46;com">'celery<span>&#64;</span>worker1<span>&#46;</span>example<span>&#46;</span>com</a>'.</p>
<p>Remember that the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-n"><code class="xref std std-option docutils literal notranslate"><span class="pre">-n</span></code></a> argument also supports
simple variable substitutions, so if the current host-name
is <em>george.example.com</em> then the <code class="docutils literal notranslate"><span class="pre">%h</span></code> macro will expand into that:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>-n<span class="w"> </span>worker1@%h
<span class="go">worker1@george.example.com</span>
</pre></div>
</div>
<p>The available substitutions are as follows:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Substitution</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%h</span></code></p></td>
<td><p>Full host-name (including domain name)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%d</span></code></p></td>
<td><p>Domain name only</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%n</span></code></p></td>
<td><p>Host-name only (without domain name)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%%</span></code></p></td>
<td><p>The character <code class="docutils literal notranslate"><span class="pre">%</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="bound-tasks">
<h3>Bound tasks<a class="headerlink" href="#bound-tasks" title="Link to this heading">¶</a></h3>
<p>The task decorator can now create &quot;bound tasks&quot;, which means that the
task will receive the <code class="docutils literal notranslate"><span class="pre">self</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">send_twitter_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oauth</span><span class="p">,</span> <span class="n">tweet</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">twitter</span> <span class="o">=</span> <span class="n">Twitter</span><span class="p">(</span><span class="n">oauth</span><span class="p">)</span>
        <span class="n">twitter</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">Twitter</span><span class="o">.</span><span class="n">FailWhaleError</span><span class="p">,</span> <span class="n">Twitter</span><span class="o">.</span><span class="n">LoginError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exc</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <em>bound tasks</em> is now the recommended approach whenever
you need access to the task instance or request context.
Previously one would've to refer to the name of the task
instead (<code class="docutils literal notranslate"><span class="pre">send_twitter_status.retry</span></code>), but this could lead to problems
in some configurations.</p>
</section>
<section id="mingle-worker-synchronization">
<h3>Mingle: Worker synchronization<a class="headerlink" href="#mingle-worker-synchronization" title="Link to this heading">¶</a></h3>
<p>The worker will now attempt to synchronize with other workers in
the same cluster.</p>
<p>Synchronized data currently includes revoked tasks and logical clock.</p>
<p>This only happens at start-up and causes a one second start-up delay
to collect broadcast responses from other workers.</p>
<p>You can disable this bootstep using the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-without-mingle"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">--without-mingle</span></code></a> option.</p>
</section>
<section id="gossip-worker-worker-communication">
<h3>Gossip: Worker &lt;-&gt; Worker communication<a class="headerlink" href="#gossip-worker-worker-communication" title="Link to this heading">¶</a></h3>
<p>Workers are now passively subscribing to worker related events like
heartbeats.</p>
<p>This means that a worker knows what other workers are doing and
can detect if they go offline. Currently this is only used for clock
synchronization, but there are many possibilities for future additions
and you can write extensions that take advantage of this already.</p>
<p>Some ideas include consensus protocols, reroute task to best worker (based on
resource usage or data locality) or restarting workers when they crash.</p>
<p>We believe that although this is a small addition, it opens
amazing possibilities.</p>
<p>You can disable this bootstep using the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-without-gossip"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">--without-gossip</span></code></a> option.</p>
</section>
<section id="bootsteps-extending-the-worker">
<h3>Bootsteps: Extending the worker<a class="headerlink" href="#bootsteps-extending-the-worker" title="Link to this heading">¶</a></h3>
<p>By writing bootsteps you can now easily extend the consumer part
of the worker to add additional features, like custom message consumers.</p>
<p>The worker has been using bootsteps for some time, but these were never
documented. In this version the consumer part of the worker
has also been rewritten to use bootsteps and the new <a class="reference internal" href="../userguide/extending.html#guide-extending"><span class="std std-ref">扩展 和 Bootsteps</span></a>
guide documents examples extending the worker, including adding
custom message consumers.</p>
<p>See the <a class="reference internal" href="../userguide/extending.html#guide-extending"><span class="std std-ref">扩展 和 Bootsteps</span></a> guide for more information.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Bootsteps written for older versions won't be compatible
with this version, as the API has changed significantly.</p>
<p>The old API was experimental and internal but should you be so unlucky
to use it then please contact the mailing-list and we'll help you port
the bootstep to the new API.</p>
</div>
</section>
<section id="new-rpc-result-backend">
<h3>New RPC result backend<a class="headerlink" href="#new-rpc-result-backend" title="Link to this heading">¶</a></h3>
<p>This new experimental version of the <code class="docutils literal notranslate"><span class="pre">amqp</span></code> result backend is a good
alternative to use in classical RPC scenarios, where the process that initiates
the task is always the process to retrieve the result.</p>
<p>It uses Kombu to send and retrieve results, and each client
uses a unique queue for replies to be sent to. This avoids
the significant overhead of the original amqp result backend which creates
one queue per task.</p>
<p>By default results sent using this backend won't persist, so they won't
survive a broker restart. You can enable
the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_RESULT_PERSISTENT</span></code> setting to change that.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;rpc&#39;</span>
<span class="n">CELERY_RESULT_PERSISTENT</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Note that chords are currently not supported by the RPC backend.</p>
</section>
<section id="time-limits-can-now-be-set-by-the-client">
<h3>Time limits can now be set by the client<a class="headerlink" href="#time-limits-can-now-be-set-by-the-client" title="Link to this heading">¶</a></h3>
<p>Two new options have been added to the Calling API: <code class="docutils literal notranslate"><span class="pre">time_limit</span></code> and
<code class="docutils literal notranslate"><span class="pre">soft_time_limit</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">soft_time_limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">soft_time_limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">time_limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">soft_time_limit</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
</pre></div>
</div>
<p>Contributed by Mher Movsisyan.</p>
</section>
<section id="redis-broadcast-messages-and-virtual-hosts">
<h3>Redis: Broadcast messages and virtual hosts<a class="headerlink" href="#redis-broadcast-messages-and-virtual-hosts" title="Link to this heading">¶</a></h3>
<p>Broadcast messages are currently seen by all virtual hosts when
using the Redis transport. You can now fix this by enabling a prefix to all channels
so that the messages are separated:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BROKER_TRANSPORT_OPTIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fanout_prefix&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
<p>Note that you'll not be able to communicate with workers running older
versions or workers that doesn't have this setting enabled.</p>
<p>This setting will be the default in a future version.</p>
<p>Related to <span class="xref issue">Issue #1490</span>.</p>
</section>
<section id="https-pypi-org-project-pytz-replaces-https-pypi-org-project-python-dateutil-dependency">
<h3><a class="extlink-pypi reference external" href="https://pypi.org/project/pytz/">https://pypi.org/project/pytz/</a> replaces <a class="extlink-pypi reference external" href="https://pypi.org/project/python-dateutil/">https://pypi.org/project/python-dateutil/</a> dependency<a class="headerlink" href="#https-pypi-org-project-pytz-replaces-https-pypi-org-project-python-dateutil-dependency" title="Link to this heading">¶</a></h3>
<p>Celery no longer depends on the <a class="extlink-pypi reference external" href="https://pypi.org/project/python-dateutil/">https://pypi.org/project/python-dateutil/</a> library,
but instead a new dependency on the <a class="extlink-pypi reference external" href="https://pypi.org/project/pytz/">https://pypi.org/project/pytz/</a> library was added.</p>
<p>The <a class="extlink-pypi reference external" href="https://pypi.org/project/pytz/">https://pypi.org/project/pytz/</a> library was already recommended for accurate timezone support.</p>
<p>This also means that dependencies are the same for both Python 2 and
Python 3, and that the <code class="file docutils literal notranslate"><span class="pre">requirements/default-py3k.txt</span></code> file has
been removed.</p>
</section>
<section id="support-for-https-pypi-org-project-setuptools-extra-requirements">
<h3>Support for <a class="extlink-pypi reference external" href="https://pypi.org/project/setuptools/">https://pypi.org/project/setuptools/</a> extra requirements<a class="headerlink" href="#support-for-https-pypi-org-project-setuptools-extra-requirements" title="Link to this heading">¶</a></h3>
<p>Pip now supports the <a class="extlink-pypi reference external" href="https://pypi.org/project/setuptools/">https://pypi.org/project/setuptools/</a> extra requirements format,
so we've removed the old bundles concept, and instead specify
setuptools extras.</p>
<p>You install extras by specifying them inside brackets:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>celery<span class="o">[</span>redis,mongodb<span class="o">]</span>
</pre></div>
</div>
<p>The above will install the dependencies for Redis and MongoDB. You can list
as many extras as you want.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>You can't use the <code class="docutils literal notranslate"><span class="pre">celery-with-*</span></code> packages anymore, as these won't be
updated to use Celery 3.1.</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Extension</p></th>
<th class="head"><p>Requirement entry</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Redis</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[redis]</span></code></p></td>
<td><p>transport, result backend</p></td>
</tr>
<tr class="row-odd"><td><p>MongoDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[mongodb]</span></code></p></td>
<td><p>transport, result backend</p></td>
</tr>
<tr class="row-even"><td><p>CouchDB</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[couchdb]</span></code></p></td>
<td><p>transport</p></td>
</tr>
<tr class="row-odd"><td><p>Beanstalk</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[beanstalk]</span></code></p></td>
<td><p>transport</p></td>
</tr>
<tr class="row-even"><td><p>ZeroMQ</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[zeromq]</span></code></p></td>
<td><p>transport</p></td>
</tr>
<tr class="row-odd"><td><p>Zookeeper</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[zookeeper]</span></code></p></td>
<td><p>transport</p></td>
</tr>
<tr class="row-even"><td><p>SQLAlchemy</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[sqlalchemy]</span></code></p></td>
<td><p>transport, result backend</p></td>
</tr>
<tr class="row-odd"><td><p>librabbitmq</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">celery[librabbitmq]</span></code></p></td>
<td><p>transport (C amqp client)</p></td>
</tr>
</tbody>
</table>
</div>
<p>The complete list with examples is found in the <a class="reference internal" href="../getting-started/introduction.html#bundles"><span class="std std-ref">软件包</span></a> section.</p>
</section>
<section id="subtask-call-now-executes-the-task-directly">
<h3><code class="docutils literal notranslate"><span class="pre">subtask.__call__()</span></code> now executes the task directly<a class="headerlink" href="#subtask-call-now-executes-the-task-directly" title="Link to this heading">¶</a></h3>
<p>A misunderstanding led to <code class="docutils literal notranslate"><span class="pre">Signature.__call__</span></code> being an alias of
<code class="docutils literal notranslate"><span class="pre">.delay</span></code> but this doesn't conform to the calling API of <code class="docutils literal notranslate"><span class="pre">Task</span></code> which
calls the underlying task method.</p>
<p>This means that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)()</span>
</pre></div>
</div>
<p>now does the same as calling the task directly:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="in-other-news">
<h3>In Other News<a class="headerlink" href="#in-other-news" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Now depends on <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/changelog.html#version-3-0-0" title="（在 Kombu v5.5）"><span class="xref std std-ref">Kombu 3.0</span></a>.</p></li>
<li><p>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a> version 3.3.</p></li>
<li><p>Worker will now crash if running as the root user with pickle enabled.</p></li>
<li><p>Canvas: <code class="docutils literal notranslate"><span class="pre">group.apply_async</span></code> and <code class="docutils literal notranslate"><span class="pre">chain.apply_async</span></code> no longer starts
separate task.</p>
<blockquote>
<div><p>That the group and chord primitives supported the &quot;calling API&quot; like other
subtasks was a nice idea, but it was useless in practice and often
confused users. If you still want this behavior you can define a
task to do it for you.</p>
</div></blockquote>
</li>
<li><p>New method <code class="docutils literal notranslate"><span class="pre">Signature.freeze()</span></code> can be used to &quot;finalize&quot;
signatures/subtask.</p>
<blockquote>
<div><p>Regular signature:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">&lt;AsyncResult: ffacf44b-f8a1-44e9-80a3-703150151ef2&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<span class="go">&lt;AsyncResult: ffacf44b-f8a1-44e9-80a3-703150151ef2&gt;</span>
</pre></div>
</div>
<p>Group:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>
<span class="go">&lt;GroupResult: e1094b1d-08fc-4e14-838e-6d601b99da6d [</span>
<span class="go">    70c0fb3d-b60e-4b22-8df7-aa25b9abc86d,</span>
<span class="go">    58fcd260-2e32-4308-a2ea-f5be4a24f7f4]&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">()</span>
<span class="go">&lt;GroupResult: e1094b1d-08fc-4e14-838e-6d601b99da6d [70c0fb3d-b60e-4b22-8df7-aa25b9abc86d, 58fcd260-2e32-4308-a2ea-f5be4a24f7f4]&gt;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Chord exception behavior defined (<span class="xref issue">Issue #1172</span>).</p>
<blockquote>
<div><p>From this version the chord callback will change state to FAILURE
when a task part of a chord raises an exception.</p>
<p>See more at <a class="reference internal" href="../userguide/canvas.html#chord-errors"><span class="std std-ref">错误处理</span></a>.</p>
</div></blockquote>
</li>
<li><p>New ability to specify additional command line options
to the worker and beat programs.</p>
<blockquote>
<div><p>The <a class="reference internal" href="../reference/celery.html#celery.Celery.user_options" title="celery.Celery.user_options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app.user_options</span></code></a> attribute can be used
to add additional command-line arguments, and expects
<a class="reference external" href="https://docs.python.org/dev/library/optparse.html#module-optparse" title="（在 Python v3.15）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optparse</span></code></a>-style options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery.bin</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">user_options</span><span class="p">[</span><span class="s1">&#39;worker&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">Option</span><span class="p">(</span><span class="s1">&#39;--my-argument&#39;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="../userguide/extending.html#guide-extending"><span class="std std-ref">扩展 和 Bootsteps</span></a> guide for more information.</p>
</div></blockquote>
</li>
<li><p>All events now include a <code class="docutils literal notranslate"><span class="pre">pid</span></code> field, which is the process id of the
process that sent the event.</p></li>
<li><p>Event heartbeats are now calculated based on the time when the event
was received by the monitor, and not the time reported by the worker.</p>
<blockquote>
<div><p>This means that a worker with an out-of-sync clock will no longer
show as 'Offline' in monitors.</p>
<p>A warning is now emitted if the difference between the senders
time and the internal time is greater than 15 seconds, suggesting
that the clocks are out of sync.</p>
</div></blockquote>
</li>
<li><p>Monotonic clock support.</p>
<blockquote>
<div><p>A monotonic clock is now used for timeouts and scheduling.</p>
<p>The monotonic clock function is built-in starting from Python 3.4,
but we also have fallback implementations for Linux and macOS.</p>
</div></blockquote>
</li>
<li><p><strong class="program">celery worker</strong> now supports a new
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-D"><code class="xref std std-option docutils literal notranslate"><span class="pre">--detach</span></code></a> argument to start
the worker as a daemon in the background.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">app.events.Receiver</span></code> now sets a <code class="docutils literal notranslate"><span class="pre">local_received</span></code> field for incoming
events, which is set to the time of when the event was received.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">app.events.Dispatcher</span></code> now accepts a <code class="docutils literal notranslate"><span class="pre">groups</span></code> argument
which decides a white-list of event groups that'll be sent.</p>
<blockquote>
<div><p>The type of an event is a string separated by '-', where the part
before the first '-' is the group. Currently there are only
two groups: <code class="docutils literal notranslate"><span class="pre">worker</span></code> and <code class="docutils literal notranslate"><span class="pre">task</span></code>.</p>
<p>A dispatcher instantiated as follows:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">Dispatcher</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;worker&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>will only send worker related events and silently drop any attempts
to send events related to any other group.</p>
</div></blockquote>
</li>
<li><p>New <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_FAILOVER_STRATEGY</span></code> setting.</p>
<blockquote>
<div><p>This setting can be used to change the transport fail-over strategy,
can either be a callable returning an iterable or the name of a
Kombu built-in failover strategy. Default is &quot;round-robin&quot;.</p>
<p>Contributed by Matt Wise.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Result.revoke</span></code> will no longer wait for replies.</p>
<blockquote>
<div><p>You can add the <code class="docutils literal notranslate"><span class="pre">reply=True</span></code> argument if you really want to wait for
responses from the workers.</p>
</div></blockquote>
</li>
<li><p>Better support for link and link_error tasks for chords.</p>
<blockquote>
<div><p>Contributed by Steeve Morin.</p>
</div></blockquote>
</li>
<li><p>Worker: Now emits warning if the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_POOL</span></code> setting is set
to enable the eventlet/gevent pools.</p>
<blockquote>
<div><p>The <cite>-P</cite> option should always be used to select the eventlet/gevent pool
to ensure that the patches are applied as early as possible.</p>
<p>If you start the worker in a wrapper (like Django's <code class="file docutils literal notranslate"><span class="pre">manage.py</span></code>)
then you must apply the patches manually, for example by creating an alternative
wrapper that monkey patches at the start of the program before importing
any other modules.</p>
</div></blockquote>
</li>
<li><p>There's a now an 'inspect clock' command which will collect the current
logical clock value from workers.</p></li>
<li><p><cite>celery inspect stats</cite> now contains the process id of the worker's main
process.</p>
<blockquote>
<div><p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>New remote control command to dump a workers configuration.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>inspect<span class="w"> </span>conf
</pre></div>
</div>
<p>Configuration values will be converted to values supported by JSON
where possible.</p>
<p>Contributed by Mher Movsisyan.</p>
</div></blockquote>
</li>
<li><p>New settings <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_EVENT_QUEUE_TTL</span></code> and
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_EVENT_QUEUE_EXPIRES</span></code>.</p>
<blockquote>
<div><p>These control when a monitors event queue is deleted, and for how long
events published to that queue will be visible. Only supported on
RabbitMQ.</p>
</div></blockquote>
</li>
<li><p>New Couchbase result backend.</p>
<blockquote>
<div><p>This result backend enables you to store and retrieve task results
using <a class="reference external" href="https://www.couchbase.com">Couchbase</a>.</p>
<p>See <a class="reference internal" href="../userguide/configuration.html#conf-couchbase-result-backend"><span class="std std-ref">Couchbase 后端设置</span></a> for more information
about configuring this result backend.</p>
<p>Contributed by Alain Masiero.</p>
</div></blockquote>
</li>
<li><p>CentOS init-script now supports starting multiple worker instances.</p>
<blockquote>
<div><p>See the script header for details.</p>
<p>Contributed by Jonathan Jordan.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">AsyncResult.iter_native</span></code> now sets default interval parameter to 0.5</p>
<blockquote>
<div><p>Fix contributed by Idan Kamara</p>
</div></blockquote>
</li>
<li><p>New setting <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_LOGIN_METHOD</span></code>.</p>
<blockquote>
<div><p>This setting can be used to specify an alternate login method
for the AMQP transports.</p>
<p>Contributed by Adrien Guinet</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">dump_conf</span></code> remote control command will now give the string
representation for types that aren't JSON compatible.</p></li>
<li><p>Function <cite>celery.security.setup_security</cite> is now <a class="reference internal" href="../reference/celery.html#celery.Celery.setup_security" title="celery.Celery.setup_security"><code class="xref py py-func docutils literal notranslate"><span class="pre">app.setup_security()</span></code></a>.</p></li>
<li><p>Task retry now propagates the message expiry value (<span class="xref issue">Issue #980</span>).</p>
<blockquote>
<div><p>The value is forwarded at is, so the expiry time won't change.
To update the expiry time you'd've to pass a new expires
argument to <code class="docutils literal notranslate"><span class="pre">retry()</span></code>.</p>
</div></blockquote>
</li>
<li><p>Worker now crashes if a channel error occurs.</p>
<blockquote>
<div><p>Channel errors are transport specific and is the list of exceptions
returned by <code class="docutils literal notranslate"><span class="pre">Connection.channel_errors</span></code>.
For RabbitMQ this means that Celery will crash if the equivalence
checks for one of the queues in <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_QUEUES</span></code> mismatches, which
makes sense since this is a scenario where manual intervention is
required.</p>
</div></blockquote>
</li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">AsyncResult.get()</span></code> on a chain now propagates errors for previous
tasks (<span class="xref issue">Issue #1014</span>).</p></li>
<li><p>The parent attribute of <code class="docutils literal notranslate"><span class="pre">AsyncResult</span></code> is now reconstructed when using JSON
serialization (<span class="xref issue">Issue #1014</span>).</p></li>
<li><p>Worker disconnection logs are now logged with severity warning instead of
error.</p>
<blockquote>
<div><p>Contributed by Chris Adams.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">events.State</span></code> no longer crashes when it receives unknown event types.</p></li>
<li><p>SQLAlchemy Result Backend: New <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_RESULT_DB_TABLENAMES</span></code>
setting can be used to change the name of the database tables used.</p>
<blockquote>
<div><p>Contributed by Ryan Petrello.</p>
</div></blockquote>
</li>
<li><dl>
<dt>SQLAlchemy Result Backend: Now calls <code class="docutils literal notranslate"><span class="pre">enginge.dispose</span></code> after fork</dt><dd><p>(<span class="xref issue">Issue #1564</span>).</p>
<blockquote>
<div><p>If you create your own SQLAlchemy engines then you must also
make sure that these are closed after fork in the worker:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">register_after_fork</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="o">*</span><span class="n">engine_args</span><span class="p">)</span>
<span class="n">register_after_fork</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><p>A stress test suite for the Celery worker has been written.</p>
<blockquote>
<div><p>This is located in the <code class="docutils literal notranslate"><span class="pre">funtests/stress</span></code> directory in the git
repository. There's a README file there to get you started.</p>
</div></blockquote>
</li>
<li><p>The logger named <code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">celery.pool</span></code>.</p></li>
<li><p>New command line utility <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">graph</span></code>.</p>
<blockquote>
<div><p>This utility creates graphs in GraphViz dot format.</p>
<p>You can create graphs from the currently installed bootsteps:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Create<span class="w"> </span>graph<span class="w"> </span>of<span class="w"> </span>currently<span class="w"> </span>installed<span class="w"> </span>bootsteps<span class="w"> </span><span class="k">in</span><span class="w"> </span>both<span class="w"> </span>the<span class="w"> </span>worker
<span class="gp"># </span>and<span class="w"> </span>consumer<span class="w"> </span>name-spaces.
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>bootsteps<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-T<span class="w"> </span>png<span class="w"> </span>-o<span class="w"> </span>steps.png

<span class="gp"># </span>Graph<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>consumer<span class="w"> </span>name-space<span class="w"> </span>only.
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>bootsteps<span class="w"> </span>consumer<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-T<span class="w"> </span>png<span class="w"> </span>-o<span class="w"> </span>consumer_only.png

<span class="gp"># </span>Graph<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>worker<span class="w"> </span>name-space<span class="w"> </span>only.
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>bootsteps<span class="w"> </span>worker<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-T<span class="w"> </span>png<span class="w"> </span>-o<span class="w"> </span>worker_only.png
</pre></div>
</div>
<p>Or graphs of workers in a cluster:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Create<span class="w"> </span>graph<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>cluster
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>workers<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-T<span class="w"> </span>png<span class="w"> </span>-o<span class="w"> </span>workers.png

<span class="gp"># </span>Create<span class="w"> </span>graph<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>specified<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>workers
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>workers<span class="w"> </span>nodes:w1,w2,w3<span class="w"> </span><span class="p">|</span><span class="w"> </span>dot<span class="w"> </span>-T<span class="w"> </span>png<span class="w"> </span>workers.png

<span class="gp"># </span>also<span class="w"> </span>specify<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>threads<span class="w"> </span><span class="k">in</span><span class="w"> </span>each<span class="w"> </span>worker
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>workers<span class="w"> </span>nodes:w1,w2,w3<span class="w"> </span>threads:2,4,6

<span class="gp"># </span>…also<span class="w"> </span>specify<span class="w"> </span>the<span class="w"> </span>broker<span class="w"> </span>and<span class="w"> </span>backend<span class="w"> </span>URLs<span class="w"> </span>shown<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>graph
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>workers<span class="w"> </span>broker:amqp://<span class="w"> </span>backend:redis://

<span class="gp"># </span>…also<span class="w"> </span>specify<span class="w"> </span>the<span class="w"> </span>max<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>workers/threads<span class="w"> </span>shown<span class="w"> </span><span class="o">(</span>wmax/tmax<span class="o">)</span>,
<span class="gp"># </span>enumerating<span class="w"> </span>anything<span class="w"> </span>that<span class="w"> </span>exceeds<span class="w"> </span>that<span class="w"> </span>number.
<span class="gp">$ </span>celery<span class="w"> </span>graph<span class="w"> </span>workers<span class="w"> </span>wmax:10<span class="w"> </span>tmax:3
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Changed the way that app instances are pickled.</p>
<blockquote>
<div><p>Apps can now define a <code class="docutils literal notranslate"><span class="pre">__reduce_keys__</span></code> method that's used instead
of the old <code class="docutils literal notranslate"><span class="pre">AppPickler</span></code> attribute. For example, if your app defines a custom
'foo' attribute that needs to be preserved when pickling you can define
a <code class="docutils literal notranslate"><span class="pre">__reduce_keys__</span></code> as such:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">celery</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Celery</span><span class="p">(</span><span class="n">celery</span><span class="o">.</span><span class="n">Celery</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Celery</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__reduce_keys__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Celery</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__reduce_keys__</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="n">foo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>This is a much more convenient way to add support for pickling custom
attributes. The old <code class="docutils literal notranslate"><span class="pre">AppPickler</span></code> is still supported but its use is
discouraged and we would like to remove it in a future version.</p>
</div></blockquote>
</li>
<li><p>Ability to trace imports for debugging purposes.</p>
<blockquote>
<div><p>The <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">C_IMPDEBUG</span></code> can be set to trace imports as they
occur:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">C_IMDEBUG</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>celery<span class="w"> </span>worker<span class="w"> </span>-l<span class="w"> </span>info
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">C_IMPDEBUG</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>celery<span class="w"> </span>shell
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Message headers now available as part of the task request.</p>
<blockquote>
<div><p>Example adding and retrieving a header value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sender&#39;</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sender&#39;</span><span class="p">:</span> <span class="s1">&#39;George Costanza&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>New <a class="reference internal" href="../userguide/signals.html#std-signal-before_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">before_task_publish</span></code></a> signal dispatched before a task message
is sent and can be used to modify the final message fields (<span class="xref issue">Issue #1281</span>).</p></li>
<li><p>New <a class="reference internal" href="../userguide/signals.html#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> signal replaces the old <a class="reference internal" href="../userguide/signals.html#std-signal-task_sent"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_sent</span></code></a>
signal.</p>
<blockquote>
<div><p>The <a class="reference internal" href="../userguide/signals.html#std-signal-task_sent"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_sent</span></code></a> signal is now deprecated and shouldn't be used.</p>
</div></blockquote>
</li>
<li><p>New <a class="reference internal" href="../userguide/signals.html#std-signal-worker_process_shutdown"><code class="xref std std-signal docutils literal notranslate"><span class="pre">worker_process_shutdown</span></code></a> signal is dispatched in the
prefork pool child processes as they exit.</p>
<blockquote>
<div><p>Contributed by Daniel M Taub.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery.platforms.PIDFile</span></code> renamed to <a class="reference internal" href="../internals/reference/celery.platforms.html#celery.platforms.Pidfile" title="celery.platforms.Pidfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.platforms.Pidfile</span></code></a>.</p></li>
<li><p>MongoDB Backend: Can now be configured using a URL:</p></li>
<li><p>MongoDB Backend: No longer using deprecated <code class="docutils literal notranslate"><span class="pre">pymongo.Connection</span></code>.</p></li>
<li><p>MongoDB Backend: Now disables <code class="docutils literal notranslate"><span class="pre">auto_start_request</span></code>.</p></li>
<li><p>MongoDB Backend: Now enables <code class="docutils literal notranslate"><span class="pre">use_greenlets</span></code> when eventlet/gevent is used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subtask()</span></code> / <code class="docutils literal notranslate"><span class="pre">maybe_subtask()</span></code> renamed to
<code class="docutils literal notranslate"><span class="pre">signature()</span></code>/<code class="docutils literal notranslate"><span class="pre">maybe_signature()</span></code>.</p>
<blockquote>
<div><p>Aliases still available for backwards compatibility.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">correlation_id</span></code> message property is now automatically set to the
id of the task.</p></li>
<li><p>The task message <code class="docutils literal notranslate"><span class="pre">eta</span></code> and <code class="docutils literal notranslate"><span class="pre">expires</span></code> fields now includes timezone
information.</p></li>
<li><p>All result backends <code class="docutils literal notranslate"><span class="pre">store_result</span></code>/<code class="docutils literal notranslate"><span class="pre">mark_as_*</span></code> methods must now accept
a <code class="docutils literal notranslate"><span class="pre">request</span></code> keyword argument.</p></li>
<li><p>Events now emit warning if the broken <code class="docutils literal notranslate"><span class="pre">yajl</span></code> library is used.</p></li>
<li><p>The <a class="reference internal" href="../userguide/signals.html#std-signal-celeryd_init"><code class="xref std std-signal docutils literal notranslate"><span class="pre">celeryd_init</span></code></a> signal now takes an extra keyword argument:
<code class="docutils literal notranslate"><span class="pre">option</span></code>.</p>
<blockquote>
<div><p>This is the mapping of parsed command line arguments, and can be used to
prepare new preload arguments (<code class="docutils literal notranslate"><span class="pre">app.user_options['preload']</span></code>).</p>
</div></blockquote>
</li>
<li><p>New callback: <a class="reference internal" href="../reference/celery.html#celery.Celery.on_configure" title="celery.Celery.on_configure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.on_configure()</span></code></a>.</p>
<blockquote>
<div><p>This callback is called when an app is about to be configured (a
configuration key is required).</p>
</div></blockquote>
</li>
<li><p>Worker: No longer forks on <code class="xref std std-sig docutils literal notranslate"><span class="pre">HUP</span></code>.</p>
<blockquote>
<div><p>This means that the worker will reuse the same pid for better
support with external process supervisors.</p>
<p>Contributed by Jameel Al-Aziz.</p>
</div></blockquote>
</li>
<li><p>Worker: The log message <code class="docutils literal notranslate"><span class="pre">Got</span> <span class="pre">task</span> <span class="pre">from</span> <span class="pre">broker</span> <span class="pre">…</span></code> was changed to
<code class="docutils literal notranslate"><span class="pre">Received</span> <span class="pre">task</span> <span class="pre">…</span></code>.</p></li>
<li><p>Worker: The log message <code class="docutils literal notranslate"><span class="pre">Skipping</span> <span class="pre">revoked</span> <span class="pre">task</span> <span class="pre">…</span></code> was changed
to <code class="docutils literal notranslate"><span class="pre">Discarding</span> <span class="pre">revoked</span> <span class="pre">task</span> <span class="pre">…</span></code>.</p></li>
<li><p>Optimization: Improved performance of <code class="docutils literal notranslate"><span class="pre">ResultSet.join_native()</span></code>.</p>
<blockquote>
<div><p>Contributed by Stas Rudakou.</p>
</div></blockquote>
</li>
<li><p>The <a class="reference internal" href="../userguide/signals.html#std-signal-task_revoked"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_revoked</span></code></a> signal now accepts new <code class="docutils literal notranslate"><span class="pre">request</span></code> argument
(<span class="xref issue">Issue #1555</span>).</p>
<blockquote>
<div><p>The revoked signal is dispatched after the task request is removed from
the stack, so it must instead use the
<a class="reference internal" href="../reference/celery.worker.request.html#celery.worker.request.Request" title="celery.worker.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> object to get information
about the task.</p>
</div></blockquote>
</li>
<li><p>Worker: New <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span></code></a> command line argument to
exclude queues (<span class="xref issue">Issue #1399</span>).</p>
<blockquote>
<div><p>The <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-X"><code class="xref std std-option docutils literal notranslate"><span class="pre">-X</span></code></a> argument is the inverse of the
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">-Q</span></code></a> argument and accepts a list of queues
to exclude (not consume from):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Consume<span class="w"> </span>from<span class="w"> </span>all<span class="w"> </span>queues<span class="w"> </span><span class="k">in</span><span class="w"> </span>CELERY_QUEUES,<span class="w"> </span>but<span class="w"> </span>not<span class="w"> </span>the<span class="w"> </span><span class="s1">&#39;foo&#39;</span><span class="w"> </span>queue.
<span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>info<span class="w"> </span>-X<span class="w"> </span>foo
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Adds <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">C_FAKEFORK</span></code> environment variable for simple
init-script/<strong class="program">celery multi</strong> debugging.</p>
<blockquote>
<div><p>This means that you can now do:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">C_FAKEFORK</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span><span class="m">10</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">C_FAKEFORK</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>/etc/init.d/celeryd<span class="w"> </span>start
</pre></div>
</div>
<p>to avoid the daemonization step to see errors that aren't visible
due to missing stdout/stderr.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">dryrun</span></code> command has been added to the generic init-script that
enables this option.</p>
</div></blockquote>
</li>
<li><p>New public API to push and pop from the current task stack:</p>
<blockquote>
<div><p><code class="xref py py-func docutils literal notranslate"><span class="pre">celery.app.push_current_task()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">celery.app.pop_current_task`()</span></code>.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">RetryTaskError</span></code> has been renamed to <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.Retry" title="celery.exceptions.Retry"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Retry</span></code></a>.</p>
<blockquote>
<div><p>The old name is still available for backwards compatibility.</p>
</div></blockquote>
</li>
<li><p>New semi-predicate exception <a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.Reject" title="celery.exceptions.Reject"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Reject</span></code></a>.</p>
<blockquote>
<div><p>This exception can be raised to <code class="docutils literal notranslate"><span class="pre">reject</span></code>/<code class="docutils literal notranslate"><span class="pre">requeue</span></code> the task message,
see <a class="reference internal" href="../userguide/tasks.html#task-semipred-reject"><span class="std std-ref">拒绝</span></a> for examples.</p>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="../userguide/tasks.html#task-semipredicates"><span class="std std-ref">Semipredicates</span></a> documented: (Retry/Ignore/Reject).</p></li>
</ul>
</section>
</section>
<section id="scheduled-removals">
<span id="v310-removals"></span><h2>Scheduled Removals<a class="headerlink" href="#scheduled-removals" title="Link to this heading">¶</a></h2>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">BROKER_INSIST</span></code> setting and the <code class="docutils literal notranslate"><span class="pre">insist</span></code> argument
to <code class="docutils literal notranslate"><span class="pre">~&#64;connection</span></code> is no longer supported.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_TASK_RESULT_CONNECTION_MAX</span></code> setting is no longer
supported.</p>
<blockquote>
<div><p>Use <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_POOL_LIMIT</span></code> instead.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">CELERY_TASK_ERROR_WHITELIST</span></code> setting is no longer supported.</p>
<blockquote>
<div><p>You should set the <code class="xref py py-class docutils literal notranslate"><span class="pre">ErrorMail</span></code> attribute
of the task class instead. You can also do this using
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ANNOTATIONS</span></code>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery.utils.mail</span><span class="w"> </span><span class="kn">import</span> <span class="n">ErrorMail</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyErrorMail</span><span class="p">(</span><span class="n">ErrorMail</span><span class="p">):</span>
    <span class="n">whitelist</span> <span class="o">=</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">exc</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">CELERY_ANNOTATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;*&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ErrorMail&#39;</span><span class="p">:</span> <span class="n">MyErrorMails</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</li>
<li><p>Functions that creates a broker connections no longer
supports the <code class="docutils literal notranslate"><span class="pre">connect_timeout</span></code> argument.</p>
<blockquote>
<div><p>This can now only be set using the <code class="xref std std-setting docutils literal notranslate"><span class="pre">BROKER_CONNECTION_TIMEOUT</span></code>
setting. This is because functions no longer create connections
directly, but instead get them from the connection pool.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">CELERY_AMQP_TASK_RESULT_EXPIRES</span></code> setting is no longer supported.</p>
<blockquote>
<div><p>Use <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code> instead.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="deprecation-time-line-changes">
<span id="v310-deprecations"></span><h2>Deprecation Time-line Changes<a class="headerlink" href="#deprecation-time-line-changes" title="Link to this heading">¶</a></h2>
<p>See the <a class="reference internal" href="../internals/deprecation.html#deprecation-timeline"><span class="std std-ref">Celery 弃用时间表</span></a>.</p>
</section>
<section id="fixes">
<span id="v310-fixes"></span><h2>Fixes<a class="headerlink" href="#fixes" title="Link to this heading">¶</a></h2>
<ul>
<li><p>AMQP Backend: join didn't convert exceptions when using the json
serializer.</p></li>
<li><p>Non-abstract task classes are now shared between apps (<span class="xref issue">Issue #1150</span>).</p>
<blockquote>
<div><p>Note that non-abstract task classes shouldn't be used in the
new API. You should only create custom task classes when you
use them as a base class in the <code class="docutils literal notranslate"><span class="pre">&#64;task</span></code> decorator.</p>
<p>This fix ensure backwards compatibility with older Celery versions
so that non-abstract task classes works even if a module is imported
multiple times so that the app is also instantiated multiple times.</p>
</div></blockquote>
</li>
<li><p>Worker: Workaround for Unicode errors in logs (<span class="xref issue">Issue #427</span>).</p></li>
<li><p>Task methods: <code class="docutils literal notranslate"><span class="pre">.apply_async</span></code> now works properly if args list is None
(<span class="xref issue">Issue #1459</span>).</p></li>
<li><p>Eventlet/gevent/solo/threads pools now properly handles <a class="reference external" href="https://docs.python.org/dev/library/exceptions.html#BaseException" title="（在 Python v3.15）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseException</span></code></a>
errors raised by tasks.</p></li>
<li><p><code class="xref std std-control docutils literal notranslate"><span class="pre">autoscale</span></code> and <code class="xref std std-control docutils literal notranslate"><span class="pre">pool_grow</span></code>/<code class="xref std std-control docutils literal notranslate"><span class="pre">pool_shrink</span></code> remote
control commands will now also automatically increase and decrease the
consumer prefetch count.</p>
<blockquote>
<div><p>Fix contributed by Daniel M. Taub.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">control</span> <span class="pre">pool_</span></code> commands didn't coerce string arguments to int.</p></li>
<li><p>Redis/Cache chords: Callback result is now set to failure if the group
disappeared from the database (<span class="xref issue">Issue #1094</span>).</p></li>
<li><p>Worker: Now makes sure that the shutdown process isn't initiated more
than once.</p></li>
<li><p>Programs: <strong class="program">celery multi</strong> now properly handles both <code class="docutils literal notranslate"><span class="pre">-f</span></code> and
<a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-f"><code class="xref std std-option docutils literal notranslate"><span class="pre">--logfile</span></code></a> options (<span class="xref issue">Issue #1541</span>).</p></li>
</ul>
</section>
<section id="internal-changes">
<span id="v310-internal"></span><h2>Internal changes<a class="headerlink" href="#internal-changes" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Module <code class="docutils literal notranslate"><span class="pre">celery.task.trace</span></code> has been renamed to <a class="reference internal" href="../internals/reference/celery.app.trace.html#module-celery.app.trace" title="celery.app.trace"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a>.</p></li>
<li><p>Module <code class="docutils literal notranslate"><span class="pre">celery.concurrency.processes</span></code> has been renamed to
<a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html#module-celery.concurrency.prefork" title="celery.concurrency.prefork"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a>.</p></li>
<li><p>Classes that no longer fall back to using the default app:</p>
<blockquote>
<div><ul class="simple">
<li><p>Result backends (<a class="reference internal" href="../internals/reference/celery.backends.base.html#celery.backends.base.BaseBackend" title="celery.backends.base.BaseBackend"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.backends.base.BaseBackend</span></code></a>)</p></li>
<li><p><a class="reference internal" href="../reference/celery.worker.html#celery.worker.WorkController" title="celery.worker.WorkController"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.WorkController</span></code></a></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.Consumer</span></code></p></li>
<li><p><a class="reference internal" href="../reference/celery.worker.request.html#celery.worker.request.Request" title="celery.worker.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.request.Request</span></code></a></p></li>
</ul>
<p>This means that you have to pass a specific app when instantiating
these classes.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">EventDispatcher.copy_buffer</span></code> renamed to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">app.events.Dispatcher.extend_buffer()</span></code>.</p></li>
<li><p>Removed unused and never documented global instance
<code class="docutils literal notranslate"><span class="pre">celery.events.state.state</span></code>.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">app.events.Receiver</span></code> is now a <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.mixins.html#kombu.mixins.ConsumerMixin" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">kombu.mixins.ConsumerMixin</span></code></a>
subclass.</p></li>
<li><p><a class="reference internal" href="../reference/celery.apps.worker.html#celery.apps.worker.Worker" title="celery.apps.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.apps.worker.Worker</span></code></a> has been refactored as a subclass of
<a class="reference internal" href="../reference/celery.worker.html#celery.worker.WorkController" title="celery.worker.WorkController"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.WorkController</span></code></a>.</p>
<blockquote>
<div><p>This removes a lot of duplicate functionality.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Celery.with_default_connection</span></code> method has been removed in favor
of <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">app.connection_or_acquire</span></code> (<a class="reference internal" href="../reference/celery.html#celery.Celery.connection_or_acquire" title="celery.Celery.connection_or_acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.connection_or_acquire()</span></code></a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">celery.results.BaseDictBackend</span></code> class has been removed and is replaced by
<code class="xref py py-class docutils literal notranslate"><span class="pre">celery.results.BaseBackend</span></code>.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog-3.1.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Change history</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="changelog-4.0.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Change history</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2009-2023, Ask Solem &amp; contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">What's new in Celery 3.1 (Cipater)</a><ul>
<li><a class="reference internal" href="#preface">Preface</a></li>
<li><a class="reference internal" href="#important-notes">Important Notes</a><ul>
<li><a class="reference internal" href="#dropped-support-for-python-2-5">Dropped support for Python 2.5</a></li>
<li><a class="reference internal" href="#last-version-to-enable-pickle-by-default">Last version to enable Pickle by default</a></li>
<li><a class="reference internal" href="#old-command-line-programs-removed-and-deprecated">Old command-line programs removed and deprecated</a></li>
</ul>
</li>
<li><a class="reference internal" href="#news">News</a><ul>
<li><a class="reference internal" href="#prefork-pool-improvements">Prefork Pool Improvements</a><ul>
<li><a class="reference internal" href="#caveats">Caveats</a></li>
</ul>
</li>
<li><a class="reference internal" href="#django-supported-out-of-the-box">Django supported out of the box</a></li>
<li><a class="reference internal" href="#events-are-now-ordered-using-logical-time">Events are now ordered using logical time</a></li>
<li><a class="reference internal" href="#new-worker-node-name-format-name-host">New worker node name format (<code class="docutils literal notranslate"><span class="pre">name&#64;host</span></code>)</a></li>
<li><a class="reference internal" href="#bound-tasks">Bound tasks</a></li>
<li><a class="reference internal" href="#mingle-worker-synchronization">Mingle: Worker synchronization</a></li>
<li><a class="reference internal" href="#gossip-worker-worker-communication">Gossip: Worker &lt;-&gt; Worker communication</a></li>
<li><a class="reference internal" href="#bootsteps-extending-the-worker">Bootsteps: Extending the worker</a></li>
<li><a class="reference internal" href="#new-rpc-result-backend">New RPC result backend</a></li>
<li><a class="reference internal" href="#time-limits-can-now-be-set-by-the-client">Time limits can now be set by the client</a></li>
<li><a class="reference internal" href="#redis-broadcast-messages-and-virtual-hosts">Redis: Broadcast messages and virtual hosts</a></li>
<li><a class="reference internal" href="#https-pypi-org-project-pytz-replaces-https-pypi-org-project-python-dateutil-dependency">https://pypi.org/project/pytz/ replaces https://pypi.org/project/python-dateutil/ dependency</a></li>
<li><a class="reference internal" href="#support-for-https-pypi-org-project-setuptools-extra-requirements">Support for https://pypi.org/project/setuptools/ extra requirements</a></li>
<li><a class="reference internal" href="#subtask-call-now-executes-the-task-directly"><code class="docutils literal notranslate"><span class="pre">subtask.__call__()</span></code> now executes the task directly</a></li>
<li><a class="reference internal" href="#in-other-news">In Other News</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scheduled-removals">Scheduled Removals</a></li>
<li><a class="reference internal" href="#deprecation-time-line-changes">Deprecation Time-line Changes</a></li>
<li><a class="reference internal" href="#fixes">Fixes</a></li>
<li><a class="reference internal" href="#internal-changes">Internal changes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8156d91f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>