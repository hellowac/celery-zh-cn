<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="Change history for Celery 3.0" href="changelog-3.0.html" /><link rel="prev" title="Change history" href="changelog-3.1.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>What&#39;s new in Celery 3.0 (Chiastic Slide) - Celery 5.5.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css?v=112ca36d" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Celery 5.5.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/celery_512_1.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Celery 5.5.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">版权</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">快速开始</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 快速开始</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/introduction.html">Celery 简介</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/backends-and-brokers/index.html">Backends 和 Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Backends 和 Brokers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/rabbitmq.html">使用 RabbitMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/redis.html">使用 Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/sqs.html">使用 Amazon SQS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/kafka.html">使用 Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/gcpubsub.html">使用 Google Pub/Sub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/first-steps-with-celery.html">使用 Celery 的第一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/next-steps.html">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/resources.html">资源</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../userguide/index.html">用户指南</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 用户指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../userguide/application.html">应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/tasks.html">任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/calling.html">调用任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/canvas.html">Canvas：设计工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/workers.html">Workers 指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/daemonizing.html">守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/periodic-tasks.html">周期性任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/routing.html">路由任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/monitoring.html">监控和管理指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/optimizing.html">优化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/debugging.html">调试</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../userguide/concurrency/index.html">并发</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 并发</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/eventlet.html">Eventlet 并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/gevent.html">gevent 并发</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/signals.html">信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/testing.html">使用 Celery 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/extending.html">扩展 和 Bootsteps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/configuration.html">配置和默认值</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/sphinx.html">使用 Sphinx 文档化任务</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../django/index.html">Django</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Django</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../django/first-steps-with-django.html">使用 Django 的第一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">社区资源</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/task-cookbook.html">Task Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">更改历史</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API 参考</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API 参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">命令行接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code> --- Distributed processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html">Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.task.html"><code class="docutils literal notranslate"><span class="pre">celery.app.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html">AMQP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html#queues">Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.defaults.html"><code class="docutils literal notranslate"><span class="pre">celery.app.defaults</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.control.html"><code class="docutils literal notranslate"><span class="pre">celery.app.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.registry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.registry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.app.backends</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.builtins.html"><code class="docutils literal notranslate"><span class="pre">celery.app.builtins</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.events.html"><code class="docutils literal notranslate"><span class="pre">celery.app.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.log.html"><code class="docutils literal notranslate"><span class="pre">celery.app.log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.app.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.autoretry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.autoretry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bootsteps.html"><code class="docutils literal notranslate"><span class="pre">celery.bootsteps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.result.html"><code class="docutils literal notranslate"><span class="pre">celery.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.schedules.html"><code class="docutils literal notranslate"><span class="pre">celery.schedules</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.signals.html"><code class="docutils literal notranslate"><span class="pre">celery.signals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.security.html"><code class="docutils literal notranslate"><span class="pre">celery.security</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.utils.debug.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.debug</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.exceptions.html"><code class="docutils literal notranslate"><span class="pre">celery.exceptions</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.app.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.default.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.base.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html">States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#sets">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.FAILURE"><code class="docutils literal notranslate"><span class="pre">FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.PENDING"><code class="docutils literal notranslate"><span class="pre">PENDING</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RECEIVED"><code class="docutils literal notranslate"><span class="pre">RECEIVED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RETRY"><code class="docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.REVOKED"><code class="docutils literal notranslate"><span class="pre">REVOKED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.STARTED"><code class="docutils literal notranslate"><span class="pre">STARTED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.SUCCESS"><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.precedence"><code class="docutils literal notranslate"><span class="pre">precedence()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.abortable.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.django.task.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.django.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.pytest.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.pytest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.sphinx.html">celery.contrib.sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.app.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.manager.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.manager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.mocks.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.mocks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.rdb.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.html"><code class="docutils literal notranslate"><span class="pre">celery.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.receiver.html"><code class="docutils literal notranslate"><span class="pre">celery.events.receiver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.dispatcher.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.event.html"><code class="docutils literal notranslate"><span class="pre">celery.events.event</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.state.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.request.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.request</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.state.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.strategy.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.agent.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.connection.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.events.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.gossip.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.gossip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.heart.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.heart</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.mingle.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.mingle</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.tasks.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.tasks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.base.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.celery.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.celery</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.events.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.logtool.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.logtool</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.amqp.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.amqp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.graph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.call.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.call</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.control.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.list.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.list</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.purge.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.purge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.result.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.shell.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.shell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.upgrade.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.upgrade</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/index.html">内部</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/guide.html">代码贡献指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/deprecation.html">Celery 弃用时间表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/worker.html">内部的 worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/protocol.html">消息协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/app-overview.html">“大实例”重构</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../internals/reference/index.html">内部模块参考</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 内部模块参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.components.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.loops.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.loops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.heartbeat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.pidbox.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.pidbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.autoscale.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.autoscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.solo.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.solo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.eventlet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.gevent.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.gevent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.thread.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.base.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.backends</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.base.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.asynchronous.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.asynchronous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.azureblockblob.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.azureblockblob</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.rpc.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cache.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.consul.html">celery.backends.consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchdb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.mongodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.mongodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.elasticsearch.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.elasticsearch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.redis.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cassandra.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cassandra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchbase.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchbase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.arangodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.arangodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.dynamodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.dynamodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.filesystem.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.filesystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cosmosdbsql.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cosmosdbsql</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.s3.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.s3</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.gcs.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.gcs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.trace.html"><code class="docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.annotations.html"><code class="docutils literal notranslate"><span class="pre">celery.app.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.routes.html"><code class="docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.certificate.html"><code class="docutils literal notranslate"><span class="pre">celery.security.certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.key.html"><code class="docutils literal notranslate"><span class="pre">celery.security.key</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.security.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.security.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.snapshot.html"><code class="docutils literal notranslate"><span class="pre">celery.events.snapshot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.cursesmon.html"><code class="docutils literal notranslate"><span class="pre">celery.events.cursesmon</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.dumper.html"><code class="docutils literal notranslate"><span class="pre">celery.events.dumper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.models.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.session.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.session</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.abstract.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.abstract</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.collections.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.collections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.nodenames.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.nodenames</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.deprecated.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.deprecated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.functional.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.graph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.objects.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.term.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.term</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.time.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.iso8601.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.iso8601</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.saferepr.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.saferepr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.sysinfo.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.sysinfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.threads.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.timer2.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.timer2</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.imports.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.log.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.text.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch.signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.platforms.html"><code class="docutils literal notranslate"><span class="pre">celery.platforms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery._state.html"><code class="docutils literal notranslate"><span class="pre">celery._state</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">历史</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 历史</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.5.html">What's new in Celery 5.5 (Immunity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.5.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.4.html">What's new in Celery 5.4 (Opalescent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.3.html">What's new in Celery 5.3 (Emerald Rush)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.1.html">What's new in Celery 5.1 (Sun Harmonics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-5.0.html">What's new in Celery 5.0 (singularity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-5.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.4.html">What's new in Celery 4.4 (Cliffs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.3.html">What's new in Celery 4.3 (rhubarb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.2.html">What's new in Celery 4.2 (windowlicker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.2.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.1.html">What's new in Celery 4.1 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-4.0.html">What's new in Celery 4.0 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-4.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-3.1.html">What's new in Celery 3.1 (Cipater)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-3.1.html">Change history</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">What's new in Celery 3.0 (Chiastic Slide)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-3.0.html">Change history for Celery 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="whatsnew-2.5.html">What's new in Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.5.html">Change history for Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.4.html">Change history for Celery 2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.3.html">Change history for Celery 2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.2.html">Change history for Celery 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.1.html">Change history for Celery 2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-2.0.html">Change history for Celery 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog-1.0.html">Change history for Celery 1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

</div>
<!-- <iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe> -->
<div id="donate">
  <h5>捐赠</h5>
  <p>请捐赠以支持这个社区项目</p>
  <a href="https://opencollective.com/celery/donate" target="_blank">
    <!-- <img src="https://opencollective.com/celery/donate/button@2x.png?color=blue" /> -->
    <img src="https://opencollective.com/celery/donate/button.png?color=blue" />
  </a>
</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/history/whatsnew-3.0.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="what-s-new-in-celery-3-0-chiastic-slide">
<span id="whatsnew-3-0"></span><h1>What's new in Celery 3.0 (Chiastic Slide)<a class="headerlink" href="#what-s-new-in-celery-3-0-chiastic-slide" title="Link to this heading">¶</a></h1>
<p>Celery is a simple, flexible, and reliable distributed system to
process vast amounts of messages, while providing operations with
the tools required to maintain such a system.</p>
<p>It's a task queue with focus on real-time processing, while also
supporting task scheduling.</p>
<p>Celery has a large and diverse community of users and contributors,
you should come join us <span class="xref std std-ref">on IRC</span>
or <span class="xref std std-ref">our mailing-list</span>.</p>
<p>To read more about Celery you should go read the <a class="reference internal" href="../getting-started/introduction.html#intro"><span class="std std-ref">introduction</span></a>.</p>
<p>While this version is backward compatible with previous versions
it's important that you read the following section.</p>
<p>If you use Celery in combination with Django you must also
read the <a class="reference external" href="https://github.com/celery/django-celery/tree/master/Changelog">django-celery changelog</a> and upgrade
to <a class="extlink-pypi reference external" href="https://pypi.org/project/django-celery/">django-celery 3.0</a>.</p>
<p>This version is officially supported on CPython 2.5, 2.6, 2.7, 3.2 and 3.3,
as well as PyPy and Jython.</p>
<section id="highlights">
<h2>Highlights<a class="headerlink" href="#highlights" title="Link to this heading">¶</a></h2>
<aside class="topic">
<p class="topic-title">Overview</p>
<ul>
<li><p>A new and improved API, that's both simpler and more powerful.</p>
<blockquote>
<div><p>Everyone must read the new <a class="reference internal" href="../getting-started/first-steps-with-celery.html#first-steps"><span class="std std-ref">使用 Celery 的第一步</span></a> tutorial,
and the new <a class="reference internal" href="../getting-started/next-steps.html#next-steps"><span class="std std-ref">下一步</span></a> tutorial. Oh, and
why not reread the user guide while you're at it :)</p>
<p>There are no current plans to deprecate the old API,
so you don't have to be in a hurry to port your applications.</p>
</div></blockquote>
</li>
<li><p>The worker is now thread-less, giving great performance improvements.</p></li>
<li><p>The new &quot;Canvas&quot; makes it easy to define complex work-flows.</p>
<blockquote>
<div><p>Ever wanted to chain tasks together? This is possible, but
not just that, now you can even chain together groups and chords,
or even combine multiple chains.</p>
<p>Read more in the <a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas</span></a> user guide.</p>
</div></blockquote>
</li>
<li><p>All of Celery's command-line programs are now available from a single
<strong class="program">celery</strong> umbrella command.</p></li>
<li><p>This is the last version to support Python 2.5.</p>
<blockquote>
<div><p>Starting with Celery 3.1, Python 2.6 or later is required.</p>
</div></blockquote>
</li>
<li><p>Support for the new <a class="extlink-pypi reference external" href="https://pypi.org/project/librabbitmq/">https://pypi.org/project/librabbitmq/</a> C client.</p>
<blockquote>
<div><p>Celery will automatically use the <a class="extlink-pypi reference external" href="https://pypi.org/project/librabbitmq/">https://pypi.org/project/librabbitmq/</a> module
if installed, which is a very fast and memory-optimized
replacement for the <a class="extlink-pypi reference external" href="https://pypi.org/project/amqp/">https://pypi.org/project/amqp/</a> module.</p>
</div></blockquote>
</li>
<li><p>Redis support is more reliable with improved ack emulation.</p></li>
<li><p>Celery now always uses UTC</p></li>
<li><p>Over 600 commits, 30k additions/36k deletions.</p>
<blockquote>
<div><p>In comparison 1.0➝ 2.0 had 18k additions/8k deletions.</p>
</div></blockquote>
</li>
</ul>
</aside>
</section>
<section id="important-notes">
<span id="v300-important"></span><h2>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading">¶</a></h2>
<section id="broadcast-exchanges-renamed">
<h3>Broadcast exchanges renamed<a class="headerlink" href="#broadcast-exchanges-renamed" title="Link to this heading">¶</a></h3>
<p>The workers remote control command exchanges has been renamed
(a new <a class="reference internal" href="../glossary.html#term-pidbox"><span class="xref std std-term">pidbox</span></a> name), this is because the <code class="docutils literal notranslate"><span class="pre">auto_delete</span></code> flag on
the exchanges has been removed, and that makes it incompatible with
earlier versions.</p>
<p>You can manually delete the old exchanges if you want,
using the <strong class="program">celery amqp</strong> command (previously called <code class="docutils literal notranslate"><span class="pre">camqadm</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>amqp<span class="w"> </span>exchange.delete<span class="w"> </span>celeryd.pidbox
<span class="gp">$ </span>celery<span class="w"> </span>amqp<span class="w"> </span>exchange.delete<span class="w"> </span>reply.celeryd.pidbox
</pre></div>
</div>
</section>
<section id="event-loop">
<h3>Event-loop<a class="headerlink" href="#event-loop" title="Link to this heading">¶</a></h3>
<p>The worker is now running <em>without threads</em> when used with RabbitMQ (AMQP),
or Redis as a broker, resulting in:</p>
<ul class="simple">
<li><p>Much better overall performance.</p></li>
<li><p>Fixes several edge case race conditions.</p></li>
<li><p>Sub-millisecond timer precision.</p></li>
<li><p>Faster shutdown times.</p></li>
</ul>
<p>The transports supported are:  <code class="docutils literal notranslate"><span class="pre">py-amqp</span></code> <code class="docutils literal notranslate"><span class="pre">librabbitmq</span></code>, <code class="docutils literal notranslate"><span class="pre">redis</span></code>,
and <code class="docutils literal notranslate"><span class="pre">amqplib</span></code>.
Hopefully this can be extended to include additional broker transports
in the future.</p>
<p>For increased reliability the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_FORCE_EXECV</span></code> setting is enabled
by default if the event-loop isn't used.</p>
</section>
<section id="new-celery-umbrella-command">
<h3>New <code class="docutils literal notranslate"><span class="pre">celery</span></code> umbrella command<a class="headerlink" href="#new-celery-umbrella-command" title="Link to this heading">¶</a></h3>
<p>All Celery's command-line programs are now available from a single
<strong class="program">celery</strong> umbrella command.</p>
<p>You can see a list of sub-commands and options by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span><span class="nb">help</span>
</pre></div>
</div>
<p>Commands include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span></code>  (previously <code class="docutils literal notranslate"><span class="pre">celeryd</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">beat</span></code>    (previously <code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">amqp</span></code>    (previously <code class="docutils literal notranslate"><span class="pre">camqadm</span></code>).</p></li>
</ul>
<p>The old programs are still available (<code class="docutils literal notranslate"><span class="pre">celeryd</span></code>, <code class="docutils literal notranslate"><span class="pre">celerybeat</span></code>, etc),
but you're discouraged from using them.</p>
</section>
<section id="now-depends-on-https-pypi-org-project-billiard">
<h3>Now depends on <a class="extlink-pypi reference external" href="https://pypi.org/project/billiard/">https://pypi.org/project/billiard/</a><a class="headerlink" href="#now-depends-on-https-pypi-org-project-billiard" title="Link to this heading">¶</a></h3>
<p>Billiard is a fork of the multiprocessing containing
the no-execv patch by <code class="docutils literal notranslate"><span class="pre">sbt</span></code> (<a class="reference external" href="http://bugs.python.org/issue8713">http://bugs.python.org/issue8713</a>),
and also contains the pool improvements previously located in Celery.</p>
<p>This fork was necessary as changes to the C extension code was required
for the no-execv patch to work.</p>
<ul class="simple">
<li><p><span class="xref issue">Issue #625</span></p></li>
<li><p><span class="xref issue">Issue #627</span></p></li>
<li><p><span class="xref issue">Issue #640</span></p></li>
<li><p><cite>django-celery #122 &lt;https://github.com/celery/django-celery/issues/122</cite></p></li>
<li><p><cite>django-celery #124 &lt;https://github.com/celery/django-celery/issues/122</cite></p></li>
</ul>
</section>
<section id="celery-app-task-no-longer-a-package">
<h3><a class="reference internal" href="../reference/celery.app.task.html#module-celery.app.task" title="celery.app.task"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.task</span></code></a> no longer a package<a class="headerlink" href="#celery-app-task-no-longer-a-package" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../reference/celery.app.task.html#module-celery.app.task" title="celery.app.task"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.task</span></code></a> module is now a module instead of a package.</p>
<p>The <code class="file docutils literal notranslate"><span class="pre">setup.py</span></code> install script will try to remove the old package,
but if that doesn't work for some reason you have to remove
it manually. This command helps:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>rm<span class="w"> </span>-r<span class="w"> </span><span class="k">$(</span>dirname<span class="w"> </span><span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import celery;print(celery.__file__)&#39;</span><span class="k">))</span>/app/task/
</pre></div>
</div>
<p>If you experience an error like <code class="docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">cannot</span> <span class="pre">import</span> <span class="pre">name</span> <span class="pre">_unpickle_task</span></code>,
you just have to remove the old package and everything is fine.</p>
</section>
<section id="last-version-to-support-python-2-5">
<h3>Last version to support Python 2.5<a class="headerlink" href="#last-version-to-support-python-2-5" title="Link to this heading">¶</a></h3>
<p>The 3.0 series will be last version to support Python 2.5,
and starting from 3.1 Python 2.6 and later will be required.</p>
<p>With several other distributions taking the step to discontinue
Python 2.5 support, we feel that it is time too.</p>
<p>Python 2.6 should be widely available at this point, and we urge
you to upgrade, but if that's not possible you still have the option
to continue using the Celery 3.0, and important bug fixes
introduced in Celery 3.1 will be back-ported to Celery 3.0 upon request.</p>
</section>
<section id="utc-timezone-is-now-used">
<h3>UTC timezone is now used<a class="headerlink" href="#utc-timezone-is-now-used" title="Link to this heading">¶</a></h3>
<p>This means that ETA/countdown in messages aren't compatible with Celery
versions prior to 2.5.</p>
<p>You can disable UTC and revert back to old local time by setting
the <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_ENABLE_UTC</span></code> setting.</p>
</section>
<section id="redis-ack-emulation-improvements">
<h3>Redis: Ack emulation improvements<a class="headerlink" href="#redis-ack-emulation-improvements" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Reducing the possibility of data loss.</p>
<p>Acks are now implemented by storing a copy of the message when the message
is consumed. The copy isn't removed until the consumer acknowledges
or rejects it.</p>
<p>This means that unacknowledged messages will be redelivered either
when the connection is closed, or when the visibility timeout is exceeded.</p>
<ul>
<li><p>Visibility timeout</p>
<blockquote>
<div><p>This is a timeout for acks, so that if the consumer
doesn't ack the message within this time limit, the message
is redelivered to another consumer.</p>
<p>The timeout is set to one hour by default, but
can be changed by configuring a transport option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BROKER_TRANSPORT_OPTIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;visibility_timeout&#39;</span><span class="p">:</span> <span class="mi">18000</span><span class="p">}</span>  <span class="c1"># 5 hours</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Messages that haven't been acked will be redelivered
if the visibility timeout is exceeded, for Celery users
this means that ETA/countdown tasks that are scheduled to execute
with a time that exceeds the visibility timeout will be executed
twice (or more). If you plan on using long ETA/countdowns you
should tweak the visibility timeout accordingly.</p>
</div>
<p>Setting a long timeout means that it'll take a long time
for messages to be redelivered in the event of a power failure,
but if so happens you could temporarily set the visibility timeout lower
to flush out messages when you start up the systems again.</p>
</div></blockquote>
</section>
</section>
<section id="news">
<span id="v300-news"></span><h2>News<a class="headerlink" href="#news" title="Link to this heading">¶</a></h2>
<section id="chaining-tasks">
<h3>Chaining Tasks<a class="headerlink" href="#chaining-tasks" title="Link to this heading">¶</a></h3>
<p>Tasks can now have callbacks and errbacks, and dependencies are recorded</p>
<ul>
<li><p>The task message format have been updated with two new extension keys</p>
<blockquote>
<div><p>Both keys can be empty/undefined or a list of subtasks.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">callbacks</span></code></p>
<blockquote>
<div><p>Applied if the task exits successfully, with the result
of the task as an argument.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">errbacks</span></code></p>
<blockquote>
<div><p>Applied if an error occurred while executing the task,
with the uuid of the task as an argument. Since it may not be possible
to serialize the exception instance, it passes the uuid of the task
instead. The uuid can then be used to retrieve the exception and
traceback of the task from the result backend.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">link</span></code> and <code class="docutils literal notranslate"><span class="pre">link_error</span></code> keyword arguments has been added
to <code class="docutils literal notranslate"><span class="pre">apply_async</span></code>.</p>
<blockquote>
<div><p>These add callbacks and errbacks to the task, and
you can read more about them at <a class="reference internal" href="../userguide/calling.html#calling-links"><span class="std std-ref">链接（回调/错误回调）</span></a>.</p>
</div></blockquote>
</li>
<li><p>We now track what subtasks a task sends, and some result backends
supports retrieving this information.</p>
<blockquote>
<div><blockquote>
<div><ul>
<li><p>task.request.children</p>
<blockquote>
<div><p>Contains the result instances of the subtasks
the currently executing task has applied.</p>
</div></blockquote>
</li>
<li><p>AsyncResult.children</p>
<blockquote>
<div><p>Returns the tasks dependencies, as a list of
<code class="docutils literal notranslate"><span class="pre">AsyncResult</span></code>/<code class="docutils literal notranslate"><span class="pre">ResultSet</span></code> instances.</p>
</div></blockquote>
</li>
<li><p>AsyncResult.iterdeps</p>
<blockquote>
<div><p>Recursively iterates over the tasks dependencies,
yielding <cite>(parent, node)</cite> tuples.</p>
<p>Raises IncompleteStream if any of the dependencies
hasn't returned yet.</p>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<ul>
<li><p>AsyncResult.graph</p>
<blockquote>
<div><p>A <a class="reference internal" href="../internals/reference/celery.utils.graph.html#celery.utils.graph.DependencyGraph" title="celery.utils.graph.DependencyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">DependencyGraph</span></code></a> of the tasks
dependencies. With this you can also convert to dot format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;graph.dot&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
    <span class="n">result</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">to_dot</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</pre></div>
</div>
<p>then produce an image of the graph:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>dot<span class="w"> </span>-Tpng<span class="w"> </span>graph.dot<span class="w"> </span>-o<span class="w"> </span>graph.png
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>A new special subtask called <code class="docutils literal notranslate"><span class="pre">chain</span></code> is also included:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>

<span class="go"># (2 + 2) * 8 / 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
<span class="go">                mul.subtask((8,)),</span>
<span class="go">                div.subtask((2,))).apply_async()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">16</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">32</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Adds <code class="xref py py-meth docutils literal notranslate"><span class="pre">AsyncResult.get_leaf()</span></code></p>
<blockquote>
<div><p>Waits and returns the result of the leaf subtask.
That's the last node found when traversing the graph,
but this means that the graph can be 1-dimensional only (in effect
a list).</p>
</div></blockquote>
</li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">subtask.link(subtask)</span></code> + <code class="docutils literal notranslate"><span class="pre">subtask.link_error(subtask)</span></code></p>
<blockquote>
<div><p>Shortcut to <code class="docutils literal notranslate"><span class="pre">s.options.setdefault('link',</span> <span class="pre">[]).append(subtask)</span></code></p>
</div></blockquote>
</li>
<li><p>Adds <code class="docutils literal notranslate"><span class="pre">subtask.flatten_links()</span></code></p>
<blockquote>
<div><p>Returns a flattened list of all dependencies (recursively)</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="redis-priority-support">
<h3>Redis: Priority support<a class="headerlink" href="#redis-priority-support" title="Link to this heading">¶</a></h3>
<p>The message's <code class="docutils literal notranslate"><span class="pre">priority</span></code> field is now respected by the Redis
transport by having multiple lists for each named queue.
The queues are then consumed by in order of priority.</p>
<p>The priority field is a number in the range of 0 - 9, where
0 is the default and highest priority.</p>
<p>The priority range is collapsed into four steps by default, since it is
unlikely that nine steps will yield more benefit than using four steps.
The number of steps can be configured by setting the <code class="docutils literal notranslate"><span class="pre">priority_steps</span></code>
transport option, which must be a list of numbers in <strong>sorted order</strong>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BROKER_TRANSPORT_OPTIONS</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s1">&#39;priority_steps&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>Priorities implemented in this way isn't as reliable as
priorities on the server side, which is why
the feature is nicknamed &quot;quasi-priorities&quot;;
<strong>Using routing is still the suggested way of ensuring
quality of service</strong>, as client implemented priorities
fall short in a number of ways, for example if the worker
is busy with long running tasks, has prefetched many messages,
or the queues are congested.</p>
<p>Still, it is possible that using priorities in combination
with routing can be more beneficial than using routing
or priorities alone. Experimentation and monitoring
should be used to prove this.</p>
<p>Contributed by Germán M. Bravo.</p>
</section>
<section id="redis-now-cycles-queues-so-that-consuming-is-fair">
<h3>Redis: Now cycles queues so that consuming is fair<a class="headerlink" href="#redis-now-cycles-queues-so-that-consuming-is-fair" title="Link to this heading">¶</a></h3>
<p>This ensures that a very busy queue won't block messages
from other queues, and ensures that all queues have
an equal chance of being consumed from.</p>
<p>This used to be the case before, but the behavior was
accidentally changed while switching to using blocking pop.</p>
</section>
<section id="group-chord-chain-are-now-subtasks">
<h3><cite>group</cite>/<cite>chord</cite>/<cite>chain</cite> are now subtasks<a class="headerlink" href="#group-chord-chain-are-now-subtasks" title="Link to this heading">¶</a></h3>
<ul>
<li><p>group is no longer an alias to <code class="docutils literal notranslate"><span class="pre">TaskSet</span></code>, but new all together,
since it was very difficult to migrate the <code class="docutils literal notranslate"><span class="pre">TaskSet</span></code> class to become
a subtask.</p></li>
<li><p>A new shortcut has been added to tasks:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">task</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">kw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>as a shortcut to:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">task</span><span class="o">.</span><span class="n">subtask</span><span class="p">((</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">),</span> <span class="p">{</span><span class="s1">&#39;kw&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Tasks can be chained by using the <code class="docutils literal notranslate"><span class="pre">|</span></code> operator:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">pow</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Subtasks can be &quot;evaluated&quot; using the <code class="docutils literal notranslate"><span class="pre">~</span></code> operator:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="o">~</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="o">~</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="nb">pow</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>is the same as:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">pow</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>A new subtask_type key has been added to the subtask dictionary.</p>
<blockquote>
<div><p>This can be the string <code class="docutils literal notranslate"><span class="pre">&quot;chord&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;group&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;chain&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;chunks&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;xmap&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;xstarmap&quot;</span></code>.</p>
</div></blockquote>
</li>
<li><p>maybe_subtask now uses subtask_type to reconstruct
the object, to be used when using non-pickle serializers.</p></li>
<li><p>The logic for these operations have been moved to dedicated
tasks celery.chord, celery.chain and celery.group.</p></li>
<li><p>subtask no longer inherits from AttributeDict.</p>
<blockquote>
<div><p>It's now a pure dict subclass with properties for attribute
access to the relevant keys.</p>
</div></blockquote>
</li>
<li><p>The repr's now outputs how the sequence would like imperatively:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chord</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">chord</span><span class="p">([</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())</span>
<span class="go">      | pow.s(2))</span>
<span class="go">tasks.xsum([tasks.add(0, 0),</span>
<span class="go">            tasks.add(1, 1),</span>
<span class="go">            tasks.add(2, 2),</span>
<span class="go">            tasks.add(3, 3),</span>
<span class="go">            tasks.add(4, 4),</span>
<span class="go">            tasks.add(5, 5),</span>
<span class="go">            tasks.add(6, 6),</span>
<span class="go">            tasks.add(7, 7),</span>
<span class="go">            tasks.add(8, 8),</span>
<span class="go">            tasks.add(9, 9)]) | tasks.pow(2)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="new-remote-control-commands">
<h3>New remote control commands<a class="headerlink" href="#new-remote-control-commands" title="Link to this heading">¶</a></h3>
<p>These commands were previously experimental, but they've proven
stable and is now documented as part of the official API.</p>
<ul>
<li><p><a class="reference internal" href="../userguide/workers.html#std-control-add_consumer"><code class="xref std std-control docutils literal notranslate"><span class="pre">add_consumer</span></code></a>/<a class="reference internal" href="../userguide/workers.html#std-control-cancel_consumer"><code class="xref std std-control docutils literal notranslate"><span class="pre">cancel_consumer</span></code></a></p>
<blockquote>
<div><p>Tells workers to consume from a new queue, or cancel consuming from a
queue. This command has also been changed so that the worker remembers
the queues added, so that the change will persist even if
the connection is re-connected.</p>
<p>These commands are available programmatically as
<a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.add_consumer" title="celery.app.control.Control.add_consumer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.add_consumer()</span></code></a> / <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.cancel_consumer" title="celery.app.control.Control.cancel_consumer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.cancel_consumer()</span></code></a>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">add_consumer</span><span class="p">(</span><span class="n">queue_name</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w1.example.com&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">cancel_consumer</span><span class="p">(</span><span class="n">queue_name</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w1.example.com&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>or using the <strong class="program">celery control</strong> command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>control<span class="w"> </span>-d<span class="w"> </span>w1.example.com<span class="w"> </span>add_consumer<span class="w"> </span>queue
<span class="gp">$ </span>celery<span class="w"> </span>control<span class="w"> </span>-d<span class="w"> </span>w1.example.com<span class="w"> </span>cancel_consumer<span class="w"> </span>queue
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Remember that a control command without <em>destination</em> will be
sent to <strong>all workers</strong>.</p>
</div>
</div></blockquote>
</li>
<li><p><code class="xref std std-control docutils literal notranslate"><span class="pre">autoscale</span></code></p>
<blockquote>
<div><p>Tells workers with <code class="docutils literal notranslate"><span class="pre">--autoscale</span></code> enabled to change autoscale
max/min concurrency settings.</p>
<p>This command is available programmatically as <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.autoscale" title="celery.app.control.Control.autoscale"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.autoscale()</span></code></a>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w1.example.com&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>or using the <strong class="program">celery control</strong> command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>control<span class="w"> </span>-d<span class="w"> </span>w1.example.com<span class="w"> </span>autoscale<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><code class="xref std std-control docutils literal notranslate"><span class="pre">pool_grow</span></code>/<code class="xref std std-control docutils literal notranslate"><span class="pre">pool_shrink</span></code></p>
<blockquote>
<div><p>Tells workers to add or remove pool processes.</p>
<p>These commands are available programmatically as
<a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.pool_grow" title="celery.app.control.Control.pool_grow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.pool_grow()</span></code></a> / <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.pool_shrink" title="celery.app.control.Control.pool_shrink"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.pool_shrink()</span></code></a>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">pool_grow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w1.example.com&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">pool_shrink</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;w1.example.com&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>or using the <strong class="program">celery control</strong> command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>control<span class="w"> </span>-d<span class="w"> </span>w1.example.com<span class="w"> </span>pool_grow<span class="w"> </span><span class="m">2</span>
<span class="gp">$ </span>celery<span class="w"> </span>control<span class="w"> </span>-d<span class="w"> </span>w1.example.com<span class="w"> </span>pool_shrink<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong class="program">celery control</strong> now supports <a class="reference internal" href="../userguide/workers.html#std-control-rate_limit"><code class="xref std std-control docutils literal notranslate"><span class="pre">rate_limit</span></code></a> and
<code class="xref std std-control docutils literal notranslate"><span class="pre">time_limit</span></code> commands.</p>
<blockquote>
<div><p>See <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">control</span> <span class="pre">--help</span></code> for details.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="crontab-now-supports-day-of-month-and-month-of-year-arguments">
<h3>Crontab now supports Day of Month, and Month of Year arguments<a class="headerlink" href="#crontab-now-supports-day-of-month-and-month-of-year-arguments" title="Link to this heading">¶</a></h3>
<p>See the updated list of examples at <a class="reference internal" href="../userguide/periodic-tasks.html#beat-crontab"><span class="std std-ref">Crontab 调度</span></a>.</p>
</section>
<section id="immutable-subtasks">
<h3>Immutable subtasks<a class="headerlink" href="#immutable-subtasks" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">subtask</span></code>'s can now be immutable, which means that the arguments
won't be modified when calling callbacks:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">clear_static_electricity</span><span class="o">.</span><span class="n">si</span><span class="p">())</span>
</pre></div>
</div>
<p>means it'll not receive the argument of the parent task,
and <code class="docutils literal notranslate"><span class="pre">.si()</span></code> is a shortcut to:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clear_static_electricity</span><span class="o">.</span><span class="n">subtask</span><span class="p">(</span><span class="n">immutable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="logging-improvements">
<h3>Logging Improvements<a class="headerlink" href="#logging-improvements" title="Link to this heading">¶</a></h3>
<p>Logging support now conforms better with best practices.</p>
<ul>
<li><p>Classes used by the worker no longer uses app.get_default_logger, but uses
<cite>celery.utils.log.get_logger</cite> which simply gets the logger not setting the
level, and adds a NullHandler.</p></li>
<li><p>Loggers are no longer passed around, instead every module using logging
defines a module global logger that's used throughout.</p></li>
<li><p>All loggers inherit from a common logger called &quot;celery&quot;.</p></li>
<li><p>Before <code class="docutils literal notranslate"><span class="pre">task.get_logger</span></code> would setup a new logger for every task,
and even set the log level. This is no longer the case.</p>
<blockquote>
<div><ul class="simple">
<li><p>Instead all task loggers now inherit from a common &quot;celery.task&quot; logger
that's set up when programs call <cite>setup_logging_subsystem</cite>.</p></li>
<li><p>Instead of using LoggerAdapter to augment the formatter with
the task_id and task_name field, the task base logger now use
a special formatter adding these values at run-time from the
currently executing task.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>In fact, <code class="docutils literal notranslate"><span class="pre">task.get_logger</span></code> is no longer recommended, it is better
to add a module-level logger to your tasks module.</p>
<blockquote>
<div><p>For example, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.utils.log</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_task_logger</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">get_task_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@celery</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Adding </span><span class="si">%r</span><span class="s1"> + </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>The resulting logger will then inherit from the <code class="docutils literal notranslate"><span class="pre">&quot;celery.task&quot;</span></code> logger
so that the current task name and id is included in logging output.</p>
</div></blockquote>
</li>
<li><p>Redirected output from stdout/stderr is now logged to a &quot;celery.redirected&quot;
logger.</p></li>
<li><p>In addition a few warnings.warn have been replaced with logger.warn.</p></li>
<li><p>Now avoids the 'no handlers for logger multiprocessing' warning</p></li>
</ul>
</section>
<section id="task-registry-no-longer-global">
<h3>Task registry no longer global<a class="headerlink" href="#task-registry-no-longer-global" title="Link to this heading">¶</a></h3>
<p>Every Celery instance now has its own task registry.</p>
<p>You can make apps share registries by specifying it:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app1</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app2</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="n">tasks</span><span class="o">=</span><span class="n">app1</span><span class="o">.</span><span class="n">tasks</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that tasks are shared between registries by default, so that
tasks will be added to every subsequently created task registry.
As an alternative tasks can be private to specific task registries
by setting the <code class="docutils literal notranslate"><span class="pre">shared</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">&#64;task</span></code> decorator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@celery</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">shared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="abstract-tasks-are-now-lazily-bound">
<h3>Abstract tasks are now lazily bound<a class="headerlink" href="#abstract-tasks-are-now-lazily-bound" title="Link to this heading">¶</a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code> class is no longer bound to an app
by default, it will first be bound (and configured) when
a concrete subclass is created.</p>
<p>This means that you can safely import and make task base classes,
without also initializing the app environment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">Task</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DebugTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CALLING </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DebugTask</span>
<span class="go">&lt;unbound DebugTask&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@celery1</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">DebugTask</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="vm">__class__</span>
<span class="go">&lt;class add of &lt;Celery default:0x101510d10&gt;&gt;</span>
</pre></div>
</div>
</section>
<section id="lazy-task-decorators">
<h3>Lazy task decorators<a class="headerlink" href="#lazy-task-decorators" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;task</span></code> decorator is now lazy when used with custom apps.</p>
<p>That is, if <code class="docutils literal notranslate"><span class="pre">accept_magic_kwargs</span></code> is enabled (her by called &quot;compat mode&quot;), the task
decorator executes inline like before, however for custom apps the &#64;task
decorator now returns a special PromiseProxy object that's only evaluated
on access.</p>
<p>All promises will be evaluated when <a class="reference internal" href="../reference/celery.html#celery.Celery.finalize" title="celery.Celery.finalize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.finalize()</span></code></a> is called, or implicitly
when the task registry is first used.</p>
</section>
<section id="smart-app-option">
<h3>Smart <cite>--app</cite> option<a class="headerlink" href="#smart-app-option" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code></a> option now 'auto-detects'</p>
<blockquote>
<div><ul class="simple">
<li><p>If the provided path is a module it tries to get an
attribute named 'celery'.</p></li>
<li><p>If the provided path is a package it tries
to import a sub module named celery',
and get the celery attribute from that module.</p></li>
</ul>
</div></blockquote>
<p>For example, if you have a project named <code class="docutils literal notranslate"><span class="pre">proj</span></code> where the
celery app is located in <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">proj.celery</span> <span class="pre">import</span> <span class="pre">app</span></code>,
then the following will be equivalent:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>--app<span class="o">=</span>proj
<span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>--app<span class="o">=</span>proj.celery:
<span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>--app<span class="o">=</span>proj.celery:app
</pre></div>
</div>
</section>
<section id="in-other-news">
<h3>In Other News<a class="headerlink" href="#in-other-news" title="Link to this heading">¶</a></h3>
<ul>
<li><p>New <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYD_WORKER_LOST_WAIT</span></code> to control the timeout in
seconds before <code class="xref py py-exc docutils literal notranslate"><span class="pre">billiard.WorkerLostError</span></code> is raised
when a worker can't be signaled (<span class="xref issue">Issue #595</span>).</p>
<blockquote>
<div><p>Contributed by Brendon Crawford.</p>
</div></blockquote>
</li>
<li><p>Redis event monitor queues are now automatically deleted (<span class="xref issue">Issue #436</span>).</p></li>
<li><p>App instance factory methods have been converted to be cached
descriptors that creates a new subclass on access.</p>
<blockquote>
<div><p>For example, this means that <code class="docutils literal notranslate"><span class="pre">app.Worker</span></code> is an actual class
and will work as expected when:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Worker</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">Worker</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>New signal: <a class="reference internal" href="../userguide/signals.html#std-signal-task_success"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_success</span></code></a>.</p></li>
<li><p>Multiprocessing logs are now only emitted if the <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MP_LOG</span></code>
environment variable is set.</p></li>
<li><p>The Celery instance can now be created with a broker URL</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="n">broker</span><span class="o">=</span><span class="s1">&#39;redis://&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Result backends can now be set using a URL</p>
<blockquote>
<div><p>Currently only supported by redis. Example use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CELERY_RESULT_BACKEND</span> <span class="o">=</span> <span class="s1">&#39;redis://localhost/1&#39;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Heartbeat frequency now every 5s, and frequency sent with event</p>
<blockquote>
<div><p>The heartbeat frequency is now available in the worker event messages,
so that clients can decide when to consider workers offline based on
this value.</p>
</div></blockquote>
</li>
<li><p>Module celery.actors has been removed, and will be part of cl instead.</p></li>
<li><p>Introduces new <code class="docutils literal notranslate"><span class="pre">celery</span></code> command, which is an entry-point for all other
commands.</p>
<blockquote>
<div><p>The main for this command can be run by calling <code class="docutils literal notranslate"><span class="pre">celery.start()</span></code>.</p>
</div></blockquote>
</li>
<li><p>Annotations now supports decorators if the key starts with '&#64;'.</p>
<blockquote>
<div><p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">debug_args</span><span class="p">(</span><span class="n">fun</span><span class="p">):</span>

    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fun</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ARGS: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">_inner</span>

<span class="n">CELERY_ANNOTATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@__call__&#39;</span><span class="p">:</span> <span class="n">debug_args</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Also tasks are now always bound by class so that
annotated methods end up being bound.</p>
</div></blockquote>
</li>
<li><p>Bug-report now available as a command and broadcast command</p>
<blockquote>
<div><ul>
<li><p>Get it from a Python REPL:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">celery</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">celery</span><span class="o">.</span><span class="n">bugreport</span><span class="p">())</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">celery</span></code> command line program:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>report
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Get it from remote workers:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>inspect<span class="w"> </span>report
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Module <code class="docutils literal notranslate"><span class="pre">celery.log</span></code> moved to <a class="reference internal" href="../reference/celery.app.log.html#module-celery.app.log" title="celery.app.log"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.log</span></code></a>.</p></li>
<li><p>Module <code class="docutils literal notranslate"><span class="pre">celery.task.control</span></code> moved to <a class="reference internal" href="../reference/celery.app.control.html#module-celery.app.control" title="celery.app.control"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.control</span></code></a>.</p></li>
<li><p>New signal: <a class="reference internal" href="../userguide/signals.html#std-signal-task_revoked"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_revoked</span></code></a></p>
<blockquote>
<div><p>Sent in the main process when the task is revoked or terminated.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">AsyncResult.task_id</span></code> renamed to <code class="docutils literal notranslate"><span class="pre">AsyncResult.id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TasksetResult.taskset_id</span></code> renamed to <code class="docutils literal notranslate"><span class="pre">.id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">xmap(task,</span> <span class="pre">sequence)</span></code> and <code class="docutils literal notranslate"><span class="pre">xstarmap(task,</span> <span class="pre">sequence)</span></code></p>
<blockquote>
<div><p>Returns a list of the results applying the task function to every item
in the sequence.</p>
<p>Example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">xstarmap</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">xstarmap</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">chunks(task,</span> <span class="pre">sequence,</span> <span class="pre">chunksize)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group.skew(start=,</span> <span class="pre">stop=,</span> <span class="pre">step=)</span></code></p>
<blockquote>
<div><p>Skew will skew the countdown for the individual tasks in a group -- for
example with this group:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>Skewing the tasks from 0 seconds to 10 seconds:</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">skew</span><span class="p">(</span><span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Will have the first task execute in 0 seconds, the second in 1 second,
the third in 2 seconds and so on.</p>
</li>
<li><p>99% test Coverage</p></li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_QUEUES</span></code> can now be a list/tuple of <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Queue" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>
instances.</p>
<blockquote>
<div><p>Internally <a class="reference internal" href="../reference/celery.app.amqp.html#celery.app.amqp.AMQP.queues" title="celery.app.amqp.AMQP.queues"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app.amqp.queues</span></code></a> is now a mapping of name/Queue instances,
instead of converting on the fly.</p>
</div></blockquote>
</li>
<li><p>Can now specify connection for <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.inspect" title="celery.app.control.Control.inspect"><code class="xref py py-class docutils literal notranslate"><span class="pre">app.control.inspect</span></code></a>.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">kombu</span><span class="w"> </span><span class="kn">import</span> <span class="n">Connection</span>

<span class="n">i</span> <span class="o">=</span> <span class="n">celery</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">inspect</span><span class="p">(</span><span class="n">connection</span><span class="o">=</span><span class="n">Connection</span><span class="p">(</span><span class="s1">&#39;redis://&#39;</span><span class="p">))</span>
<span class="n">i</span><span class="o">.</span><span class="n">active_queues</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_FORCE_EXECV</span></code> is now enabled by default.</p>
<blockquote>
<div><p>If the old behavior is wanted the setting can be set to False,
or the new <cite>--no-execv</cite> option to <strong class="program">celery worker</strong>.</p>
</div></blockquote>
</li>
<li><p>Deprecated module <code class="docutils literal notranslate"><span class="pre">celery.conf</span></code> has been removed.</p></li>
<li><p>The <code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERY_TIMEZONE</span></code> now always require the <a class="extlink-pypi reference external" href="https://pypi.org/project/pytz/">https://pypi.org/project/pytz/</a>
library to be installed (except if the timezone is set to <cite>UTC</cite>).</p></li>
<li><p>The Tokyo Tyrant backend has been removed and is no longer supported.</p></li>
<li><p>Now uses <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.common.html#kombu.common.maybe_declare" title="（在 Kombu v5.5）"><code class="xref py py-func docutils literal notranslate"><span class="pre">maybe_declare()</span></code></a> to cache queue declarations.</p></li>
<li><p>There's no longer a global default for the
<code class="xref std std-setting docutils literal notranslate"><span class="pre">CELERYBEAT_MAX_LOOP_INTERVAL</span></code> setting, it is instead
set by individual schedulers.</p></li>
<li><p>Worker: now truncates very long message bodies in error reports.</p></li>
<li><p>No longer deep-copies exceptions when trying to serialize errors.</p></li>
<li><p><span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CELERY_BENCH</span></code> environment variable, will now also list
memory usage statistics at worker shutdown.</p></li>
<li><p>Worker: now only ever use a single timer for all timing needs,
and instead set different priorities.</p></li>
<li><p>An exceptions arguments are now safely pickled</p>
<blockquote>
<div><p>Contributed by Matt Long.</p>
</div></blockquote>
</li>
<li><p>Worker/Beat no longer logs the start-up banner.</p>
<blockquote>
<div><p>Previously it would be logged with severity warning,
now it's only written to stdout.</p>
</div></blockquote>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">contrib/</span></code> directory in the distribution has been renamed to
<code class="docutils literal notranslate"><span class="pre">extra/</span></code>.</p></li>
<li><p>New signal: <a class="reference internal" href="../userguide/signals.html#std-signal-task_revoked"><code class="xref std std-signal docutils literal notranslate"><span class="pre">task_revoked</span></code></a></p></li>
<li><p><a class="reference internal" href="../reference/celery.contrib.migrate.html#module-celery.contrib.migrate" title="celery.contrib.migrate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a>: Many improvements, including;
filtering, queue migration, and support for acking messages on the broker
migrating from.</p>
<blockquote>
<div><p>Contributed by John Watson.</p>
</div></blockquote>
</li>
<li><p>Worker: Prefetch count increments are now optimized and grouped together.</p></li>
<li><p>Worker: No longer calls <code class="docutils literal notranslate"><span class="pre">consume</span></code> on the remote control command queue
twice.</p>
<blockquote>
<div><p>Probably didn't cause any problems, but was unnecessary.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="internals">
<h3>Internals<a class="headerlink" href="#internals" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">app.broker_connection</span></code> is now <code class="docutils literal notranslate"><span class="pre">app.connection</span></code></p>
<blockquote>
<div><p>Both names still work.</p>
</div></blockquote>
</li>
<li><p>Compatibility modules are now generated dynamically upon use.</p>
<blockquote>
<div><p>These modules are <code class="docutils literal notranslate"><span class="pre">celery.messaging</span></code>, <code class="docutils literal notranslate"><span class="pre">celery.log</span></code>,
<code class="docutils literal notranslate"><span class="pre">celery.decorators</span></code> and <code class="docutils literal notranslate"><span class="pre">celery.registry</span></code>.</p>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="../internals/reference/celery.utils.html#module-celery.utils" title="celery.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.utils</span></code></a> refactored into multiple modules:</p>
<blockquote>
<div><p><a class="reference internal" href="../internals/reference/celery.utils.text.html#module-celery.utils.text" title="celery.utils.text"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a>
<a class="reference internal" href="../internals/reference/celery.utils.imports.html#module-celery.utils.imports" title="celery.utils.imports"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a>
<a class="reference internal" href="../internals/reference/celery.utils.functional.html#module-celery.utils.functional" title="celery.utils.functional"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></p>
</div></blockquote>
</li>
<li><p>Now using <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.utils.encoding.html#module-kombu.utils.encoding" title="（在 Kombu v5.5）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kombu.utils.encoding</span></code></a> instead of
<code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.utils.encoding</span></code>.</p></li>
<li><p>Renamed module <code class="docutils literal notranslate"><span class="pre">celery.routes</span></code> -&gt; <a class="reference internal" href="../internals/reference/celery.app.routes.html#module-celery.app.routes" title="celery.app.routes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a>.</p></li>
<li><p>Renamed package <code class="docutils literal notranslate"><span class="pre">celery.db</span></code> -&gt; <a class="reference internal" href="../internals/reference/celery.backends.database.html#module-celery.backends.database" title="celery.backends.database"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a>.</p></li>
<li><p>Renamed module <code class="docutils literal notranslate"><span class="pre">celery.abstract</span></code> -&gt; <code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.worker.bootsteps</span></code>.</p></li>
<li><p>Command line docs are now parsed from the module docstrings.</p></li>
<li><p>Test suite directory has been reorganized.</p></li>
<li><p><strong class="program">setup.py</strong> now reads docs from the <code class="file docutils literal notranslate"><span class="pre">requirements/</span></code> directory.</p></li>
<li><p>Celery commands no longer wraps output (<span class="xref issue">Issue #700</span>).</p>
<blockquote>
<div><p>Contributed by Thomas Johansson.</p>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="experimental">
<span id="v300-experimental"></span><h2>Experimental<a class="headerlink" href="#experimental" title="Link to this heading">¶</a></h2>
<section id="celery-contrib-methods-task-decorator-for-methods">
<h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.methods</span></code>:  Task decorator for methods<a class="headerlink" href="#celery-contrib-methods-task-decorator-for-methods" title="Link to this heading">¶</a></h3>
<p>This is an experimental module containing a task
decorator, and a task decorator filter, that can be used
to create tasks out of methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.contrib.methods</span><span class="w"> </span><span class="kn">import</span> <span class="n">task_method</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Counter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@celery</span><span class="o">.</span><span class="n">task</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Counter.increment&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">task_method</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">increment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
<p>See <code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.methods</span></code> for more information.</p>
</section>
</section>
<section id="unscheduled-removals">
<span id="v300-unscheduled-removals"></span><h2>Unscheduled Removals<a class="headerlink" href="#unscheduled-removals" title="Link to this heading">¶</a></h2>
<p>Usually we don't make backward incompatible removals,
but these removals should have no major effect.</p>
<ul>
<li><p>The following settings have been renamed:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CELERYD_ETA_SCHEDULER</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERYD_TIMER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CELERYD_ETA_SCHEDULER_PRECISION</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">CELERYD_TIMER_PRECISION</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="deprecation-time-line-changes">
<span id="v300-deprecations"></span><h2>Deprecation Time-line Changes<a class="headerlink" href="#deprecation-time-line-changes" title="Link to this heading">¶</a></h2>
<p>See the <a class="reference internal" href="../internals/deprecation.html#deprecation-timeline"><span class="std std-ref">Celery 弃用时间表</span></a>.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">celery.backends.pyredis</span></code> compat module has been removed.</p>
<blockquote>
<div><p>Use <a class="reference internal" href="../internals/reference/celery.backends.redis.html#module-celery.backends.redis" title="celery.backends.redis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a> instead!</p>
</div></blockquote>
</li>
<li><p>The following undocumented API's has been moved:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">control.inspect.add_consumer</span></code> -&gt; <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.add_consumer" title="celery.app.control.Control.add_consumer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.add_consumer()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">control.inspect.cancel_consumer</span></code> -&gt; <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.cancel_consumer" title="celery.app.control.Control.cancel_consumer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.cancel_consumer()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">control.inspect.enable_events</span></code> -&gt; <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.enable_events" title="celery.app.control.Control.enable_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.enable_events()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">control.inspect.disable_events</span></code> -&gt; <a class="reference internal" href="../reference/celery.app.control.html#celery.app.control.Control.disable_events" title="celery.app.control.Control.disable_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">app.control.disable_events()</span></code></a>.</p></li>
</ul>
<p>This way <code class="docutils literal notranslate"><span class="pre">inspect()</span></code> is only used for commands that don't
modify anything, while idempotent control commands that make changes
are on the control objects.</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="fixes">
<h2>Fixes<a class="headerlink" href="#fixes" title="Link to this heading">¶</a></h2>
<ul>
<li><p>Retry SQLAlchemy backend operations on DatabaseError/OperationalError
(<span class="xref issue">Issue #634</span>)</p></li>
<li><p>Tasks that called <code class="docutils literal notranslate"><span class="pre">retry</span></code> wasn't acknowledged if acks late was enabled</p>
<blockquote>
<div><p>Fix contributed by David Markey.</p>
</div></blockquote>
</li>
<li><p>The message priority argument wasn't properly propagated to Kombu
(<span class="xref issue">Issue #708</span>).</p>
<blockquote>
<div><p>Fix contributed by Eran Rundstein</p>
</div></blockquote>
</li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog-3.0.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Change history for Celery 3.0</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="changelog-3.1.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Change history</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2009-2023, Ask Solem &amp; contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">What's new in Celery 3.0 (Chiastic Slide)</a><ul>
<li><a class="reference internal" href="#highlights">Highlights</a></li>
<li><a class="reference internal" href="#important-notes">Important Notes</a><ul>
<li><a class="reference internal" href="#broadcast-exchanges-renamed">Broadcast exchanges renamed</a></li>
<li><a class="reference internal" href="#event-loop">Event-loop</a></li>
<li><a class="reference internal" href="#new-celery-umbrella-command">New <code class="docutils literal notranslate"><span class="pre">celery</span></code> umbrella command</a></li>
<li><a class="reference internal" href="#now-depends-on-https-pypi-org-project-billiard">Now depends on https://pypi.org/project/billiard/</a></li>
<li><a class="reference internal" href="#celery-app-task-no-longer-a-package"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.app.task</span></code> no longer a package</a></li>
<li><a class="reference internal" href="#last-version-to-support-python-2-5">Last version to support Python 2.5</a></li>
<li><a class="reference internal" href="#utc-timezone-is-now-used">UTC timezone is now used</a></li>
<li><a class="reference internal" href="#redis-ack-emulation-improvements">Redis: Ack emulation improvements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#news">News</a><ul>
<li><a class="reference internal" href="#chaining-tasks">Chaining Tasks</a></li>
<li><a class="reference internal" href="#redis-priority-support">Redis: Priority support</a></li>
<li><a class="reference internal" href="#redis-now-cycles-queues-so-that-consuming-is-fair">Redis: Now cycles queues so that consuming is fair</a></li>
<li><a class="reference internal" href="#group-chord-chain-are-now-subtasks"><cite>group</cite>/<cite>chord</cite>/<cite>chain</cite> are now subtasks</a></li>
<li><a class="reference internal" href="#new-remote-control-commands">New remote control commands</a></li>
<li><a class="reference internal" href="#crontab-now-supports-day-of-month-and-month-of-year-arguments">Crontab now supports Day of Month, and Month of Year arguments</a></li>
<li><a class="reference internal" href="#immutable-subtasks">Immutable subtasks</a></li>
<li><a class="reference internal" href="#logging-improvements">Logging Improvements</a></li>
<li><a class="reference internal" href="#task-registry-no-longer-global">Task registry no longer global</a></li>
<li><a class="reference internal" href="#abstract-tasks-are-now-lazily-bound">Abstract tasks are now lazily bound</a></li>
<li><a class="reference internal" href="#lazy-task-decorators">Lazy task decorators</a></li>
<li><a class="reference internal" href="#smart-app-option">Smart <cite>--app</cite> option</a></li>
<li><a class="reference internal" href="#in-other-news">In Other News</a></li>
<li><a class="reference internal" href="#internals">Internals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#experimental">Experimental</a><ul>
<li><a class="reference internal" href="#celery-contrib-methods-task-decorator-for-methods"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery.contrib.methods</span></code>:  Task decorator for methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unscheduled-removals">Unscheduled Removals</a></li>
<li><a class="reference internal" href="#deprecation-time-line-changes">Deprecation Time-line Changes</a></li>
<li><a class="reference internal" href="#fixes">Fixes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8156d91f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>