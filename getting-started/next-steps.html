<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="资源" href="resources.html" /><link rel="prev" title="使用 Celery 的第一步" href="first-steps-with-celery.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>下一步 - Celery 5.5.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css?v=112ca36d" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Celery 5.5.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/celery_512_1.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Celery 5.5.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">版权</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">快速开始</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 快速开始</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Celery 简介</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="backends-and-brokers/index.html">Backends 和 Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Backends 和 Brokers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="backends-and-brokers/rabbitmq.html">使用 RabbitMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="backends-and-brokers/redis.html">使用 Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="backends-and-brokers/sqs.html">使用 Amazon SQS</a></li>
<li class="toctree-l3"><a class="reference internal" href="backends-and-brokers/kafka.html">使用 Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="backends-and-brokers/gcpubsub.html">使用 Google Pub/Sub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="first-steps-with-celery.html">使用 Celery 的第一步</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../userguide/index.html">用户指南</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 用户指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../userguide/application.html">应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/tasks.html">任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/calling.html">调用任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/canvas.html">Canvas：设计工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/workers.html">Workers 指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/daemonizing.html">守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/periodic-tasks.html">周期性任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/routing.html">路由任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/monitoring.html">监控和管理指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/optimizing.html">优化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/debugging.html">调试</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../userguide/concurrency/index.html">并发</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 并发</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/eventlet.html">Eventlet 并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="../userguide/concurrency/gevent.html">gevent 并发</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/signals.html">信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/testing.html">使用 Celery 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/extending.html">扩展 和 Bootsteps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/configuration.html">配置和默认值</a></li>
<li class="toctree-l2"><a class="reference internal" href="../userguide/sphinx.html">使用 Sphinx 文档化任务</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../django/index.html">Django</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Django</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../django/first-steps-with-django.html">使用 Django 的第一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">社区资源</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/task-cookbook.html">Task Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">更改历史</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API 参考</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API 参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">命令行接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code> --- Distributed processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html">Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.task.html"><code class="docutils literal notranslate"><span class="pre">celery.app.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html">AMQP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html#queues">Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.defaults.html"><code class="docutils literal notranslate"><span class="pre">celery.app.defaults</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.control.html"><code class="docutils literal notranslate"><span class="pre">celery.app.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.registry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.registry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.app.backends</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.builtins.html"><code class="docutils literal notranslate"><span class="pre">celery.app.builtins</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.events.html"><code class="docutils literal notranslate"><span class="pre">celery.app.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.log.html"><code class="docutils literal notranslate"><span class="pre">celery.app.log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.app.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.autoretry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.autoretry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bootsteps.html"><code class="docutils literal notranslate"><span class="pre">celery.bootsteps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.result.html"><code class="docutils literal notranslate"><span class="pre">celery.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.schedules.html"><code class="docutils literal notranslate"><span class="pre">celery.schedules</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.signals.html"><code class="docutils literal notranslate"><span class="pre">celery.signals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.security.html"><code class="docutils literal notranslate"><span class="pre">celery.security</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.utils.debug.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.debug</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.exceptions.html"><code class="docutils literal notranslate"><span class="pre">celery.exceptions</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.app.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.default.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.base.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html">States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#sets">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.FAILURE"><code class="docutils literal notranslate"><span class="pre">FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.PENDING"><code class="docutils literal notranslate"><span class="pre">PENDING</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RECEIVED"><code class="docutils literal notranslate"><span class="pre">RECEIVED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RETRY"><code class="docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.REVOKED"><code class="docutils literal notranslate"><span class="pre">REVOKED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.STARTED"><code class="docutils literal notranslate"><span class="pre">STARTED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.SUCCESS"><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.precedence"><code class="docutils literal notranslate"><span class="pre">precedence()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.abortable.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.django.task.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.django.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.pytest.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.pytest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.sphinx.html">celery.contrib.sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.app.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.manager.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.manager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.mocks.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.mocks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.rdb.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.html"><code class="docutils literal notranslate"><span class="pre">celery.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.receiver.html"><code class="docutils literal notranslate"><span class="pre">celery.events.receiver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.dispatcher.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.event.html"><code class="docutils literal notranslate"><span class="pre">celery.events.event</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.state.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.request.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.request</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.state.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.strategy.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.agent.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.connection.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.events.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.gossip.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.gossip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.heart.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.heart</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.mingle.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.mingle</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.tasks.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.tasks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.base.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.celery.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.celery</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.events.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.logtool.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.logtool</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.amqp.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.amqp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.graph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.call.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.call</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.control.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.list.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.list</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.purge.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.purge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.result.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.shell.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.shell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.upgrade.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.upgrade</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/index.html">内部</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/guide.html">代码贡献指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/deprecation.html">Celery 弃用时间表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/worker.html">内部的 worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/protocol.html">消息协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/app-overview.html">“大实例”重构</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../internals/reference/index.html">内部模块参考</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 内部模块参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.components.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.loops.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.loops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.heartbeat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.pidbox.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.pidbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.autoscale.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.autoscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.solo.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.solo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.eventlet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.gevent.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.gevent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.thread.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.base.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.backends</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.base.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.asynchronous.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.asynchronous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.azureblockblob.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.azureblockblob</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.rpc.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cache.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.consul.html">celery.backends.consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchdb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.mongodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.mongodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.elasticsearch.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.elasticsearch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.redis.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cassandra.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cassandra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchbase.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchbase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.arangodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.arangodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.dynamodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.dynamodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.filesystem.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.filesystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cosmosdbsql.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cosmosdbsql</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.s3.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.s3</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.gcs.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.gcs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.trace.html"><code class="docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.annotations.html"><code class="docutils literal notranslate"><span class="pre">celery.app.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.routes.html"><code class="docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.certificate.html"><code class="docutils literal notranslate"><span class="pre">celery.security.certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.key.html"><code class="docutils literal notranslate"><span class="pre">celery.security.key</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.security.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.security.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.snapshot.html"><code class="docutils literal notranslate"><span class="pre">celery.events.snapshot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.cursesmon.html"><code class="docutils literal notranslate"><span class="pre">celery.events.cursesmon</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.dumper.html"><code class="docutils literal notranslate"><span class="pre">celery.events.dumper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.models.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.session.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.session</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.abstract.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.abstract</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.collections.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.collections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.nodenames.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.nodenames</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.deprecated.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.deprecated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.functional.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.graph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.objects.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.term.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.term</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.time.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.iso8601.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.iso8601</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.saferepr.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.saferepr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.sysinfo.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.sysinfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.threads.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.timer2.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.timer2</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.imports.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.log.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.text.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch.signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.platforms.html"><code class="docutils literal notranslate"><span class="pre">celery.platforms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery._state.html"><code class="docutils literal notranslate"><span class="pre">celery._state</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../history/index.html">历史</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 历史</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.5.html">What's new in Celery 5.5 (Immunity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.5.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.4.html">What's new in Celery 5.4 (Opalescent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.3.html">What's new in Celery 5.3 (Emerald Rush)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.1.html">What's new in Celery 5.1 (Sun Harmonics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.0.html">What's new in Celery 5.0 (singularity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.4.html">What's new in Celery 4.4 (Cliffs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.3.html">What's new in Celery 4.3 (rhubarb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.2.html">What's new in Celery 4.2 (windowlicker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.2.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.1.html">What's new in Celery 4.1 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.0.html">What's new in Celery 4.0 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-3.1.html">What's new in Celery 3.1 (Cipater)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-3.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-3.0.html">What's new in Celery 3.0 (Chiastic Slide)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-3.0.html">Change history for Celery 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-2.5.html">What's new in Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.5.html">Change history for Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.4.html">Change history for Celery 2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.3.html">Change history for Celery 2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.2.html">Change history for Celery 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.1.html">Change history for Celery 2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.0.html">Change history for Celery 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-1.0.html">Change history for Celery 1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

</div>
<!-- <iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe> -->
<div id="donate">
  <h5>捐赠</h5>
  <p>请捐赠以支持这个社区项目</p>
  <a href="https://opencollective.com/celery/donate" target="_blank">
    <!-- <img src="https://opencollective.com/celery/donate/button@2x.png?color=blue" /> -->
    <img src="https://opencollective.com/celery/donate/button.png?color=blue" />
  </a>
</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/getting-started/next-steps.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="next-steps">
<span id="id1"></span><h1>下一步<a class="headerlink" href="#next-steps" title="Link to this heading">¶</a></h1>
<p>Next Steps</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="first-steps-with-celery.html#first-steps"><span class="std std-ref">使用 Celery 的第一步</span></a> 指南故意保持简洁。在本指南中，我将更详细地演示 Celery 的功能，包括如何为你的应用程序和库添加 Celery 支持。</p>
<p>本文档并未涵盖 Celery 的所有功能和最佳实践，因此建议你同时阅读 <a class="reference internal" href="../userguide/index.html#guide"><span class="std std-ref">User Guide</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>The <a class="reference internal" href="first-steps-with-celery.html#first-steps"><span class="std std-ref">使用 Celery 的第一步</span></a> guide is intentionally minimal. In this guide I'll demonstrate what Celery offers in more detail, including how to add Celery support for your application and library.</p>
<p>This document doesn't document all of Celery's features and best practices, so it's recommended that you also read the <a class="reference internal" href="../userguide/index.html#guide"><span class="std std-ref">User Guide</span></a></p>
</div>
</div>
<section id="celery">
<h2>在你的项目中使用Celery<a class="headerlink" href="#celery" title="Link to this heading">¶</a></h2>
<p>Using Celery in your Application</p>
<section id="project-layout">
<span id="id2"></span><h3>我们的项目<a class="headerlink" href="#project-layout" title="Link to this heading">¶</a></h3>
<p>Our Project</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>项目布局</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>src/
    proj/__init__.py
        /celery.py
        /tasks.py
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>Project layout</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>src/
    proj/__init__.py
        /celery.py
        /tasks.py
</pre></div>
</div>
</div>
</div>
<section id="proj-celery-py">
<h4><code class="file docutils literal notranslate"><span class="pre">proj/celery.py</span></code><a class="headerlink" href="#proj-celery-py" title="Link to this heading">¶</a></h4>
<p><code class="file docutils literal notranslate"><span class="pre">proj/celery.py</span></code></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;proj&#39;</span><span class="p">,</span>
             <span class="n">broker</span><span class="o">=</span><span class="s1">&#39;amqp://&#39;</span><span class="p">,</span>
             <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;rpc://&#39;</span><span class="p">,</span>
             <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;proj.tasks&#39;</span><span class="p">])</span>

<span class="c1"># Optional configuration, see the application user guide.</span>
<span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">result_expires</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>在本模块中，你创建了我们的 <a class="reference internal" href="../reference/celery.html#celery.Celery" title="celery.Celery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Celery</span></code></a> 实例（有时称为 <em>app</em>）。要在你的项目中使用 Celery，只需导入此实例。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">broker</span></code> 参数指定了要使用的代理的 URL。</p>
<p>请参阅 <a class="reference internal" href="first-steps-with-celery.html#celerytut-broker"><span class="std std-ref">选择 Broker</span></a> 获取更多信息。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">backend</span></code> 参数指定了要使用的结果后端。</p>
<p>它用于跟踪任务的状态和结果。虽然默认情况下禁用了结果，但这里我使用了 RPC 结果后端，因为稍后我将演示如何检索结果。你可能希望为你的应用程序使用不同的后端。不同的后端有各自的优缺点。如果你不需要结果，最好禁用它们。也可以通过设置 <code class="docutils literal notranslate"><span class="pre">&#64;task(ignore_result=True)</span></code> 选项来禁用个别任务的结果。</p>
<p>请参阅 <a class="reference internal" href="first-steps-with-celery.html#celerytut-keeping-results"><span class="std std-ref">保存结果</span></a> 获取更多信息。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">include</span></code> 参数是一个模块列表，当 worker 启动时会导入这些模块。你需要在这里添加我们的任务模块，以便 worker 能够找到我们的任务。</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">(</span><span class="s1">&#39;proj&#39;</span><span class="p">,</span>
             <span class="n">broker</span><span class="o">=</span><span class="s1">&#39;amqp://&#39;</span><span class="p">,</span>
             <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;rpc://&#39;</span><span class="p">,</span>
             <span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;proj.tasks&#39;</span><span class="p">])</span>

<span class="c1"># Optional configuration, see the application user guide.</span>
<span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">result_expires</span><span class="o">=</span><span class="mi">3600</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>In this module you created our <a class="reference internal" href="../reference/celery.html#celery.Celery" title="celery.Celery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Celery</span></code></a> instance (sometimes
referred to as the <em>app</em>). To use Celery within your project
you simply import this instance.</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">broker</span></code> argument specifies the URL of the broker to use.</p>
<p>See <a class="reference internal" href="first-steps-with-celery.html#celerytut-broker"><span class="std std-ref">选择 Broker</span></a> for more information.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">backend</span></code> argument specifies the result backend to use.</p>
<p>It's used to keep track of task state and results.
While results are disabled by default I use the RPC result backend here
because I demonstrate how retrieving results work later. You may want to use
a different backend for your application. They all have different
strengths and weaknesses. If you don't need results, it's better
to disable them. Results can also be disabled for individual tasks
by setting the <code class="docutils literal notranslate"><span class="pre">&#64;task(ignore_result=True)</span></code> option.</p>
<p>See <a class="reference internal" href="first-steps-with-celery.html#celerytut-keeping-results"><span class="std std-ref">保存结果</span></a> for more information.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">include</span></code> argument is a list of modules to import when</p></li>
</ul>
<p>the worker starts. You need to add our tasks module here so
that the worker is able to find our tasks.</p>
</div>
</div>
</section>
<section id="proj-tasks-py">
<h4><code class="file docutils literal notranslate"><span class="pre">proj/tasks.py</span></code><a class="headerlink" href="#proj-tasks-py" title="Link to this heading">¶</a></h4>
<p><code class="file docutils literal notranslate"><span class="pre">proj/tasks.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">xsum</span><span class="p">(</span><span class="n">numbers</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="worker">
<h3>启动 worker<a class="headerlink" href="#worker" title="Link to this heading">¶</a></h3>
<p>Starting the worker</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p><strong class="program">celery</strong> 程序可以用来启动工作进程（根据示例项目的目录结构，你需要在 <cite>proj</cite> 目录的上一级目录中运行工作进程，该目录是 <cite>src</cite>）：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<p>当工作进程启动时，你应该会看到一个横幅和一些消息：</p>
<blockquote>
<div><p>--------------- <a class="reference external" href="mailto:celery&#37;&#52;&#48;halcyon&#46;local">celery<span>&#64;</span>halcyon<span>&#46;</span>local</a> v4.0 (latentcall)
--- <strong>*</strong> -----
-- <strong>***</strong> ---- [Configuration]
- <strong>* --- * --- . broker:      amqp://guest&#64;localhost:5672//
- ** ---------- . app:         __main__:0x1012d8590
- ** ---------- . concurrency: 8 (processes)
- ** ---------- . events:      OFF (enable -E to monitor this worker)
- ** ----------
- *</strong> --- * --- [Queues]
-- <strong>***</strong> ---- . celery:      exchange:celery(direct) binding:celery
--- <strong>*</strong> -----</p>
<p>[2012-06-08 16:23:51,078: WARNING/MainProcess] <a class="reference external" href="mailto:celery&#37;&#52;&#48;halcyon&#46;local">celery<span>&#64;</span>halcyon<span>&#46;</span>local</a> 已启动。</p>
</div></blockquote>
<p>-- <em>broker</em> 是你在 <cite>celery</cite> 模块中通过 broker 参数指定的 URL。你也可以通过使用 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-b"><code class="xref std std-option docutils literal notranslate"><span class="pre">-b</span></code></a> 选项在命令行上指定不同的 broker。</p>
<p>-- <em>Concurrency</em> 是用于并发处理任务的预先生成的工作进程数量。当所有工作进程都忙于处理任务时，新的任务将需要等待其中一个任务完成后才能处理。</p>
<p>默认的并发数是该机器上 CPU 的数量（包括核心数）。你可以通过 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-c</span></code></a> 选项指定自定义的数量。没有推荐的值，因为最优数量取决于多种因素，但如果你的任务大部分是 I/O 密集型的，那么可以尝试增加并发数。实验表明，增加超过 CPU 数量的两倍通常并没有效果，反而可能导致性能下降。</p>
<p>除了默认的预生成进程池，Celery 还支持使用 Eventlet、Gevent 或单线程运行（参见 <a class="reference internal" href="../userguide/concurrency/index.html#concurrency"><span class="std std-ref">并发</span></a>）。</p>
<p>-- <em>Events</em> 是一个选项，允许 Celery 发送监控消息（事件），用于在工作进程中发生的操作。这些可以被监控程序如 <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">events</span></code> 和 Flower 使用——Flower 是一个实时的 Celery 监控工具，你可以在 <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">Monitoring and Management guide</span></a> 中了解更多。</p>
<p>-- <em>Queues</em> 是工作进程将消费任务的队列列表。你可以告诉工作进程从多个队列中消费任务，这可以用来将消息路由到特定的工作进程，以实现服务质量、关注点分离和优先级等目的，所有这些都在 <a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">Routing Guide</span></a> 中进行了描述。</p>
<p>你可以通过传入 <code class="xref std std-option docutils literal notranslate"><span class="pre">--help</span></code> 标志来获取完整的命令行参数列表：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>--help
</pre></div>
</div>
<p>这些选项在 <a class="reference internal" href="../userguide/workers.html#guide-workers"><span class="std std-ref">Workers Guide</span></a> 中有更详细的描述。</p>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>The <strong class="program">celery</strong> program can be used to start the worker (you need to run the worker in the directory above
<cite>proj</cite>, according to the example project layout the directory is <cite>src</cite>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<p>When the worker starts you should see a banner and some messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------</span> <span class="n">celery</span><span class="nd">@halcyon</span><span class="o">.</span><span class="n">local</span> <span class="n">v4</span><span class="mf">.0</span> <span class="p">(</span><span class="n">latentcall</span><span class="p">)</span>
<span class="o">---</span> <span class="o">*****</span> <span class="o">-----</span>
<span class="o">--</span> <span class="o">*******</span> <span class="o">----</span> <span class="p">[</span><span class="n">Configuration</span><span class="p">]</span>
<span class="o">-</span> <span class="o">***</span> <span class="o">---</span> <span class="o">*</span> <span class="o">---</span> <span class="o">.</span> <span class="n">broker</span><span class="p">:</span>      <span class="n">amqp</span><span class="p">:</span><span class="o">//</span><span class="n">guest</span><span class="nd">@localhost</span><span class="p">:</span><span class="mi">5672</span><span class="o">//</span>
<span class="o">-</span> <span class="o">**</span> <span class="o">----------</span> <span class="o">.</span> <span class="n">app</span><span class="p">:</span>         <span class="n">__main__</span><span class="p">:</span><span class="mh">0x1012d8590</span>
<span class="o">-</span> <span class="o">**</span> <span class="o">----------</span> <span class="o">.</span> <span class="n">concurrency</span><span class="p">:</span> <span class="mi">8</span> <span class="p">(</span><span class="n">processes</span><span class="p">)</span>
<span class="o">-</span> <span class="o">**</span> <span class="o">----------</span> <span class="o">.</span> <span class="n">events</span><span class="p">:</span>      <span class="n">OFF</span> <span class="p">(</span><span class="n">enable</span> <span class="o">-</span><span class="n">E</span> <span class="n">to</span> <span class="n">monitor</span> <span class="n">this</span> <span class="n">worker</span><span class="p">)</span>
<span class="o">-</span> <span class="o">**</span> <span class="o">----------</span>
<span class="o">-</span> <span class="o">***</span> <span class="o">---</span> <span class="o">*</span> <span class="o">---</span> <span class="p">[</span><span class="n">Queues</span><span class="p">]</span>
<span class="o">--</span> <span class="o">*******</span> <span class="o">----</span> <span class="o">.</span> <span class="n">celery</span><span class="p">:</span>      <span class="n">exchange</span><span class="p">:</span><span class="n">celery</span><span class="p">(</span><span class="n">direct</span><span class="p">)</span> <span class="n">binding</span><span class="p">:</span><span class="n">celery</span>
<span class="o">---</span> <span class="o">*****</span> <span class="o">-----</span>

<span class="p">[</span><span class="mi">2012</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">08</span> <span class="mi">16</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">51</span><span class="p">,</span><span class="mi">078</span><span class="p">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="n">celery</span><span class="nd">@halcyon</span><span class="o">.</span><span class="n">local</span> <span class="n">has</span> <span class="n">started</span><span class="o">.</span>
</pre></div>
</div>
<p>-- The <em>broker</em> is the URL you specified in the broker argument in our <code class="docutils literal notranslate"><span class="pre">celery</span></code>
module. You can also specify a different broker on the command-line by using
the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-b"><code class="xref std std-option docutils literal notranslate"><span class="pre">-b</span></code></a> option.</p>
<p>-- <em>Concurrency</em> is the number of prefork worker process used
to process your tasks concurrently. When all of these are busy doing work,
new tasks will have to wait for one of the tasks to finish before
it can be processed.</p>
<p>The default concurrency number is the number of CPU's on that machine
(including cores). You can specify a custom number using
the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-c"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-c</span></code></a> option.
There's no recommended value, as the optimal number depends on a number of
factors, but if your tasks are mostly I/O-bound then you can try to increase
it. Experimentation has shown that adding more than twice the number
of CPU's is rarely effective, and likely to degrade performance
instead.</p>
<p>Including the default prefork pool, Celery also supports using
Eventlet, Gevent, and running in a single thread (see <a class="reference internal" href="../userguide/concurrency/index.html#concurrency"><span class="std std-ref">并发</span></a>).</p>
<p>-- <em>Events</em> is an option that causes Celery to send
monitoring messages (events) for actions occurring in the worker.
These can be used by monitor programs like <code class="docutils literal notranslate"><span class="pre">celery</span> <span class="pre">events</span></code>,
and Flower -- the real-time Celery monitor, which you can read about in
the <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">Monitoring and Management guide</span></a>.</p>
<p>-- <em>Queues</em> is the list of queues that the worker will consume
tasks from. The worker can be told to consume from several queues
at once, and this is used to route messages to specific workers
as a means for Quality of Service, separation of concerns,
and prioritization, all described in the <a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">Routing Guide</span></a>.</p>
<p>You can get a complete list of command-line arguments
by passing in the <code class="xref std std-option docutils literal notranslate"><span class="pre">--help</span></code> flag:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>worker<span class="w"> </span>--help
</pre></div>
</div>
<p>These options are described in more detailed in the <a class="reference internal" href="../userguide/workers.html#guide-workers"><span class="std std-ref">Workers Guide</span></a>.</p>
</div>
</div>
<section id="id3">
<h4>停止 worker<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p>Stopping the worker</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>要停止 Worker，只需按下 <kbd class="kbd docutils literal notranslate">Control</kbd>-<kbd class="kbd docutils literal notranslate">c</kbd> 即可。Worker 支持的信号列表详见 <a class="reference internal" href="../userguide/workers.html#guide-workers"><span class="std std-ref">Worker 指南</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>To stop the worker simply hit <kbd class="kbd docutils literal notranslate">Control</kbd>-<kbd class="kbd docutils literal notranslate">c</kbd>. A list of signals supported by the worker is detailed in the <a class="reference internal" href="../userguide/workers.html#guide-workers"><span class="std std-ref">Workers Guide</span></a>.</p>
</div>
</div>
</section>
<section id="id4">
<h4>在后台<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<p>In the background</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>在生产环境中，你通常希望将工作进程在后台运行，详见 <a class="reference internal" href="../userguide/daemonizing.html#daemonizing"><span class="std std-ref">daemonization tutorial</span></a> 教程。</p>
<p>守护进程脚本使用 <strong class="program">celery multi</strong> 命令来在后台启动一个或多个工作进程：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Starting nodes...</span>
<span class="go">    &gt; w1.halcyon.local: OK</span>
</pre></div>
</div>
<p>你也可以重新启动它：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w">  </span>multi<span class="w"> </span>restart<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Stopping nodes...</span>
<span class="go">    &gt; w1.halcyon.local: TERM -&gt; 64024</span>
<span class="go">&gt; Waiting for 1 node.....</span>
<span class="go">    &gt; w1.halcyon.local: OK</span>
<span class="go">&gt; Restarting node w1.halcyon.local: OK</span>
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Stopping nodes...</span>
<span class="go">    &gt; w1.halcyon.local: TERM -&gt; 64052</span>
</pre></div>
</div>
<p>或者停止它：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>stop<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">stop</span></code> 命令是异步的，因此不会等待工作进程完全关闭。你可能更希望使用 <code class="docutils literal notranslate"><span class="pre">stopwait</span></code> 命令，它会确保所有当前正在执行的任务完成后才退出：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>stopwait<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong class="program">celery multi</strong> 并不会存储有关工作进程的信息，
所以你在重新启动时需要使用与之前相同的命令行参数。
只有停止时需要保证使用相同的 pidfile 和 logfile 参数。</p>
</div>
<p>默认情况下，它会在当前目录中创建 pid 文件和日志文件。
为了防止多个工作进程在彼此之上启动，建议你将这些文件
放置到一个专用目录中：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/run/celery
<span class="gp">$ </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/log/celery
<span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO<span class="w"> </span>--pidfile<span class="o">=</span>/var/run/celery/%n.pid<span class="w"> </span><span class="se">\</span>
<span class="w">                                        </span>--logfile<span class="o">=</span>/var/log/celery/%n%I.log
</pre></div>
</div>
<p>使用 multi 命令你可以启动多个工作进程，此外它还支持强大的命令行语法，用于为不同的工作进程指定不同参数，例如：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span><span class="m">10</span><span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO<span class="w"> </span>-Q:1-3<span class="w"> </span>images,video<span class="w"> </span>-Q:4,5<span class="w"> </span>data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Q<span class="w"> </span>default<span class="w"> </span>-L:4,5<span class="w"> </span>debug
</pre></div>
</div>
<p>更多示例请参见 API 参考中的 <a class="reference internal" href="../reference/celery.bin.multi.html#module-celery.bin.multi" title="celery.bin.multi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">multi</span></code></a> 模块。</p>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>In production you'll want to run the worker in the background,
described in detail in the <a class="reference internal" href="../userguide/daemonizing.html#daemonizing"><span class="std std-ref">daemonization tutorial</span></a>.</p>
<p>The daemonization scripts uses the <strong class="program">celery multi</strong> command to
start one or more workers in the background:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Starting nodes...</span>
<span class="go">    &gt; w1.halcyon.local: OK</span>
</pre></div>
</div>
<p>You can restart it too:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w">  </span>multi<span class="w"> </span>restart<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Stopping nodes...</span>
<span class="go">    &gt; w1.halcyon.local: TERM -&gt; 64024</span>
<span class="go">&gt; Waiting for 1 node.....</span>
<span class="go">    &gt; w1.halcyon.local: OK</span>
<span class="go">&gt; Restarting node w1.halcyon.local: OK</span>
<span class="go">celery multi v4.0.0 (latentcall)</span>
<span class="go">&gt; Stopping nodes...</span>
<span class="go">    &gt; w1.halcyon.local: TERM -&gt; 64052</span>
</pre></div>
</div>
<p>or stop it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>stop<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">stop</span></code> command is asynchronous so it won't wait for the
worker to shutdown. You'll probably want to use the <code class="docutils literal notranslate"><span class="pre">stopwait</span></code> command
instead, which ensures that all currently executing tasks are completed
before exiting:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>stopwait<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong class="program">celery multi</strong> doesn't store information about workers
so you need to use the same command-line arguments when
restarting. Only the same pidfile and logfile arguments must be
used when stopping.</p>
</div>
<p>By default it'll create pid and log files in the current directory.
To protect against multiple workers launching on top of each other
you're encouraged to put these in a dedicated directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/run/celery
<span class="gp">$ </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/log/celery
<span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span>w1<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO<span class="w"> </span>--pidfile<span class="o">=</span>/var/run/celery/%n.pid<span class="w"> </span><span class="se">\</span>
<span class="w">                                        </span>--logfile<span class="o">=</span>/var/log/celery/%n%I.log
</pre></div>
</div>
<p>With the multi command you can start multiple workers, and there's a powerful
command-line syntax to specify arguments for different workers too,
for example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>multi<span class="w"> </span>start<span class="w"> </span><span class="m">10</span><span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>-l<span class="w"> </span>INFO<span class="w"> </span>-Q:1-3<span class="w"> </span>images,video<span class="w"> </span>-Q:4,5<span class="w"> </span>data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-Q<span class="w"> </span>default<span class="w"> </span>-L:4,5<span class="w"> </span>debug
</pre></div>
</div>
<p>For more examples see the <a class="reference internal" href="../reference/celery.bin.multi.html#module-celery.bin.multi" title="celery.bin.multi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">multi</span></code></a> module in the API
reference.</p>
</div>
</div>
</section>
<section id="app">
<span id="app-argument"></span><h4>关于 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code></a> 参数<a class="headerlink" href="#app" title="Link to this heading">¶</a></h4>
<p>About the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code></a> argument</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code></a> 参数用于指定要使用的 Celery 应用实例，格式为 <code class="docutils literal notranslate"><span class="pre">module.path:attribute</span></code>。</p>
<p>但它也支持一种简写形式。如果只指定了包名，它会按以下顺序尝试查找 app 实例：</p>
<p>使用 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app=proj</span></code></a> 时：</p>
<ol class="arabic simple">
<li><p>查找名为 <code class="docutils literal notranslate"><span class="pre">proj.app</span></code> 的属性，或</p></li>
<li><p>查找名为 <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code> 的属性，或</p></li>
<li><p>查找模块 <code class="docutils literal notranslate"><span class="pre">proj</span></code> 中值为 Celery 应用的任意属性，或</p></li>
</ol>
<p>如果以上都未找到，它会尝试查找名为 <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code> 的子模块：</p>
<ol class="arabic simple" start="4">
<li><p>查找名为 <code class="docutils literal notranslate"><span class="pre">proj.celery.app</span></code> 的属性，或</p></li>
<li><p>查找名为 <code class="docutils literal notranslate"><span class="pre">proj.celery.celery</span></code> 的属性，或</p></li>
<li><p>查找模块 <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code> 中值为 Celery 应用的任意属性。</p></li>
</ol>
<p>该查找策略模仿了文档中所推荐的实践：即对于单一模块使用 <code class="docutils literal notranslate"><span class="pre">proj:app</span></code>，对于较大的项目则使用 <code class="docutils literal notranslate"><span class="pre">proj.celery:app</span></code>。</p>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>The <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code></a> argument specifies the Celery app instance
to use, in the form of <code class="docutils literal notranslate"><span class="pre">module.path:attribute</span></code></p>
<p>But it also supports a shortcut form. If only a package name is specified,
it'll try to search for the app instance, in the following order:</p>
<p>With <a class="reference internal" href="../reference/cli.html#cmdoption-celery-A"><code class="xref std std-option docutils literal notranslate"><span class="pre">--app=proj</span></code></a>:</p>
<ol class="arabic simple">
<li><p>an attribute named <code class="docutils literal notranslate"><span class="pre">proj.app</span></code>, or</p></li>
<li><p>an attribute named <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code>, or</p></li>
<li><p>any attribute in the module <code class="docutils literal notranslate"><span class="pre">proj</span></code> where the value is a Celery
application, or</p></li>
</ol>
<p>If none of these are found it'll try a submodule named <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code>:</p>
<ol class="arabic simple" start="4">
<li><p>an attribute named <code class="docutils literal notranslate"><span class="pre">proj.celery.app</span></code>, or</p></li>
<li><p>an attribute named <code class="docutils literal notranslate"><span class="pre">proj.celery.celery</span></code>, or</p></li>
<li><p>Any attribute in the module <code class="docutils literal notranslate"><span class="pre">proj.celery</span></code> where the value is a Celery
application.</p></li>
</ol>
<p>This scheme mimics the practices used in the documentation -- that is, <code class="docutils literal notranslate"><span class="pre">proj:app</span></code> for a single contained module, and <code class="docutils literal notranslate"><span class="pre">proj.celery:app</span></code> for larger projects.</p>
</div>
</div>
</section>
</section>
</section>
<section id="calling-tasks">
<span id="id5"></span><h2>调用任务<a class="headerlink" href="#calling-tasks" title="Link to this heading">¶</a></h2>
<p>Calling Tasks</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p>你可以使用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">delay()</span></code> 方法调用任务：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>该方法实际上是另一个方法 <code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_async()</span></code> 的星号参数快捷方式：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>后者允许你指定执行选项，例如执行延迟时间（countdown）、发送到的队列等：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">queue</span><span class="o">=</span><span class="s1">&#39;lopri&#39;</span><span class="p">,</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>上述示例中，该任务将被发送到名为 <code class="docutils literal notranslate"><span class="pre">lopri</span></code> 的队列，并且最早在消息发送后 10 秒被执行。</p>
<p>直接调用任务将会在当前进程中执行任务，不会发送消息：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>这三个方法 —— <code class="xref py py-meth docutils literal notranslate"><span class="pre">delay()</span></code>、<code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_async()</span></code> 以及直接调用（<code class="docutils literal notranslate"><span class="pre">__call__</span></code>）构成了 Celery 的调用 API，该 API 同样用于生成任务签名。</p>
<p>关于调用 API 的更详细说明，请参阅 <a class="reference internal" href="../userguide/calling.html#guide-calling"><span class="std std-ref">Calling User Guide</span></a>。</p>
<p>每次任务调用都会被赋予一个唯一标识符（UUID）—— 这就是任务 ID。</p>
<p><code class="docutils literal notranslate"><span class="pre">delay</span></code> 和 <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> 方法会返回一个 <a class="reference internal" href="../reference/celery.result.html#celery.result.AsyncResult" title="celery.result.AsyncResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncResult</span></code></a> 实例，可用于追踪任务的执行状态。但为此你需要启用 <a class="reference internal" href="../userguide/tasks.html#task-result-backends"><span class="std std-ref">结果后端</span></a>，以便有地方存储任务状态。</p>
<p>默认情况下结果功能是禁用的，因为并没有一个适用于所有应用的结果后端；你需要权衡每种后端的缺点来选择是否启用。对于许多任务而言，保存返回值其实并不重要，因此将其默认禁用是合理的选择。此外请注意，结果后端不会用于任务或工作进程的监控：Celery 为此使用专用的事件消息（参见 <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">监控和管理指南</span></a>）。</p>
<p>如果你已配置了结果后端，可以检索任务的返回值：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>你可以通过 <code class="xref py py-attr docutils literal notranslate"><span class="pre">id</span></code> 属性查看任务的 ID：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">id</span>
<span class="go">d6b3aea2-fb9b-4ebc-8da4-848818db9114</span>
</pre></div>
</div>
<p>如果任务抛出异常，你也可以检查异常及其回溯信息，事实上 <code class="docutils literal notranslate"><span class="pre">result.get()</span></code> 默认会传播任何错误：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">221</span><span class="p">,</span> <span class="ow">in</span> <span class="n">get</span>
<span class="w">    </span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">wait_for_pending</span><span class="p">(</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/backends/asynchronous.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">195</span><span class="p">,</span> <span class="ow">in</span> <span class="n">wait_for_pending</span>
<span class="w">    </span>    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">maybe_throw</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="n">propagate</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">333</span><span class="p">,</span> <span class="ow">in</span> <span class="n">maybe_throw</span>
<span class="w">    </span>    <span class="bp">self</span><span class="o">.</span><span class="n">throw</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remote_traceback</span><span class="p">(</span><span class="n">tb</span><span class="p">))</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">326</span><span class="p">,</span> <span class="ow">in</span> <span class="n">throw</span>
<span class="w">    </span>    <span class="bp">self</span><span class="o">.</span><span class="n">on_ready</span><span class="o">.</span><span class="n">throw</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;vine/promises.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">244</span><span class="p">,</span> <span class="ow">in</span> <span class="n">throw</span>
<span class="w">    </span>    <span class="n">reraise</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">),</span> <span class="n">exc</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;vine/five.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">195</span><span class="p">,</span> <span class="ow">in</span> <span class="n">reraise</span>
<span class="w">    </span>    <span class="k">raise</span> <span class="n">value</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;</span>
</pre></div>
</div>
<p>如果你不希望错误被传播，可以通过传入 <code class="docutils literal notranslate"><span class="pre">propagate</span></code> 参数来关闭它：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">propagate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">TypeError(&quot;unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;&quot;)</span>
</pre></div>
</div>
<p>在这种情况下，它将返回所抛出的异常实例 —— 因此若要判断任务是否成功或失败，你需要使用结果实例上的对应方法：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">failed</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>那它是如何判断任务是否失败的呢？这取决于任务的 <em>状态</em>：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">state</span>
<span class="go">&#39;FAILURE&#39;</span>
</pre></div>
</div>
<p>一个任务在任意时刻只能处于一个状态，但它可能会经历多个状态。一个典型任务的状态流程可能如下所示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PENDING</span> <span class="o">-&gt;</span> <span class="n">STARTED</span> <span class="o">-&gt;</span> <span class="n">SUCCESS</span>
</pre></div>
</div>
<p><cite>STARTED</cite> 状态是一种特殊状态，只有在启用了 <a class="reference internal" href="../userguide/configuration.html#std-setting-task_track_started"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_track_started</span></code></a> 设置，或任务设置了 <code class="docutils literal notranslate"><span class="pre">&#64;task(track_started=True)</span></code> 时才会被记录。</p>
<p><cite>PENDING</cite> 状态实际上并不是一个已记录的状态，而是任何未知任务 ID 的默认状态。你可以通过下面的示例看到：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AsyncResult</span><span class="p">(</span><span class="s1">&#39;this-id-does-not-exist&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">state</span>
<span class="go">&#39;PENDING&#39;</span>
</pre></div>
</div>
<p>如果任务被重试，状态流程会更复杂一些。例如某个任务重试了两次，其状态流程可能如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PENDING -&gt; STARTED -&gt; RETRY -&gt; STARTED -&gt; RETRY -&gt; STARTED -&gt; SUCCESS
</pre></div>
</div>
<p>关于任务状态的更多内容请参考任务用户指南中的 <a class="reference internal" href="../userguide/tasks.html#task-states"><span class="std std-ref">状态</span></a> 一节。</p>
<p>任务调用的详细说明请参阅 <a class="reference internal" href="../userguide/calling.html#guide-calling"><span class="std std-ref">Calling Guide</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p>You can call a task using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">delay()</span></code> method:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This method is actually a star-argument shortcut to another method called
<code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_async()</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>The latter enables you to specify execution options like the time to run
(countdown), the queue it should be sent to, and so on:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">queue</span><span class="o">=</span><span class="s1">&#39;lopri&#39;</span><span class="p">,</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above example the task will be sent to a queue named <code class="docutils literal notranslate"><span class="pre">lopri</span></code> and the
task will execute, at the earliest, 10 seconds after the message was sent.</p>
<p>Applying the task directly will execute the task in the current process,
so that no message is sent:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>These three methods - <code class="xref py py-meth docutils literal notranslate"><span class="pre">delay()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">apply_async()</span></code>, and applying
(<code class="docutils literal notranslate"><span class="pre">__call__</span></code>), make up the Celery calling API, which is also used for
signatures.</p>
<p>A more detailed overview of the Calling API can be found in the
<a class="reference internal" href="../userguide/calling.html#guide-calling"><span class="std std-ref">Calling User Guide</span></a>.</p>
<p>Every task invocation will be given a unique identifier (an UUID) -- this
is the task id.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">delay</span></code> and <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> methods return an <a class="reference internal" href="../reference/celery.result.html#celery.result.AsyncResult" title="celery.result.AsyncResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncResult</span></code></a>
instance, which can be used to keep track of the tasks execution state.
But for this you need to enable a <a class="reference internal" href="../userguide/tasks.html#task-result-backends"><span class="std std-ref">result backend</span></a> so that
the state can be stored somewhere.</p>
<p>Results are disabled by default because there is no result
backend that suits every application; to choose one you need to consider
the drawbacks of each individual backend. For many tasks
keeping the return value isn't even very useful, so it's a sensible default to
have. Also note that result backends aren't used for monitoring tasks and workers:
for that Celery uses dedicated event messages (see <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">监控和管理指南</span></a>).</p>
<p>If you have a result backend configured you can retrieve the return
value of a task:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>You can find the task's id by looking at the <code class="xref py py-attr docutils literal notranslate"><span class="pre">id</span></code> attribute:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">id</span>
<span class="go">d6b3aea2-fb9b-4ebc-8da4-848818db9114</span>
</pre></div>
</div>
<p>You can also inspect the exception and traceback if the task raised an
exception, in fact <code class="docutils literal notranslate"><span class="pre">result.get()</span></code> will propagate any errors by default:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">221</span><span class="p">,</span> <span class="ow">in</span> <span class="n">get</span>
<span class="w">    </span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">wait_for_pending</span><span class="p">(</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/backends/asynchronous.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">195</span><span class="p">,</span> <span class="ow">in</span> <span class="n">wait_for_pending</span>
<span class="w">    </span>    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">maybe_throw</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span> <span class="n">propagate</span><span class="o">=</span><span class="n">propagate</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">333</span><span class="p">,</span> <span class="ow">in</span> <span class="n">maybe_throw</span>
<span class="w">    </span>    <span class="bp">self</span><span class="o">.</span><span class="n">throw</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_remote_traceback</span><span class="p">(</span><span class="n">tb</span><span class="p">))</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;celery/result.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">326</span><span class="p">,</span> <span class="ow">in</span> <span class="n">throw</span>
<span class="w">    </span>    <span class="bp">self</span><span class="o">.</span><span class="n">on_ready</span><span class="o">.</span><span class="n">throw</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;vine/promises.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">244</span><span class="p">,</span> <span class="ow">in</span> <span class="n">throw</span>
<span class="w">    </span>    <span class="n">reraise</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exc</span><span class="p">),</span> <span class="n">exc</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span>
<span class="w">    </span><span class="n">File</span> <span class="s2">&quot;vine/five.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">195</span><span class="p">,</span> <span class="ow">in</span> <span class="n">reraise</span>
<span class="w">    </span>    <span class="k">raise</span> <span class="n">value</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;</span>
</pre></div>
</div>
<p>If you don't wish for the errors to propagate, you can disable that by passing <code class="docutils literal notranslate"><span class="pre">propagate</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">propagate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">TypeError(&quot;unsupported operand type(s) for +: &#39;int&#39; and &#39;str&#39;&quot;)</span>
</pre></div>
</div>
<p>In this case it'll return the exception instance raised instead --
so to check whether the task succeeded or failed, you'll have to
use the corresponding methods on the result instance:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">failed</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>So how does it know if the task has failed or not?  It can find out by looking
at the tasks <em>state</em>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">state</span>
<span class="go">&#39;FAILURE&#39;</span>
</pre></div>
</div>
<p>A task can only be in a single state, but it can progress through several
states. The stages of a typical task can be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PENDING</span> <span class="o">-&gt;</span> <span class="n">STARTED</span> <span class="o">-&gt;</span> <span class="n">SUCCESS</span>
</pre></div>
</div>
<p>The started state is a special state that's only recorded if the
<a class="reference internal" href="../userguide/configuration.html#std-setting-task_track_started"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_track_started</span></code></a> setting is enabled, or if the
<code class="docutils literal notranslate"><span class="pre">&#64;task(track_started=True)</span></code> option is set for the task.</p>
<p>The pending state is actually not a recorded state, but rather
the default state for any task id that's unknown: this you can see
from this example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AsyncResult</span><span class="p">(</span><span class="s1">&#39;this-id-does-not-exist&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">state</span>
<span class="go">&#39;PENDING&#39;</span>
</pre></div>
</div>
<p>If the task is retried the stages can become even more complex.
To demonstrate, for a task that's retried two times the stages would be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PENDING -&gt; STARTED -&gt; RETRY -&gt; STARTED -&gt; RETRY -&gt; STARTED -&gt; SUCCESS
</pre></div>
</div>
<p>To read more about task states you should see the <a class="reference internal" href="../userguide/tasks.html#task-states"><span class="std std-ref">状态</span></a> section
in the tasks user guide.</p>
<p>Calling tasks is described in detail in the <a class="reference internal" href="../userguide/calling.html#guide-calling"><span class="std std-ref">Calling Guide</span></a>.</p>
</div>
</div>
</section>
<section id="canvas">
<span id="designing-workflows"></span><h2><em>Canvas</em>: 设计工作流<a class="headerlink" href="#canvas" title="Link to this heading">¶</a></h2>
<p><em>Canvas</em>: Designing Work-flows</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>你刚刚学习了如何使用任务的 <code class="docutils literal notranslate"><span class="pre">delay</span></code> 方法调用任务，而这通常就已经足够了。但有时你可能希望将某个任务调用的签名传递给另一个进程，或作为参数传递给另一个函数，Celery 为此引入了 <em>签名（signatures）</em> 的概念。</p>
<p>签名会将任务调用的参数与执行选项打包，使其可以被传递给函数，甚至被序列化并通过网络发送。</p>
<p>你可以为 <code class="docutils literal notranslate"><span class="pre">add</span></code> 任务创建一个包含参数 <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code> 且延迟 10 秒执行的签名，如下所示：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">signature</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">tasks.add(2, 2)</span>
</pre></div>
</div>
<p>也可以使用星号参数的快捷形式：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">tasks.add(2, 2)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>You just learned how to call a task using the tasks <code class="docutils literal notranslate"><span class="pre">delay</span></code> method,
and this is often all you need. But sometimes you may want to pass the
signature of a task invocation to another process or as an argument to another
function, for which Celery uses something called <em>signatures</em>.</p>
<p>A signature wraps the arguments and execution options of a single task
invocation in such a way that it can be passed to functions or even serialized
and sent across the wire.</p>
<p>You can create a signature for the <code class="docutils literal notranslate"><span class="pre">add</span></code> task using the arguments <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>,
and a countdown of 10 seconds like this:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">signature</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">tasks.add(2, 2)</span>
</pre></div>
</div>
<p>There's also a shortcut using star arguments:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">tasks.add(2, 2)</span>
</pre></div>
</div>
</div>
</div>
<section id="api">
<h3>并且再次调用 API …<a class="headerlink" href="#api" title="Link to this heading">¶</a></h3>
<p>And there's that calling API again…</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>签名实例同样支持调用 API，也就是说它们拥有 <code class="docutils literal notranslate"><span class="pre">delay</span></code> 和 <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> 方法。</p>
<p>但它们与任务直接调用的不同之处在于：签名可能已经预先指定了一些参数。比如，<code class="docutils literal notranslate"><span class="pre">add</span></code> 任务需要两个参数，因此若签名中已指定两个参数，这将构成一个完整签名：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>当然，你也可以构造不完整的签名，即所谓的 <em>部分签名（partials）</em>：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go"># 不完整的部分签名：add(?, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">s2</span></code> 现在是一个仍需要另一个参数的部分签名，可以在调用该签名时再补充参数：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go"># 补全部分签名：add(8, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>上例中你添加了参数 8，它会被追加到已有的参数 2 前，构成完整签名 <code class="docutils literal notranslate"><span class="pre">add(8,</span> <span class="pre">2)</span></code>。</p>
<p>关键字参数也可以在后续添加；这些关键字参数会与已有的参数合并，但新添加的参数具有优先权：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># debug 现在是 False。</span>
</pre></div>
</div>
<p>如前所述，签名支持调用 API，这意味着你可以使用：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sig.apply_async(args=(),</span> <span class="pre">kwargs={},</span> <span class="pre">**options)</span></code></p>
<p>调用签名，同时可以附带部分位置参数与关键字参数，也支持传递执行选项。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sig.delay(*args,</span> <span class="pre">**kwargs)</span></code></p>
<p>是 <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> 的星号参数版本。传入的位置参数会被添加到签名原有的位置参数前，关键字参数会合并到签名中已有的关键字参数中（后者优先级低）。</p>
</li>
</ul>
<p>这一切看起来都很有用，那么你究竟可以用这些做什么呢？
为了理解这个问题，我们需要引入 <em>canvas 原语（canvas primitives）</em> ……</p>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>Signature instances also support the calling API, meaning they
have <code class="docutils literal notranslate"><span class="pre">delay</span></code> and <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> methods.</p>
<p>But there's a difference in that the signature may already have
an argument signature specified. The <code class="docutils literal notranslate"><span class="pre">add</span></code> task takes two arguments,
so a signature specifying two arguments would make a complete signature:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>But, you can also make incomplete signatures to create what we call
<em>partials</em>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go"># incomplete partial: add(?, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">s2</span></code> is now a partial signature that needs another argument to be complete,
and this can be resolved when calling the signature:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go"># resolves the partial: add(8, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Here you added the argument 8 that was prepended to the existing argument 2
forming a complete signature of <code class="docutils literal notranslate"><span class="pre">add(8,</span> <span class="pre">2)</span></code>.</p>
<p>Keyword arguments can also be added later; these are then merged with any
existing keyword arguments, but with new arguments taking precedence:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># debug is now False.</span>
</pre></div>
</div>
<p>As stated, signatures support the calling API: meaning that</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sig.apply_async(args=(),</span> <span class="pre">kwargs={},</span> <span class="pre">**options)</span></code></p>
<blockquote>
<div><p>Calls the signature with optional partial arguments and partial
keyword arguments. Also supports partial execution options.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">sig.delay(*args,</span> <span class="pre">**kwargs)</span></code></p>
<p>Star argument version of <code class="docutils literal notranslate"><span class="pre">apply_async</span></code>. Any arguments will be prepended
to the arguments in the signature, and keyword arguments is merged with any
existing keys.</p>
</li>
</ul>
<p>So this all seems very useful, but what can you actually do with these?
To get to that I must introduce the canvas primitives…</p>
</div>
</div>
</section>
<section id="id6">
<h3>原语<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>The Primitives</p>
<aside class="topic">
<p class="topic-title"></p>
<table class="hlist"><tr><td><ul class="simple">
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-group"><span class="std std-ref">group</span></a></p></li>
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-chain"><span class="std std-ref">chain</span></a></p></li>
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-chord"><span class="std std-ref">chord</span></a></p></li>
</ul>
</td><td><ul class="simple">
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-map"><span class="std std-ref">map</span></a></p></li>
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-map"><span class="std std-ref">starmap</span></a></p></li>
<li><p><a class="reference internal" href="../userguide/canvas.html#canvas-chunks"><span class="std std-ref">chunks</span></a></p></li>
</ul>
</td></tr></table>
</aside>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<p>这些原语（primitive）本身就是签名对象，因此它们可以以任意方式组合，用于构建复杂的工作流。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>以下示例包含结果的获取操作，因此若要尝试它们，你需要配置结果后端（result backend）。
上方提供的示例项目已经完成了此配置（参见传递给 <a class="reference internal" href="../reference/celery.html#celery.Celery" title="celery.Celery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Celery</span></code></a> 的 <code class="docutils literal notranslate"><span class="pre">backend</span></code> 参数）。</p>
</div>
<p>让我们来看几个示例：</p>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<p>These primitives are signature objects themselves, so they can be combined
in any number of ways to compose complex work-flows.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>These examples retrieve results, so to try them out you need
to configure a result backend. The example project
above already does that (see the backend argument to <a class="reference internal" href="../reference/celery.html#celery.Celery" title="celery.Celery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Celery</span></code></a>).</p>
</div>
<p>Let's look at some examples:</p>
</div>
</div>
<section id="id7">
<h4>组式任务<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<p>Groups</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<p>一个 <a class="reference internal" href="../reference/celery.html#celery.group" title="celery.group"><code class="xref py py-class docutils literal notranslate"><span class="pre">group</span></code></a> 会并行调用一组任务，并返回一个特殊的结果实例，
该实例允许你以组的形式检查结果，并按顺序获取返回值。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>部分 group 调用（Partial group）</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">[10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<p>A <a class="reference internal" href="../reference/celery.html#celery.group" title="celery.group"><code class="xref py py-class docutils literal notranslate"><span class="pre">group</span></code></a> calls a list of tasks in parallel,
and it returns a special result instance that lets you inspect the results
as a group, and retrieve the return values in order.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">group</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Partial group</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">[10, 11, 12, 13, 14, 15, 16, 17, 18, 19]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4>链式任务<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<p>Chains</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">中文</label><div class="tab-content docutils container">
<p>任务可以链接在一起，使得一个任务返回后，另一个任务被调用:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">mul</span>

<span class="go"># (4 + 4) * 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
<p>或者是部分链式任务:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># (? + 4) * 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
<p>链式任务也可以像这样书写：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">英文</label><div class="tab-content docutils container">
<p>Tasks can be linked together so that after one task returns the other
is called:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">mul</span>

<span class="go"># (4 + 4) * 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
<p>or a partial chain:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># (? + 4) * 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
<p>Chains can also be written like this:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">mul</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="mi">8</span><span class="p">))()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">64</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h4>合集任务<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<p>Chords</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">中文</label><div class="tab-content docutils container">
<p>合集任务是一个带回调的任务组:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">xsum</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">chord</span><span class="p">((</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">90</span>
</pre></div>
</div>
<p>一个任务组链接到另一个任务时，会自动转换为合集任务：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">|</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">90</span>
</pre></div>
</div>
<p>由于这些原语都是签名类型，因此几乎可以随意组合，例如：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">upload_document</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">|</span> <span class="n">group</span><span class="p">(</span><span class="n">apply_filter</span><span class="o">.</span><span class="n">s</span><span class="p">()</span> <span class="k">for</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">)</span>
</pre></div>
</div>
<p>请务必在 <a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas</span></a> 用户指南中阅读更多关于工作流的信息。</p>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">英文</label><div class="tab-content docutils container">
<p>A chord is a group with a callback:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">chord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">xsum</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">chord</span><span class="p">((</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">90</span>
</pre></div>
</div>
<p>A group chained to another task will be automatically converted
to a chord:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">group</span><span class="p">(</span><span class="n">add</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">|</span> <span class="n">xsum</span><span class="o">.</span><span class="n">s</span><span class="p">())()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">90</span>
</pre></div>
</div>
<p>Since these primitives are all of the signature type they
can be combined almost however you want, for example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">upload_document</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">|</span> <span class="n">group</span><span class="p">(</span><span class="n">apply_filter</span><span class="o">.</span><span class="n">s</span><span class="p">()</span> <span class="k">for</span> <span class="nb">filter</span> <span class="ow">in</span> <span class="n">filters</span><span class="p">)</span>
</pre></div>
</div>
<p>Be sure to read more about work-flows in the <a class="reference internal" href="../userguide/canvas.html#guide-canvas"><span class="std std-ref">Canvas</span></a> user
guide.</p>
</div>
</div>
</section>
</section>
</section>
<section id="id10">
<h2>路由<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<p>Routing</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">中文</label><div class="tab-content docutils container">
<p>Celery 支持 AMQP 提供的全部路由功能，
同时也支持简单的路由机制，即将消息发送到具名队列中。</p>
<p>通过 <a class="reference internal" href="../userguide/configuration.html#std-setting-task_routes"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_routes</span></code></a> 配置项，你可以按任务名称进行路由，
从而将所有路由配置集中管理：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">task_routes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;proj.tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;queue&#39;</span><span class="p">:</span> <span class="s1">&#39;hipri&#39;</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>你也可以在运行时通过 <code class="docutils literal notranslate"><span class="pre">apply_async</span></code> 的 <code class="docutils literal notranslate"><span class="pre">queue</span></code> 参数来指定队列：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">queue</span><span class="o">=</span><span class="s1">&#39;hipri&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>然后你可以通过 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a> 选项让某个 worker 从该队列中消费任务：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-Q<span class="w"> </span>hipri
</pre></div>
</div>
<p>你可以通过逗号分隔的列表指定多个队列。
例如，你可以让 worker 同时消费默认队列和 <code class="docutils literal notranslate"><span class="pre">hipri</span></code> 队列，
其中默认队列因历史原因被命名为 <code class="docutils literal notranslate"><span class="pre">celery</span></code>：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-Q<span class="w"> </span>hipri,celery
</pre></div>
</div>
<p>队列的顺序无关紧要，worker 会给予所有队列相同的权重。</p>
<p>如需了解更多关于路由的内容，包括如何充分利用 AMQP 的路由能力，
请参阅 <a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">路由指南</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">英文</label><div class="tab-content docutils container">
<p>Celery supports all of the routing facilities provided by AMQP,
but it also supports simple routing where messages are sent to named queues.</p>
<p>The <a class="reference internal" href="../userguide/configuration.html#std-setting-task_routes"><code class="xref std std-setting docutils literal notranslate"><span class="pre">task_routes</span></code></a> setting enables you to route tasks by name
and keep everything centralized in one location:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="n">task_routes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;proj.tasks.add&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;queue&#39;</span><span class="p">:</span> <span class="s1">&#39;hipri&#39;</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can also specify the queue at runtime
with the <code class="docutils literal notranslate"><span class="pre">queue</span></code> argument to <code class="docutils literal notranslate"><span class="pre">apply_async</span></code>:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">proj.tasks</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add</span><span class="o">.</span><span class="n">apply_async</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">queue</span><span class="o">=</span><span class="s1">&#39;hipri&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then make a worker consume from this queue by
specifying the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a> option:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-Q<span class="w"> </span>hipri
</pre></div>
</div>
<p>You may specify multiple queues by using a comma-separated list.
For example, you can make the worker consume from both the default
queue and the <code class="docutils literal notranslate"><span class="pre">hipri</span></code> queue, where
the default queue is named <code class="docutils literal notranslate"><span class="pre">celery</span></code> for historical reasons:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>worker<span class="w"> </span>-Q<span class="w"> </span>hipri,celery
</pre></div>
</div>
<p>The order of the queues doesn't matter as the worker will
give equal weight to the queues.</p>
<p>To learn more about routing, including taking use of the full
power of AMQP routing, see the <a class="reference internal" href="../userguide/routing.html#guide-routing"><span class="std std-ref">Routing Guide</span></a>.</p>
</div>
</div>
</section>
<section id="id11">
<h2>远程控制<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h2>
<p>Remote Control</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">中文</label><div class="tab-content docutils container">
<p>如果你使用的是 RabbitMQ（AMQP）、Redis 或 Qpid 作为 broker，
那么你可以在运行时对 worker 进行控制与检查。</p>
<p>例如，你可以查看某个 worker 当前正在处理的任务：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>active
</pre></div>
</div>
<p>这是通过广播消息实现的，因此集群中的所有 worker 都会接收到远程控制指令。</p>
<p>你也可以通过 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-inspect-d"><code class="xref std std-option docutils literal notranslate"><span class="pre">--destination</span></code></a> 参数指定一个或多个 worker 来执行请求。
该参数接受一个以逗号分隔的 worker 主机名列表：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>active<span class="w"> </span>--destination<span class="o">=</span>celery@example.com
</pre></div>
</div>
<p>如果未指定 destination，则每个 worker 都会响应请求。</p>
<p><strong class="program">celery inspect</strong> 命令包含的操作不会改变 worker 的任何状态；
它只会返回 worker 内部正在运行的情况和相关统计信息。
你可以通过以下方式查看所有可用的 inspect 命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>--help
</pre></div>
</div>
<p>另一个命令是 <strong class="program">celery control</strong>，该命令包含可在运行时改变 worker 行为的操作：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>--help
</pre></div>
</div>
<p>例如，你可以强制 worker 启用事件消息（event messages），用于监控任务和 worker：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>enable_events
</pre></div>
</div>
<p>启用事件后，你可以启动事件转储器（event dumper），查看 worker 正在执行的操作：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>events<span class="w"> </span>--dump
</pre></div>
</div>
<p>或者你可以启动基于 curses 的图形界面：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>events
</pre></div>
</div>
<p>当你完成监控后，可以通过以下命令再次关闭事件收集：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>disable_events
</pre></div>
</div>
<p><strong class="program">celery status</strong> 命令同样使用远程控制指令，
用于显示当前集群中处于在线状态的 worker 列表：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>status
</pre></div>
</div>
<p>你可以在 <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">监控指南</span></a> 中阅读更多关于 <strong class="program">celery</strong> 命令和监控的内容。</p>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">英文</label><div class="tab-content docutils container">
<p>If you're using RabbitMQ (AMQP), Redis, or Qpid as the broker then
you can control and inspect the worker at runtime.</p>
<p>For example you can see what tasks the worker is currently working on:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>active
</pre></div>
</div>
<p>This is implemented by using broadcast messaging, so all remote
control commands are received by every worker in the cluster.</p>
<p>You can also specify one or more workers to act on the request
using the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-inspect-d"><code class="xref std std-option docutils literal notranslate"><span class="pre">--destination</span></code></a> option.
This is a comma-separated list of worker host names:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>active<span class="w"> </span>--destination<span class="o">=</span>celery@example.com
</pre></div>
</div>
<p>If a destination isn't provided then every worker will act and reply
to the request.</p>
<p>The <strong class="program">celery inspect</strong> command contains commands that
don't change anything in the worker; it only returns information
and statistics about what's going on inside the worker.
For a list of inspect commands you can execute:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>inspect<span class="w"> </span>--help
</pre></div>
</div>
<p>Then there's the <strong class="program">celery control</strong> command, which contains
commands that actually change things in the worker at runtime:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>--help
</pre></div>
</div>
<p>For example you can force workers to enable event messages (used
for monitoring tasks and workers):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>enable_events
</pre></div>
</div>
<p>When events are enabled you can then start the event dumper
to see what the workers are doing:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>events<span class="w"> </span>--dump
</pre></div>
</div>
<p>or you can start the curses interface:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>events
</pre></div>
</div>
<p>when you're finished monitoring you can disable events again:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>control<span class="w"> </span>disable_events
</pre></div>
</div>
<p>The <strong class="program">celery status</strong> command also uses remote control commands
and shows a list of online workers in the cluster:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>celery<span class="w"> </span>-A<span class="w"> </span>proj<span class="w"> </span>status
</pre></div>
</div>
<p>You can read more about the <strong class="program">celery</strong> command and monitoring
in the <a class="reference internal" href="../userguide/monitoring.html#guide-monitoring"><span class="std std-ref">Monitoring Guide</span></a>.</p>
</div>
</div>
</section>
<section id="id12">
<h2>时区<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h2>
<p>Timezone</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">中文</label><div class="tab-content docutils container">
<p>所有时间和日期在内部以及消息中都使用 UTC 时区。</p>
<p>当 worker 接收到消息（例如带有倒计时参数的任务）时，
会将该 UTC 时间转换为本地时间。
如果你希望使用不同于系统默认的时区，
则需要通过 <a class="reference internal" href="../userguide/configuration.html#std-setting-timezone"><code class="xref std std-setting docutils literal notranslate"><span class="pre">timezone</span></code></a> 配置项进行设置：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="s1">&#39;Europe/London&#39;</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">英文</label><div class="tab-content docutils container">
<p>All times and dates, internally and in messages use the UTC timezone.</p>
<p>When the worker receives a message, for example with a countdown set it
converts that UTC time to local time. If you wish to use
a different timezone than the system timezone then you must
configure that using the <a class="reference internal" href="../userguide/configuration.html#std-setting-timezone"><code class="xref std std-setting docutils literal notranslate"><span class="pre">timezone</span></code></a> setting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="s1">&#39;Europe/London&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h2>优化<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h2>
<p>Optimization</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">中文</label><div class="tab-content docutils container">
<p>默认配置并未针对吞吐量进行优化。默认情况下，
Celery 试图在处理大量短任务与少量长任务之间取得平衡，
在吞吐量与公平调度之间做出折中。</p>
<p>如果你对公平调度有严格要求，
或希望对系统进行吞吐量优化，
请阅读 <a class="reference internal" href="../userguide/optimizing.html#guide-optimizing"><span class="std std-ref">优化指南</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">英文</label><div class="tab-content docutils container">
<p>The default configuration isn't optimized for throughput. By default,
it tries to walk the middle way between many short tasks and fewer long
tasks, a compromise between throughput and fair scheduling.</p>
<p>If you have strict fair scheduling requirements, or want to optimize
for throughput then you should read the <a class="reference internal" href="../userguide/optimizing.html#guide-optimizing"><span class="std std-ref">Optimizing Guide</span></a>.</p>
</div>
</div>
</section>
<section id="id14">
<h2>现在可以做什么?<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h2>
<p>What to do now?</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">中文</label><div class="tab-content docutils container">
<p>阅读完本文档之后，建议继续阅读 <a class="reference internal" href="../userguide/index.html#guide"><span class="std std-ref">用户指南</span></a>。</p>
<p>如果你对 API 感兴趣，也可以参考 <a class="reference internal" href="../reference/index.html#apiref"><span class="std std-ref">API 参考</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">英文</label><div class="tab-content docutils container">
<p>Now that you have read this document you should continue
to the <a class="reference internal" href="../userguide/index.html#guide"><span class="std std-ref">User Guide</span></a>.</p>
<p>There's also an <a class="reference internal" href="../reference/index.html#apiref"><span class="std std-ref">API reference</span></a> if you're so inclined.</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="resources.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">资源</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="first-steps-with-celery.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">使用 Celery 的第一步</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2009-2023, Ask Solem &amp; contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">下一步</a><ul>
<li><a class="reference internal" href="#celery">在你的项目中使用Celery</a><ul>
<li><a class="reference internal" href="#project-layout">我们的项目</a><ul>
<li><a class="reference internal" href="#proj-celery-py"><code class="file docutils literal notranslate"><span class="pre">proj/celery.py</span></code></a></li>
<li><a class="reference internal" href="#proj-tasks-py"><code class="file docutils literal notranslate"><span class="pre">proj/tasks.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#worker">启动 worker</a><ul>
<li><a class="reference internal" href="#id3">停止 worker</a></li>
<li><a class="reference internal" href="#id4">在后台</a></li>
<li><a class="reference internal" href="#app">关于 <code class="xref std std-option docutils literal notranslate"><span class="pre">--app</span></code> 参数</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#calling-tasks">调用任务</a></li>
<li><a class="reference internal" href="#canvas"><em>Canvas</em>: 设计工作流</a><ul>
<li><a class="reference internal" href="#api">并且再次调用 API …</a></li>
<li><a class="reference internal" href="#id6">原语</a><ul>
<li><a class="reference internal" href="#id7">组式任务</a></li>
<li><a class="reference internal" href="#id8">链式任务</a></li>
<li><a class="reference internal" href="#id9">合集任务</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id10">路由</a></li>
<li><a class="reference internal" href="#id11">远程控制</a></li>
<li><a class="reference internal" href="#id12">时区</a></li>
<li><a class="reference internal" href="#id13">优化</a></li>
<li><a class="reference internal" href="#id14">现在可以做什么?</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8156d91f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>