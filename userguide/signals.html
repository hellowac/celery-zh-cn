<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="使用 Celery 进行测试" href="testing.html" /><link rel="prev" title="gevent 并发" href="concurrency/gevent.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>信号 - Celery 5.5.1 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/my.css?v=112ca36d" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Celery 5.5.1 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/celery_512_1.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Celery 5.5.1 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">版权</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">快速开始</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of 快速开始</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/introduction.html">Celery 简介</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/backends-and-brokers/index.html">Backends 和 Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Backends 和 Brokers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/rabbitmq.html">使用 RabbitMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/redis.html">使用 Redis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/sqs.html">使用 Amazon SQS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/kafka.html">使用 Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/backends-and-brokers/gcpubsub.html">使用 Google Pub/Sub</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/first-steps-with-celery.html">使用 Celery 的第一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/next-steps.html">下一步</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/resources.html">资源</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">用户指南</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of 用户指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="application.html">应用程序</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="calling.html">调用任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="canvas.html">Canvas：设计工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="workers.html">Workers 指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="daemonizing.html">守护进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="periodic-tasks.html">周期性任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="routing.html">路由任务/Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitoring.html">监控和管理指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">安全</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimizing.html">优化</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">调试</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="concurrency/index.html">并发</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of 并发</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrency/eventlet.html">Eventlet 并发</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrency/gevent.html">gevent 并发</a></li>
</ul>
</li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">信号</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">使用 Celery 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending.html">扩展 和 Bootsteps</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">配置和默认值</a></li>
<li class="toctree-l2"><a class="reference internal" href="sphinx.html">使用 Sphinx 文档化任务</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../django/index.html">Django</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Django</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../django/first-steps-with-django.html">使用 Django 的第一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">社区资源</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">教程</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/task-cookbook.html">Task Cookbook</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">更改历史</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API 参考</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API 参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/cli.html">命令行接口</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">celery</span></code> --- Distributed processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html">Proxies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.task.html"><code class="docutils literal notranslate"><span class="pre">celery.app.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html">AMQP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.amqp.html#queues">Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.defaults.html"><code class="docutils literal notranslate"><span class="pre">celery.app.defaults</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.control.html"><code class="docutils literal notranslate"><span class="pre">celery.app.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.registry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.registry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.app.backends</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.builtins.html"><code class="docutils literal notranslate"><span class="pre">celery.app.builtins</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.events.html"><code class="docutils literal notranslate"><span class="pre">celery.app.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.log.html"><code class="docutils literal notranslate"><span class="pre">celery.app.log</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.app.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.app.autoretry.html"><code class="docutils literal notranslate"><span class="pre">celery.app.autoretry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bootsteps.html"><code class="docutils literal notranslate"><span class="pre">celery.bootsteps</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.result.html"><code class="docutils literal notranslate"><span class="pre">celery.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.schedules.html"><code class="docutils literal notranslate"><span class="pre">celery.schedules</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.signals.html"><code class="docutils literal notranslate"><span class="pre">celery.signals</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.security.html"><code class="docutils literal notranslate"><span class="pre">celery.security</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.utils.debug.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.debug</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.exceptions.html"><code class="docutils literal notranslate"><span class="pre">celery.exceptions</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.app.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.default.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.default</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.loaders.base.html"><code class="docutils literal notranslate"><span class="pre">celery.loaders.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html">States</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#sets">Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#misc">Misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.FAILURE"><code class="docutils literal notranslate"><span class="pre">FAILURE</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.PENDING"><code class="docutils literal notranslate"><span class="pre">PENDING</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RECEIVED"><code class="docutils literal notranslate"><span class="pre">RECEIVED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.RETRY"><code class="docutils literal notranslate"><span class="pre">RETRY</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.REVOKED"><code class="docutils literal notranslate"><span class="pre">REVOKED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.STARTED"><code class="docutils literal notranslate"><span class="pre">STARTED</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.SUCCESS"><code class="docutils literal notranslate"><span class="pre">SUCCESS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.precedence"><code class="docutils literal notranslate"><span class="pre">precedence()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.states.html#celery.states.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.abortable.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.abortable</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.django.task.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.django.task</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.pytest.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.pytest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.sphinx.html">celery.contrib.sphinx</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.app.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.app</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.manager.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.manager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.testing.mocks.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.testing.mocks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.contrib.rdb.html"><code class="docutils literal notranslate"><span class="pre">celery.contrib.rdb</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.html"><code class="docutils literal notranslate"><span class="pre">celery.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.receiver.html"><code class="docutils literal notranslate"><span class="pre">celery.events.receiver</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.dispatcher.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.event.html"><code class="docutils literal notranslate"><span class="pre">celery.events.event</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.events.state.html"><code class="docutils literal notranslate"><span class="pre">celery.events.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.apps.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.apps.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.request.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.request</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.state.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.strategy.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.strategy</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.agent.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.connection.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.connection</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.consumer.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.consumer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.events.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.gossip.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.gossip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.heart.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.heart</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.mingle.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.mingle</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.consumer.tasks.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.consumer.tasks</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.worker.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.base.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.celery.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.celery</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.worker.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.worker</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.beat.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.beat</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.events.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.events</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.logtool.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.logtool</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.amqp.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.amqp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.graph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.multi.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.multi</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.call.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.call</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.control.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.control</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.list.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.list</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.migrate.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.migrate</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.purge.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.purge</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.result.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.result</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.shell.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.shell</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/celery.bin.upgrade.html"><code class="docutils literal notranslate"><span class="pre">celery.bin.upgrade</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../internals/index.html">内部</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of 内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../internals/guide.html">代码贡献指南</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/deprecation.html">Celery 弃用时间表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/worker.html">内部的 worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/protocol.html">消息协议</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/app-overview.html">“大实例”重构</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../internals/reference/index.html">内部模块参考</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 内部模块参考</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.components.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.components</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.loops.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.loops</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.heartbeat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.control.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.control</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.pidbox.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.pidbox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.worker.autoscale.html"><code class="docutils literal notranslate"><span class="pre">celery.worker.autoscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.solo.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.solo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.prefork.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.prefork</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.eventlet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.gevent.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.gevent</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.thread.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.concurrency.base.html"><code class="docutils literal notranslate"><span class="pre">celery.concurrency.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.html"><code class="docutils literal notranslate"><span class="pre">celery.backends</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.base.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.asynchronous.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.asynchronous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.azureblockblob.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.azureblockblob</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.rpc.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.rpc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cache.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cache</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.consul.html">celery.backends.consul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchdb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchdb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.mongodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.mongodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.elasticsearch.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.elasticsearch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.redis.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.redis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cassandra.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cassandra</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.couchbase.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.couchbase</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.arangodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.arangodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.dynamodb.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.dynamodb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.filesystem.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.filesystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.cosmosdbsql.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.cosmosdbsql</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.s3.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.s3</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.gcs.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.gcs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.trace.html"><code class="docutils literal notranslate"><span class="pre">celery.app.trace</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.annotations.html"><code class="docutils literal notranslate"><span class="pre">celery.app.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.app.routes.html"><code class="docutils literal notranslate"><span class="pre">celery.app.routes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.certificate.html"><code class="docutils literal notranslate"><span class="pre">celery.security.certificate</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.key.html"><code class="docutils literal notranslate"><span class="pre">celery.security.key</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.security.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.security.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.security.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.snapshot.html"><code class="docutils literal notranslate"><span class="pre">celery.events.snapshot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.cursesmon.html"><code class="docutils literal notranslate"><span class="pre">celery.events.cursesmon</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.events.dumper.html"><code class="docutils literal notranslate"><span class="pre">celery.events.dumper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.models.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.models</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.backends.database.session.html"><code class="docutils literal notranslate"><span class="pre">celery.backends.database.session</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.html"><code class="docutils literal notranslate"><span class="pre">celery.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.abstract.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.abstract</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.collections.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.collections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.nodenames.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.nodenames</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.deprecated.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.deprecated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.functional.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.functional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.graph.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.graph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.objects.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.term.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.term</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.time.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.iso8601.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.iso8601</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.saferepr.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.saferepr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.serialization.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.serialization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.sysinfo.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.sysinfo</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.threads.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.timer2.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.timer2</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.imports.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.imports</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.log.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.text.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.text</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html"><code class="docutils literal notranslate"><span class="pre">celery.utils.dispatch.signal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery.platforms.html"><code class="docutils literal notranslate"><span class="pre">celery.platforms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals/reference/celery._state.html"><code class="docutils literal notranslate"><span class="pre">celery._state</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../history/index.html">历史</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 历史</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.5.html">What's new in Celery 5.5 (Immunity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.5.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.4.html">What's new in Celery 5.4 (Opalescent)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.3.html">What's new in Celery 5.3 (Emerald Rush)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.1.html">What's new in Celery 5.1 (Sun Harmonics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-5.0.html">What's new in Celery 5.0 (singularity)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-5.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.4.html">What's new in Celery 4.4 (Cliffs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.4.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.3.html">What's new in Celery 4.3 (rhubarb)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.3.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.2.html">What's new in Celery 4.2 (windowlicker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.2.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.1.html">What's new in Celery 4.1 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-4.0.html">What's new in Celery 4.0 (latentcall)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-4.0.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-3.1.html">What's new in Celery 3.1 (Cipater)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-3.1.html">Change history</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-3.0.html">What's new in Celery 3.0 (Chiastic Slide)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-3.0.html">Change history for Celery 3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/whatsnew-2.5.html">What's new in Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.5.html">Change history for Celery 2.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.4.html">Change history for Celery 2.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.3.html">Change history for Celery 2.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.2.html">Change history for Celery 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.1.html">Change history for Celery 2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-2.0.html">Change history for Celery 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/changelog-1.0.html">Change history for Celery 1.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">术语</a></li>
</ul>

</div>
<!-- <iframe src="https://ghbtns.com/github-btn.html?user=celery&repo=celery&type=watch&count=true&size=large"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe> -->
<div id="donate">
  <h5>捐赠</h5>
  <p>请捐赠以支持这个社区项目</p>
  <a href="https://opencollective.com/celery/donate" target="_blank">
    <!-- <img src="https://opencollective.com/celery/donate/button@2x.png?color=blue" /> -->
    <img src="https://opencollective.com/celery/donate/button.png?color=blue" />
  </a>
</div></div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/userguide/signals.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="signals">
<span id="id1"></span><h1>信号<a class="headerlink" href="#signals" title="Link to this heading">¶</a></h1>
<p>Signals</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>信号（Signals）允许解耦的应用程序在应用的其他部分发生某些操作时接收通知。</p>
<p>Celery 内置了许多信号，您的应用程序可以通过钩入这些信号来增强某些行为。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>Signals allow decoupled applications to receive notifications when
certain actions occur elsewhere in the application.</p>
<p>Celery ships with many signals that your application can hook into
to augment behavior of certain actions.</p>
</div>
</div>
<section id="signal-basics">
<span id="id2"></span><h2>基础<a class="headerlink" href="#signal-basics" title="Link to this heading">¶</a></h2>
<p>Basics</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>多种类型的事件都会触发信号，您可以连接这些信号，在其触发时执行相应操作。</p>
<p>以下是连接 <a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> 信号的示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">after_task_publish</span>

<span class="nd">@after_task_publish</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">task_sent_handler</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># 任务信息位于 headers 中（任务消息使用协议版本 2）</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">headers</span> <span class="k">if</span> <span class="s1">&#39;task&#39;</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">else</span> <span class="n">body</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_task_publish for task id </span><span class="si">{info[id]}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>某些信号还支持按 sender 进行过滤。例如，<a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> 信号
使用任务名作为 sender，因此通过为
<a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html#celery.utils.dispatch.signal.Signal.connect" title="celery.utils.dispatch.signal.Signal.connect"><code class="xref py py-class docutils literal notranslate"><span class="pre">connect</span></code></a> 方法提供 <code class="docutils literal notranslate"><span class="pre">sender</span></code> 参数，
可以让处理器仅在名称为 <cite>&quot;proj.tasks.add&quot;</cite> 的任务被发布时被调用：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@after_task_publish</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="s1">&#39;proj.tasks.add&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">task_sent_handler</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># 任务信息位于 headers 中（任务消息使用协议版本 2）</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">headers</span> <span class="k">if</span> <span class="s1">&#39;task&#39;</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">else</span> <span class="n">body</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_task_publish for task id </span><span class="si">{info[id]}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>信号使用与 <code class="xref py py-mod docutils literal notranslate"><span class="pre">django.core.dispatch</span></code> 相同的实现方式。因此，其他关键字参数（如 signal）
默认也会传递给所有信号处理器。</p>
<p>编写信号处理器的最佳实践是接受任意关键字参数（即 <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>）。这样做可确保
即使将来的 Celery 版本增加新参数，也不会破坏已有代码。</p>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>Several kinds of events trigger signals, you can connect to these signals
to perform actions as they trigger.</p>
<p>Example connecting to the <a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> signal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">after_task_publish</span>

<span class="nd">@after_task_publish</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">task_sent_handler</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># information about task are located in headers for task messages</span>
    <span class="c1"># using the task protocol version 2.</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">headers</span> <span class="k">if</span> <span class="s1">&#39;task&#39;</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">else</span> <span class="n">body</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_task_publish for task id </span><span class="si">{info[id]}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>Some signals also have a sender you can filter by. For example the
<a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> signal uses the task name as a sender, so by
providing the <code class="docutils literal notranslate"><span class="pre">sender</span></code> argument to
<a class="reference internal" href="../internals/reference/celery.utils.dispatch.signal.html#celery.utils.dispatch.signal.Signal.connect" title="celery.utils.dispatch.signal.Signal.connect"><code class="xref py py-class docutils literal notranslate"><span class="pre">connect</span></code></a> you can
connect your handler to be called every time a task with name <cite>&quot;proj.tasks.add&quot;</cite>
is published:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@after_task_publish</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="s1">&#39;proj.tasks.add&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">task_sent_handler</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># information about task are located in headers for task messages</span>
    <span class="c1"># using the task protocol version 2.</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">headers</span> <span class="k">if</span> <span class="s1">&#39;task&#39;</span> <span class="ow">in</span> <span class="n">headers</span> <span class="k">else</span> <span class="n">body</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after_task_publish for task id </span><span class="si">{info[id]}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span>
    <span class="p">))</span>
</pre></div>
</div>
<p>Signals use the same implementation as <code class="xref py py-mod docutils literal notranslate"><span class="pre">django.core.dispatch</span></code>. As a
result other keyword parameters (e.g., signal) are passed to all signal
handlers by default.</p>
<p>The best practice for signal handlers is to accept arbitrary keyword
arguments (i.e., <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>). That way new Celery versions can add additional
arguments without breaking user code.</p>
</div>
</div>
</section>
<section id="signal-ref">
<span id="id3"></span><h2>信号<a class="headerlink" href="#signal-ref" title="Link to this heading">¶</a></h2>
<p>Signals</p>
<section id="task">
<h3>Task 信号<a class="headerlink" href="#task" title="Link to this heading">¶</a></h3>
<p>Task Signals</p>
<section id="before-task-publish">
<span id="std-signal-before_task_publish"></span><h4><code class="docutils literal notranslate"><span class="pre">before_task_publish</span></code><a class="headerlink" href="#before-task-publish" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.1.</span></p>
</div>
<p>在任务被发布之前触发该信号。
请注意，这是在发送任务的进程中执行的。</p>
<p>Sender 为被发送的任务名称。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code></p>
<p>任务消息体。</p>
<p>这是一个包含任务消息字段的映射，参见
<a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a> 和 <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
获取可能定义字段的参考信息。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exchange</span></code></p>
<p>要发送到的交换机名称，或一个 <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a> 对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">routing_key</span></code></p>
<p>发送消息时使用的路由键。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code></p>
<p>应用层头部信息映射（可修改）。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p>
<p>消息属性（可修改）。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">declare</span></code></p>
<p>在发布消息前需声明的实体（<a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a>、
<a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Queue" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a> 或 <code class="xref py py-class docutils literal notranslate"><span class="pre">binding</span></code>）列表。可修改。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry_policy</span></code></p>
<p>重试策略映射。可为 <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Connection.ensure" title="（在 Kombu v5.5）"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kombu.Connection.ensure()</span></code></a> 方法的任意参数，亦可修改。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.1.</span></p>
</div>
<p>Dispatched before a task is published.
Note that this is executed in the process sending the task.</p>
<p>Sender is the name of the task being sent.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code></p>
<p>Task message body.</p>
<p>This is a mapping containing the task message fields,
see <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a>
and <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
for a reference of possible fields that can be defined.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exchange</span></code></p>
<p>Name of the exchange to send to or a <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a> object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">routing_key</span></code></p>
<p>Routing key to use when sending the message.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code></p>
<p>Application headers mapping (can be modified).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">properties</span></code></p>
<p>Message properties (can be modified)</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">declare</span></code></p>
<p>List of entities (<a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a>,
<a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Queue" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Queue</span></code></a>, or <code class="xref py py-class docutils literal notranslate"><span class="pre">binding</span></code> to declare before
publishing the message. Can be modified.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry_policy</span></code></p>
<p>Mapping of retry options. Can be any argument to
<a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Connection.ensure" title="（在 Kombu v5.5）"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kombu.Connection.ensure()</span></code></a> and can be modified.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="after-task-publish">
<span id="std-signal-after_task_publish"></span><h4><code class="docutils literal notranslate"><span class="pre">after_task_publish</span></code><a class="headerlink" href="#after-task-publish" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>任务被发送到 broker 后将触发该信号。
请注意，这是在发送任务的进程中执行的。</p>
<p>Sender 为被发送的任务名称。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code></p>
<p>任务消息的头部信息，参见
<a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a> 和 <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
获取可能定义字段的参考信息。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code></p>
<p>任务消息体，参见
<a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a> 和 <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
获取可能定义字段的参考信息。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exchange</span></code></p>
<p>所使用的交换机名称或 <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a> 对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">routing_key</span></code></p>
<p>所使用的路由键。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task has been sent to the broker.
Note that this is executed in the process that sent the task.</p>
<p>Sender is the name of the task being sent.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code></p>
<p>The task message headers, see <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a>
and <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
for a reference of possible fields that can be defined.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code></p>
<p>The task message body, see <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v2"><span class="std std-ref">版本 2</span></a>
and <a class="reference internal" href="../internals/protocol.html#message-protocol-task-v1"><span class="std std-ref">版本 1</span></a>
for a reference of possible fields that can be defined.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exchange</span></code></p>
<p>Name of the exchange or <a class="reference external" href="https://docs.celeryq.dev/projects/kombu/en/main/reference/kombu.html#kombu.Exchange" title="（在 Kombu v5.5）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exchange</span></code></a> object used.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">routing_key</span></code></p>
<p>Routing key used.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-prerun">
<span id="std-signal-task_prerun"></span><h4><code class="docutils literal notranslate"><span class="pre">task_prerun</span></code><a class="headerlink" href="#task-prerun" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>任务执行前会触发该信号。</p>
<p>Sender 为正在执行的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>将要执行的任务 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p>
<p>正在执行的任务对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>任务的位置参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>任务的关键字参数。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched before a task is executed.</p>
<p>Sender is the task object being executed.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>Id of the task to be executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p>
<p>The task being executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>The tasks positional arguments.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>The tasks keyword arguments.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-postrun">
<span id="std-signal-task_postrun"></span><h4><code class="docutils literal notranslate"><span class="pre">task_postrun</span></code><a class="headerlink" href="#task-postrun" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>任务执行完毕后会触发该信号。</p>
<p>Sender 为已执行的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>已执行任务的 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p>
<p>已执行的任务对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>任务的位置参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>任务的关键字参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">retval</span></code></p>
<p>任务的返回值。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code></p>
<p>执行结果的状态名称。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched after a task has been executed.</p>
<p>Sender is the task object executed.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>Id of the task to be executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p>
<p>The task being executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>The tasks positional arguments.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>The tasks keyword arguments.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">retval</span></code></p>
<p>The return value of the task.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code></p>
<p>Name of the resulting state.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-retry">
<span id="std-signal-task_retry"></span><h4><code class="docutils literal notranslate"><span class="pre">task_retry</span></code><a class="headerlink" href="#task-retry" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>任务即将重试时会触发该信号。</p>
<p>Sender 为任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>当前任务请求对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">reason</span></code></p>
<p>重试原因（通常为一个异常实例，但始终可强制转换为 <a class="reference external" href="https://docs.python.org/dev/library/stdtypes.html#str" title="（在 Python v3.15）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>）。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>异常的详细信息，包括 traceback
（一个 <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> 对象）。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task will be retried.</p>
<p>Sender is the task object.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>The current task request.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">reason</span></code></p>
<p>Reason for retry (usually an exception instance, but can always be
coerced to <a class="reference external" href="https://docs.python.org/dev/library/stdtypes.html#str" title="（在 Python v3.15）"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>Detailed exception information, including traceback
(a <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> object).</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-success">
<span id="std-signal-task_success"></span><h4><code class="docutils literal notranslate"><span class="pre">task_success</span></code><a class="headerlink" href="#task-success" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p>任务执行成功后会触发该信号。</p>
<p>Sender 为已执行的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p>
<p>任务的返回值。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task succeeds.</p>
<p>Sender is the task object executed.</p>
<p>Provides arguments</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">result</span></code></p>
<p>Return value of the task.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-failure">
<span id="std-signal-task_failure"></span><h4><code class="docutils literal notranslate"><span class="pre">task_failure</span></code><a class="headerlink" href="#task-failure" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>任务执行失败后会触发该信号。</p>
<p>Sender 为已执行的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>任务 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exception</span></code></p>
<p>抛出的异常实例。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>调用任务时使用的位置参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>调用任务时使用的关键字参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceback</span></code></p>
<p>异常的堆栈跟踪对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>一个 <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> 实例。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task fails.</p>
<p>Sender is the task object executed.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>Id of the task.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exception</span></code></p>
<p>Exception instance raised.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>Positional arguments the task was called with.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>Keyword arguments the task was called with.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceback</span></code></p>
<p>Stack trace object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> instance.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-internal-error">
<span id="std-signal-task_internal_error"></span><h4><code class="docutils literal notranslate"><span class="pre">task_internal_error</span></code><a class="headerlink" href="#task-internal-error" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>当任务执行期间发生 Celery 内部错误时，会触发该信号。</p>
<p>Sender 为已执行的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>任务的 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>调用任务时使用的位置参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>调用任务时使用的关键字参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>原始请求字典。
提供该参数是因为在异常被抛出时，<code class="docutils literal notranslate"><span class="pre">task.request</span></code> 可能尚未准备好。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exception</span></code></p>
<p>抛出的异常实例。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceback</span></code></p>
<p>异常的堆栈跟踪对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>一个 <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> 实例。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when an internal Celery error occurs while executing the task.</p>
<p>Sender is the task object executed.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">task_id</span></code></p>
<p>Id of the task.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>Positional arguments the task was called with.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>Keyword arguments the task was called with.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>The original request dictionary.
This is provided as the <code class="docutils literal notranslate"><span class="pre">task.request</span></code> may not be ready by the time
the exception is raised.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exception</span></code></p>
<p>Exception instance raised.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceback</span></code></p>
<p>Stack trace object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">einfo</span></code></p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">billiard.einfo.ExceptionInfo</span></code> instance.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-received">
<span id="std-signal-task_received"></span><h4><code class="docutils literal notranslate"><span class="pre">task_received</span></code><a class="headerlink" href="#task-received" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<p>当任务从 broker 接收并准备好执行时，会触发该信号。</p>
<p>Sender 为 consumer 对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>这是一个 <a class="reference internal" href="../reference/celery.worker.request.html#celery.worker.request.Request" title="celery.worker.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> 实例，而不是
<code class="docutils literal notranslate"><span class="pre">task.request</span></code>。当使用 prefork 池时，该信号在父进程中触发，
因此无法使用 <code class="docutils literal notranslate"><span class="pre">task.request</span></code>，也不应该使用。请使用该对象，
它们拥有许多相同的字段。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task is received from the broker and is ready for execution.</p>
<p>Sender is the consumer object.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>This is a <a class="reference internal" href="../reference/celery.worker.request.html#celery.worker.request.Request" title="celery.worker.request.Request"><code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code></a> instance, and not
<code class="docutils literal notranslate"><span class="pre">task.request</span></code>. When using the prefork pool this signal
is dispatched in the parent process, so <code class="docutils literal notranslate"><span class="pre">task.request</span></code> isn't available
and shouldn't be used. Use this object instead, as they share many
of the same fields.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-revoked">
<span id="std-signal-task_revoked"></span><h4><code class="docutils literal notranslate"><span class="pre">task_revoked</span></code><a class="headerlink" href="#task-revoked" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<p>当任务被 worker 撤销或终止时，会触发该信号。</p>
<p>Sender 为被撤销或终止的任务对象。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>这是一个 <a class="reference internal" href="../reference/celery.app.task.html#celery.app.task.Context" title="celery.app.task.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code></a> 实例，而不是
<code class="docutils literal notranslate"><span class="pre">task.request</span></code>。当使用 prefork 池时，该信号在父进程中触发，
因此无法使用 <code class="docutils literal notranslate"><span class="pre">task.request</span></code>，也不应该使用。请使用该对象，
它们拥有许多相同的字段。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">terminated</span></code></p>
<p>如果任务是被终止的，则为 <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">signum</span></code></p>
<p>用于终止任务的信号编号。如果该值为 <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> 且
<code class="docutils literal notranslate"><span class="pre">terminated</span></code> 为 <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>，则应视为收到了 <code class="xref std std-sig docutils literal notranslate"><span class="pre">TERM</span></code> 信号。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">expired</span></code></p>
<p>如果任务已过期，则为 <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a task is revoked/terminated by the worker.</p>
<p>Sender is the task object revoked/terminated.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">request</span></code></p>
<p>This is a <a class="reference internal" href="../reference/celery.app.task.html#celery.app.task.Context" title="celery.app.task.Context"><code class="xref py py-class docutils literal notranslate"><span class="pre">Context</span></code></a> instance, and not
<code class="docutils literal notranslate"><span class="pre">task.request</span></code>. When using the prefork pool this signal
is dispatched in the parent process, so <code class="docutils literal notranslate"><span class="pre">task.request</span></code> isn't available
and shouldn't be used. Use this object instead, as they share many
of the same fields.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">terminated</span></code></p>
<blockquote>
<div><p>Set to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the task was terminated.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">signum</span></code></p>
<blockquote>
<div><p>Signal number used to terminate the task. If this is <code class="xref py py-const docutils literal notranslate"><span class="pre">None</span></code> and
terminated is <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> then <code class="xref std std-sig docutils literal notranslate"><span class="pre">TERM</span></code> should be assumed.</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">expired</span></code></p>
<p>Set to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the task expired.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-unknown">
<span id="std-signal-task_unknown"></span><h4><code class="docutils literal notranslate"><span class="pre">task_unknown</span></code><a class="headerlink" href="#task-unknown" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">中文</label><div class="tab-content docutils container">
<p>当 worker 收到一个未注册任务的消息时，会触发该信号。</p>
<p>Sender 为 worker 的 <a class="reference internal" href="../reference/celery.worker.consumer.html#celery.worker.consumer.Consumer" title="celery.worker.consumer.Consumer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Consumer</span></code></a> 实例。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<p>未在注册表中找到的任务名称。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p>
<p>消息中的任务 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p>
<p>原始消息对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exc</span></code></p>
<p>触发的错误。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a worker receives a message for a task that's not registered.</p>
<p>Sender is the worker <a class="reference internal" href="../reference/celery.worker.consumer.html#celery.worker.consumer.Consumer" title="celery.worker.consumer.Consumer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Consumer</span></code></a>.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p>
<p>Name of task not found in registry.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p>
<p>The task id found in the message.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p>
<p>Raw message object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exc</span></code></p>
<p>The error that occurred.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="task-rejected">
<span id="std-signal-task_rejected"></span><h4><code class="docutils literal notranslate"><span class="pre">task_rejected</span></code><a class="headerlink" href="#task-rejected" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">中文</label><div class="tab-content docutils container">
<p>当 worker 收到未知类型的消息，并尝试将其投递到某个任务队列时，会触发该信号。</p>
<p>Sender 为 worker 的 <a class="reference internal" href="../reference/celery.worker.consumer.html#celery.worker.consumer.Consumer" title="celery.worker.consumer.Consumer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Consumer</span></code></a> 实例。</p>
<p>提供的参数包括：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p>
<p>原始消息对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exc</span></code></p>
<p>触发的错误（如果有）。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when a worker receives an unknown type of message to one of its
task queues.</p>
<p>Sender is the worker <a class="reference internal" href="../reference/celery.worker.consumer.html#celery.worker.consumer.Consumer" title="celery.worker.consumer.Consumer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Consumer</span></code></a>.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code></p>
<p>Raw message object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exc</span></code></p>
<p>The error that occurred (if any).</p>
</li>
</ul>
</div>
</div>
</section>
</section>
<section id="app">
<h3>App 信号<a class="headerlink" href="#app" title="Link to this heading">¶</a></h3>
<p>App Signals</p>
<section id="import-modules">
<span id="std-signal-import_modules"></span><h4><code class="docutils literal notranslate"><span class="pre">import_modules</span></code><a class="headerlink" href="#import-modules" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">中文</label><div class="tab-content docutils container">
<p>当程序（如 worker、beat、shell 等）请求导入
<a class="reference internal" href="configuration.html#std-setting-include"><code class="xref std std-setting docutils literal notranslate"><span class="pre">include</span></code></a> 和 <a class="reference internal" href="configuration.html#std-setting-imports"><code class="xref std std-setting docutils literal notranslate"><span class="pre">imports</span></code></a> 设置中指定的模块时，会触发该信号。</p>
<p>Sender 为应用实例。</p>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">英文</label><div class="tab-content docutils container">
<p>This signal is sent when a program (worker, beat, shell) etc, asks
for modules in the <a class="reference internal" href="configuration.html#std-setting-include"><code class="xref std std-setting docutils literal notranslate"><span class="pre">include</span></code></a> and <a class="reference internal" href="configuration.html#std-setting-imports"><code class="xref std std-setting docutils literal notranslate"><span class="pre">imports</span></code></a>
settings to be imported.</p>
<p>Sender is the app instance.</p>
</div>
</div>
</section>
</section>
<section id="worker">
<h3>Worker 信号<a class="headerlink" href="#worker" title="Link to this heading">¶</a></h3>
<p>Worker Signals</p>
<section id="celeryd-after-setup">
<span id="std-signal-celeryd_after_setup"></span><h4><code class="docutils literal notranslate"><span class="pre">celeryd_after_setup</span></code><a class="headerlink" href="#celeryd-after-setup" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">中文</label><div class="tab-content docutils container">
<p>该信号在 Worker 实例设置完成之后、调用 run 方法之前发送。这意味着通过 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a> 选项启用的队列已生效，日志系统也已设置完成，等等。</p>
<p>可用于添加自定义队列，这些队列将始终被消费，而不受 <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a> 选项限制。以下是一个示例，它为每个 Worker 设置了一个直连队列（direct queue），随后可以将任务路由到指定的 Worker：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_after_setup</span>

<span class="nd">@celeryd_after_setup</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">setup_direct_queue</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">queue_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.dq&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sender</span><span class="p">)</span>  <span class="c1"># sender 是该 Worker 的节点名称（nodename）</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">amqp</span><span class="o">.</span><span class="n">queues</span><span class="o">.</span><span class="n">select_add</span><span class="p">(</span><span class="n">queue_name</span><span class="p">)</span>
</pre></div>
</div>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sender</span></code></p>
<p>Worker 的节点名称。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span></code></p>
<p>即将初始化的 <a class="reference internal" href="../reference/celery.apps.worker.html#celery.apps.worker.Worker" title="celery.apps.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.apps.worker.Worker</span></code></a> 实例。
注意，此时仅设置了 <a class="reference internal" href="extending.html#id0" title="app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app</span></code></a> 与 <code class="xref py py-attr docutils literal notranslate"><span class="pre">hostname`（节点名）属性，其余的</span> <span class="pre">``__init__`</span></code> 过程尚未执行。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">conf</span></code></p>
<p>当前应用的配置对象。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">英文</label><div class="tab-content docutils container">
<p>This signal is sent after the worker instance is set up, but before it
calls run. This means that any queues from the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a>
option is enabled, logging has been set up and so on.</p>
<p>It can be used to add custom queues that should always be consumed
from, disregarding the <a class="reference internal" href="../reference/cli.html#cmdoption-celery-worker-Q"><code class="xref std std-option docutils literal notranslate"><span class="pre">celery</span> <span class="pre">worker</span> <span class="pre">-Q</span></code></a> option. Here's an example
that sets up a direct queue for each worker, these queues can then be
used to route a task to any specific worker:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_after_setup</span>

<span class="nd">@celeryd_after_setup</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">setup_direct_queue</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">queue_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">.dq&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sender</span><span class="p">)</span>  <span class="c1"># sender is the nodename of the worker</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">amqp</span><span class="o">.</span><span class="n">queues</span><span class="o">.</span><span class="n">select_add</span><span class="p">(</span><span class="n">queue_name</span><span class="p">)</span>
</pre></div>
</div>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sender</span></code></p>
<p>Node name of the worker.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span></code></p>
<p>This is the <a class="reference internal" href="../reference/celery.apps.worker.html#celery.apps.worker.Worker" title="celery.apps.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.apps.worker.Worker</span></code></a> instance to be initialized.
Note that only the <a class="reference internal" href="extending.html#id0" title="app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app</span></code></a> and <a class="reference internal" href="extending.html#id9" title="hostname"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hostname</span></code></a> (nodename) attributes have been
set so far, and the rest of <code class="docutils literal notranslate"><span class="pre">__init__</span></code> hasn't been executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">conf</span></code></p>
<p>The configuration of the current app.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="celeryd-init">
<span id="std-signal-celeryd_init"></span><h4><code class="docutils literal notranslate"><span class="pre">celeryd_init</span></code><a class="headerlink" href="#celeryd-init" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">中文</label><div class="tab-content docutils container">
<p>这是 <strong class="program">celery worker</strong> 启动时发送的第一个信号。
<code class="docutils literal notranslate"><span class="pre">sender</span></code> 是 Worker 的主机名，因此可以使用该信号进行特定 Worker 的配置：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_init</span>

<span class="nd">@celeryd_init</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="s1">&#39;worker12@example.com&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_worker12</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">task_default_rate_limit</span> <span class="o">=</span> <span class="s1">&#39;10/m&#39;</span>
</pre></div>
</div>
<p>若要配置多个 Worker，可在连接时省略指定 sender：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_init</span>

<span class="nd">@celeryd_init</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_workers</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;worker1@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;worker2@example.com&#39;</span><span class="p">):</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">task_default_rate_limit</span> <span class="o">=</span> <span class="s1">&#39;10/m&#39;</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;worker3@example.com&#39;</span><span class="p">:</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">worker_prefetch_multiplier</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sender</span></code></p>
<p>Worker 的节点名称。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span></code></p>
<p>即将初始化的 <a class="reference internal" href="../reference/celery.apps.worker.html#celery.apps.worker.Worker" title="celery.apps.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.apps.worker.Worker</span></code></a> 实例。
注意，此时仅设置了 <a class="reference internal" href="extending.html#id0" title="app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app</span></code></a> 与 <code class="xref py py-attr docutils literal notranslate"><span class="pre">hostname`（节点名）属性，其余的</span> <span class="pre">``__init__`</span></code> 过程尚未执行。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">conf</span></code></p>
<p>当前应用的配置对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p>
<p>通过命令行传递给 Worker 的选项（包括默认值）。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">英文</label><div class="tab-content docutils container">
<p>This is the first signal sent when <strong class="program">celery worker</strong> starts up.
The <code class="docutils literal notranslate"><span class="pre">sender</span></code> is the host name of the worker, so this signal can be used
to setup worker specific configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_init</span>

<span class="nd">@celeryd_init</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="s1">&#39;worker12@example.com&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_worker12</span><span class="p">(</span><span class="n">conf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">conf</span><span class="o">.</span><span class="n">task_default_rate_limit</span> <span class="o">=</span> <span class="s1">&#39;10/m&#39;</span>
</pre></div>
</div>
<p>or to set up configuration for multiple workers you can omit specifying a
sender when you connect:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery.signals</span><span class="w"> </span><span class="kn">import</span> <span class="n">celeryd_init</span>

<span class="nd">@celeryd_init</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">configure_workers</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">conf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;worker1@example.com&#39;</span><span class="p">,</span> <span class="s1">&#39;worker2@example.com&#39;</span><span class="p">):</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">task_default_rate_limit</span> <span class="o">=</span> <span class="s1">&#39;10/m&#39;</span>
    <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s1">&#39;worker3@example.com&#39;</span><span class="p">:</span>
        <span class="n">conf</span><span class="o">.</span><span class="n">worker_prefetch_multiplier</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sender</span></code></p>
<p>Nodename of the worker.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">instance</span></code></p>
<p>This is the <a class="reference internal" href="../reference/celery.apps.worker.html#celery.apps.worker.Worker" title="celery.apps.worker.Worker"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.apps.worker.Worker</span></code></a> instance to be initialized.
Note that only the <a class="reference internal" href="extending.html#id0" title="app"><code class="xref py py-attr docutils literal notranslate"><span class="pre">app</span></code></a> and <a class="reference internal" href="extending.html#id9" title="hostname"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hostname</span></code></a> (nodename) attributes have been
set so far, and the rest of <code class="docutils literal notranslate"><span class="pre">__init__</span></code> hasn't been executed.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">conf</span></code></p>
<p>The configuration of the current app.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p>
<p>Options passed to the worker from command-line arguments (including
defaults).</p>
</li>
</ul>
</div>
</div>
</section>
<section id="worker-init">
<span id="std-signal-worker_init"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_init</span></code><a class="headerlink" href="#worker-init" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">中文</label><div class="tab-content docutils container">
<p>在 worker 启动之前调度。</p>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched before the worker is started.</p>
</div>
</div>
</section>
<section id="worker-before-create-process">
<span id="std-signal-worker_before_create_process"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_before_create_process</span></code><a class="headerlink" href="#worker-before-create-process" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">中文</label><div class="tab-content docutils container">
<p>在 prefork 模式下，新子进程创建前，在父进程中调度发送。
可用于清理某些在 fork 时表现不佳的实例。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@signals</span><span class="o">.</span><span class="n">worker_before_create_process</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_channels</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">grpc_singleton</span><span class="o">.</span><span class="n">clean_channel</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched in the parent process, just before new child process is created in the prefork pool.
It can be used to clean up instances that don't behave well when forking.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@signals</span><span class="o">.</span><span class="n">worker_before_create_process</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clean_channels</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">grpc_singleton</span><span class="o">.</span><span class="n">clean_channel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="worker-ready">
<span id="std-signal-worker_ready"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_ready</span></code><a class="headerlink" href="#worker-ready" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">中文</label><div class="tab-content docutils container">
<p>当 Worker 准备好接收任务时触发。</p>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when the worker is ready to accept work.</p>
</div>
</div>
</section>
<section id="heartbeat-sent">
<span id="std-signal-heartbeat_sent"></span><h4><code class="docutils literal notranslate"><span class="pre">heartbeat_sent</span></code><a class="headerlink" href="#heartbeat-sent" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">中文</label><div class="tab-content docutils container">
<p>当 Celery 向 Worker 发送心跳时触发。</p>
<p>Sender 是 <a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html#celery.worker.heartbeat.Heart" title="celery.worker.heartbeat.Heart"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.heartbeat.Heart</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when Celery sends a worker heartbeat.</p>
<p>Sender is the <a class="reference internal" href="../internals/reference/celery.worker.heartbeat.html#celery.worker.heartbeat.Heart" title="celery.worker.heartbeat.Heart"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.worker.heartbeat.Heart</span></code></a> instance.</p>
</div>
</div>
</section>
<section id="worker-shutting-down">
<span id="std-signal-worker_shutting_down"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_shutting_down</span></code><a class="headerlink" href="#worker-shutting-down" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">中文</label><div class="tab-content docutils container">
<p>当 Worker 开始关闭流程时触发。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sig</span></code></p>
<p>收到的 POSIX 信号。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p>
<p>关闭方式，可能为 warm 或 cold。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exitcode</span></code></p>
<p>主进程退出时将使用的退出码。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when the worker begins the shutdown process.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sig</span></code></p>
<p>The POSIX signal that was received.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">how</span></code></p>
<p>The shutdown method, warm or cold.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exitcode</span></code></p>
<p>The exitcode that will be used when the main process exits.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="worker-process-init">
<span id="std-signal-worker_process_init"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_process_init</span></code><a class="headerlink" href="#worker-process-init" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">中文</label><div class="tab-content docutils container">
<p>在所有进程池的子进程启动时触发。</p>
<p>注意：绑定到该信号的处理函数不得阻塞超过 4 秒，否则该子进程会被视为启动失败并被终止。</p>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched in all pool child processes when they start.</p>
<p>Note that handlers attached to this signal mustn't be blocking
for more than 4 seconds, or the process will be killed assuming
it failed to start.</p>
</div>
</div>
</section>
<section id="worker-process-shutdown">
<span id="std-signal-worker_process_shutdown"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_process_shutdown</span></code><a class="headerlink" href="#worker-process-shutdown" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">中文</label><div class="tab-content docutils container">
<p>在所有进程池的子进程即将退出时触发。</p>
<p>注意：不保证该信号一定会被发送；就像 <a class="reference external" href="https://docs.python.org/dev/reference/compound_stmts.html#finally" title="（在 Python v3.15）"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> 代码块一样，无法保证在关闭时一定调用处理函数，且即使调用了，也可能会中断。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pid</span></code></p>
<p>即将关闭的子进程的进程 ID。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exitcode</span></code></p>
<p>子进程退出时将使用的退出码。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched in all pool child processes just before they exit.</p>
<p>Note: There's no guarantee that this signal will be dispatched,
similarly to <a class="reference external" href="https://docs.python.org/dev/reference/compound_stmts.html#finally" title="（在 Python v3.15）"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">finally</span></code></a> blocks it's impossible to guarantee that
handlers will be called at shutdown, and if called it may be
interrupted during.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">pid</span></code></p>
<p>The pid of the child process that's about to shutdown.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exitcode</span></code></p>
<p>The exitcode that'll be used when the child process exits.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="worker-shutdown">
<span id="std-signal-worker_shutdown"></span><h4><code class="docutils literal notranslate"><span class="pre">worker_shutdown</span></code><a class="headerlink" href="#worker-shutdown" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">中文</label><div class="tab-content docutils container">
<p>当 Worker 即将关闭时触发。</p>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when the worker is about to shut down.</p>
</div>
</div>
</section>
</section>
<section id="beat">
<h3>Beat 信号<a class="headerlink" href="#beat" title="Link to this heading">¶</a></h3>
<p>Beat Signals</p>
<section id="beat-init">
<span id="std-signal-beat_init"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_init</span></code><a class="headerlink" href="#beat-init" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">中文</label><div class="tab-content docutils container">
<p>当 <strong class="program">celery beat</strong> 启动时（无论是独立运行还是内嵌运行）触发。</p>
<p>Sender 是 <a class="reference internal" href="../reference/celery.beat.html#celery.beat.Service" title="celery.beat.Service"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.beat.Service</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched when <strong class="program">celery beat</strong> starts (either standalone or embedded).</p>
<p>Sender is the <a class="reference internal" href="../reference/celery.beat.html#celery.beat.Service" title="celery.beat.Service"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.beat.Service</span></code></a> instance.</p>
</div>
</div>
</section>
<section id="beat-embedded-init">
<span id="std-signal-beat_embedded_init"></span><h4><code class="docutils literal notranslate"><span class="pre">beat_embedded_init</span></code><a class="headerlink" href="#beat-embedded-init" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">中文</label><div class="tab-content docutils container">
<p>当 <strong class="program">celery beat</strong> 以内嵌进程方式启动时，除了 <a class="reference internal" href="#std-signal-beat_init"><code class="xref std std-signal docutils literal notranslate"><span class="pre">beat_init</span></code></a> 信号外还会发送此信号。</p>
<p>Sender 是 <a class="reference internal" href="../reference/celery.beat.html#celery.beat.Service" title="celery.beat.Service"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.beat.Service</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">英文</label><div class="tab-content docutils container">
<p>Dispatched in addition to the <a class="reference internal" href="#std-signal-beat_init"><code class="xref std std-signal docutils literal notranslate"><span class="pre">beat_init</span></code></a> signal when <strong class="program">celery
beat</strong> is started as an embedded process.</p>
<p>Sender is the <a class="reference internal" href="../reference/celery.beat.html#celery.beat.Service" title="celery.beat.Service"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.beat.Service</span></code></a> instance.</p>
</div>
</div>
</section>
</section>
<section id="id4">
<h3>事件信号<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>Eventlet Signals</p>
<section id="eventlet-pool-started">
<span id="std-signal-eventlet_pool_started"></span><h4><code class="docutils literal notranslate"><span class="pre">eventlet_pool_started</span></code><a class="headerlink" href="#eventlet-pool-started" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">中文</label><div class="tab-content docutils container">
<p>当 eventlet 进程池启动时发送。</p>
<p>Sender 是 <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">英文</label><div class="tab-content docutils container">
<p>Sent when the eventlet pool has been started.</p>
<p>Sender is the <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> instance.</p>
</div>
</div>
</section>
<section id="eventlet-pool-preshutdown">
<span id="std-signal-eventlet_pool_preshutdown"></span><h4><code class="docutils literal notranslate"><span class="pre">eventlet_pool_preshutdown</span></code><a class="headerlink" href="#eventlet-pool-preshutdown" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--28-input--1" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--1">中文</label><div class="tab-content docutils container">
<p>当 Worker 关闭，并即将请求 eventlet 池等待剩余工作线程时发送。</p>
<p>Sender 是 <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--28-input--2" name="tab-set--28" type="radio"><label class="tab-label" for="tab-set--28-input--2">英文</label><div class="tab-content docutils container">
<p>Sent when the worker shutdown, just before the eventlet pool
is requested to wait for remaining workers.</p>
<p>Sender is the <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> instance.</p>
</div>
</div>
</section>
<section id="eventlet-pool-postshutdown">
<span id="std-signal-eventlet_pool_postshutdown"></span><h4><code class="docutils literal notranslate"><span class="pre">eventlet_pool_postshutdown</span></code><a class="headerlink" href="#eventlet-pool-postshutdown" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--29-input--1" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--1">中文</label><div class="tab-content docutils container">
<p>当池已完成 join 操作，Worker 即将关闭时发送。</p>
<p>Sender 是 <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> 实例。</p>
</div>
<input class="tab-input" id="tab-set--29-input--2" name="tab-set--29" type="radio"><label class="tab-label" for="tab-set--29-input--2">英文</label><div class="tab-content docutils container">
<p>Sent when the pool has been joined and the worker is ready to shutdown.</p>
<p>Sender is the <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> instance.</p>
</div>
</div>
</section>
<section id="eventlet-pool-apply">
<span id="std-signal-eventlet_pool_apply"></span><h4><code class="docutils literal notranslate"><span class="pre">eventlet_pool_apply</span></code><a class="headerlink" href="#eventlet-pool-apply" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--30-input--1" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--1">中文</label><div class="tab-content docutils container">
<p>每当一个任务被提交到进程池时发送。</p>
<p>Sender 是 <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> 实例。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p>
<p>目标函数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>位置参数。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>关键字参数。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--30-input--2" name="tab-set--30" type="radio"><label class="tab-label" for="tab-set--30-input--2">英文</label><div class="tab-content docutils container">
<p>Sent whenever a task is applied to the pool.</p>
<p>Sender is the <a class="reference internal" href="../internals/reference/celery.concurrency.eventlet.html#celery.concurrency.eventlet.TaskPool" title="celery.concurrency.eventlet.TaskPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">celery.concurrency.eventlet.TaskPool</span></code></a> instance.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p>
<p>The target function.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code></p>
<p>Positional arguments.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code></p>
<p>Keyword arguments.</p>
</li>
</ul>
</div>
</div>
</section>
</section>
<section id="id5">
<h3>日志信号<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>Logging Signals</p>
<section id="setup-logging">
<span id="std-signal-setup_logging"></span><h4><code class="docutils literal notranslate"><span class="pre">setup_logging</span></code><a class="headerlink" href="#setup-logging" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--31-input--1" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--1">中文</label><div class="tab-content docutils container">
<p>如果连接了此信号，Celery 将不会配置日志记录器，因此你可以使用此信号完全覆盖默认的日志配置。</p>
<p>如果你只是希望在 Celery 的日志配置基础上进行增强，可以使用 <a class="reference internal" href="#std-signal-after_setup_logger"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_setup_logger</span></code></a> 与 <a class="reference internal" href="#std-signal-after_setup_task_logger"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_setup_task_logger</span></code></a> 信号。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>日志对象的日志级别。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>日志文件的文件名。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>日志格式字符串。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>指定日志消息是否使用颜色。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--31-input--2" name="tab-set--31" type="radio"><label class="tab-label" for="tab-set--31-input--2">英文</label><div class="tab-content docutils container">
<p>Celery won't configure the loggers if this signal is connected,
so you can use this to completely override the logging configuration
with your own.</p>
<p>If you'd like to augment the logging configuration setup by
Celery then you can use the <a class="reference internal" href="#std-signal-after_setup_logger"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_setup_logger</span></code></a> and
<a class="reference internal" href="#std-signal-after_setup_task_logger"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_setup_task_logger</span></code></a> signals.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>The level of the logging object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>The name of the logfile.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>The log format string.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>Specify if log messages are colored or not.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="after-setup-logger">
<span id="std-signal-after_setup_logger"></span><h4><code class="docutils literal notranslate"><span class="pre">after_setup_logger</span></code><a class="headerlink" href="#after-setup-logger" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--32-input--1" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--1">中文</label><div class="tab-content docutils container">
<p>在每个全局日志记录器（不包括任务日志记录器）设置完成后发送。
用于增强日志配置。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">logger</span></code></p>
<p>日志记录器对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>日志对象的日志级别。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>日志文件的文件名。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>日志格式字符串。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>指定日志消息是否使用颜色。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--32-input--2" name="tab-set--32" type="radio"><label class="tab-label" for="tab-set--32-input--2">英文</label><div class="tab-content docutils container">
<p>Sent after the setup of every global logger (not task loggers).
Used to augment logging configuration.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">logger</span></code></p>
<p>The logger object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>The level of the logging object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>The name of the logfile.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>The log format string.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>Specify if log messages are colored or not.</p>
</li>
</ul>
</div>
</div>
</section>
<section id="after-setup-task-logger">
<span id="std-signal-after_setup_task_logger"></span><h4><code class="docutils literal notranslate"><span class="pre">after_setup_task_logger</span></code><a class="headerlink" href="#after-setup-task-logger" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--33-input--1" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--1">中文</label><div class="tab-content docutils container">
<p>在每一个任务日志记录器完成设置后发送。
用于增强日志配置。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">logger</span></code></p>
<p>日志记录器对象。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>日志对象的日志级别。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>日志文件的文件名。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>日志格式字符串。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>指定日志消息是否使用颜色。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--33-input--2" name="tab-set--33" type="radio"><label class="tab-label" for="tab-set--33-input--2">英文</label><div class="tab-content docutils container">
<p>Sent after the setup of every single task logger.
Used to augment logging configuration.</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">logger</span></code></p>
<p>The logger object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loglevel</span></code></p>
<p>The level of the logging object.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">logfile</span></code></p>
<p>The name of the logfile.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p>
<p>The log format string.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">colorize</span></code></p>
<p>Specify if log messages are colored or not.</p>
</li>
</ul>
</div>
</div>
</section>
</section>
<section id="id6">
<h3>命令信号<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>Command signals</p>
<section id="user-preload-options">
<span id="std-signal-user_preload_options"></span><h4><code class="docutils literal notranslate"><span class="pre">user_preload_options</span></code><a class="headerlink" href="#user-preload-options" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--34-input--1" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--1">中文</label><div class="tab-content docutils container">
<p>该信号在任何 Celery 命令行程序完成用户 preload 选项解析后发送。</p>
<p>可用于为 <strong class="program">celery</strong> 主命令添加额外的命令行参数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">signals</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery.bin.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">user_options</span><span class="p">[</span><span class="s1">&#39;preload&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Option</span><span class="p">(</span>
    <span class="s1">&#39;--monitoring&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Enable our external monitoring utility, blahblah&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="nd">@signals</span><span class="o">.</span><span class="n">user_preload_options</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_preload_options</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;monitoring&#39;</span><span class="p">]:</span>
        <span class="n">enable_monitoring</span><span class="p">()</span>
</pre></div>
</div>
<p>Sender 是 <code class="xref py py-class docutils literal notranslate"><span class="pre">Command</span></code> 实例，其具体值取决于被调用的程序（例如，对于主命令，它将是 <code class="xref py py-class docutils literal notranslate"><span class="pre">CeleryCommand</span></code> 对象）。</p>
<p>提供的参数有：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">app</span></code></p>
<p>应用实例。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p>
<p>已解析的用户 preload 选项的映射（包含默认值）。</p>
</li>
</ul>
</div>
<input class="tab-input" id="tab-set--34-input--2" name="tab-set--34" type="radio"><label class="tab-label" for="tab-set--34-input--2">英文</label><div class="tab-content docutils container">
<p>This signal is sent after any of the Celery command line programs
are finished parsing the user preload options.</p>
<p>It can be used to add additional command-line arguments to the
<strong class="program">celery</strong> umbrella command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">Celery</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery</span><span class="w"> </span><span class="kn">import</span> <span class="n">signals</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">celery.bin.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">Option</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Celery</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">user_options</span><span class="p">[</span><span class="s1">&#39;preload&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Option</span><span class="p">(</span>
    <span class="s1">&#39;--monitoring&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Enable our external monitoring utility, blahblah&#39;</span><span class="p">,</span>
<span class="p">))</span>

<span class="nd">@signals</span><span class="o">.</span><span class="n">user_preload_options</span><span class="o">.</span><span class="n">connect</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_preload_options</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;monitoring&#39;</span><span class="p">]:</span>
        <span class="n">enable_monitoring</span><span class="p">()</span>
</pre></div>
</div>
<p>Sender is the <code class="xref py py-class docutils literal notranslate"><span class="pre">Command</span></code> instance, and the value depends
on the program that was called (e.g., for the umbrella command it'll be
a <code class="xref py py-class docutils literal notranslate"><span class="pre">CeleryCommand</span></code>) object).</p>
<p>Provides arguments:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">app</span></code></p>
<p>The app instance.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code></p>
<p>Mapping of the parsed user preload options (with default values).</p>
</li>
</ul>
</div>
</div>
</section>
</section>
<section id="id7">
<h3>弃用信号<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Deprecated Signals</p>
<section id="task-sent">
<span id="std-signal-task_sent"></span><h4><code class="docutils literal notranslate"><span class="pre">task_sent</span></code><a class="headerlink" href="#task-sent" title="Link to this heading">¶</a></h4>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--35-input--1" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--1">中文</label><div class="tab-content docutils container">
<p>此信号已弃用，请改用 <a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a>。</p>
</div>
<input class="tab-input" id="tab-set--35-input--2" name="tab-set--35" type="radio"><label class="tab-label" for="tab-set--35-input--2">英文</label><div class="tab-content docutils container">
<p>This signal is deprecated, please use <a class="reference internal" href="#std-signal-after_task_publish"><code class="xref std std-signal docutils literal notranslate"><span class="pre">after_task_publish</span></code></a> instead.</p>
</div>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="testing.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">使用 Celery 进行测试</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="concurrency/gevent.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">gevent 并发</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2009-2023, Ask Solem &amp; contributors
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">信号</a><ul>
<li><a class="reference internal" href="#signal-basics">基础</a></li>
<li><a class="reference internal" href="#signal-ref">信号</a><ul>
<li><a class="reference internal" href="#task">Task 信号</a><ul>
<li><a class="reference internal" href="#before-task-publish"><code class="docutils literal notranslate"><span class="pre">before_task_publish</span></code></a></li>
<li><a class="reference internal" href="#after-task-publish"><code class="docutils literal notranslate"><span class="pre">after_task_publish</span></code></a></li>
<li><a class="reference internal" href="#task-prerun"><code class="docutils literal notranslate"><span class="pre">task_prerun</span></code></a></li>
<li><a class="reference internal" href="#task-postrun"><code class="docutils literal notranslate"><span class="pre">task_postrun</span></code></a></li>
<li><a class="reference internal" href="#task-retry"><code class="docutils literal notranslate"><span class="pre">task_retry</span></code></a></li>
<li><a class="reference internal" href="#task-success"><code class="docutils literal notranslate"><span class="pre">task_success</span></code></a></li>
<li><a class="reference internal" href="#task-failure"><code class="docutils literal notranslate"><span class="pre">task_failure</span></code></a></li>
<li><a class="reference internal" href="#task-internal-error"><code class="docutils literal notranslate"><span class="pre">task_internal_error</span></code></a></li>
<li><a class="reference internal" href="#task-received"><code class="docutils literal notranslate"><span class="pre">task_received</span></code></a></li>
<li><a class="reference internal" href="#task-revoked"><code class="docutils literal notranslate"><span class="pre">task_revoked</span></code></a></li>
<li><a class="reference internal" href="#task-unknown"><code class="docutils literal notranslate"><span class="pre">task_unknown</span></code></a></li>
<li><a class="reference internal" href="#task-rejected"><code class="docutils literal notranslate"><span class="pre">task_rejected</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#app">App 信号</a><ul>
<li><a class="reference internal" href="#import-modules"><code class="docutils literal notranslate"><span class="pre">import_modules</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#worker">Worker 信号</a><ul>
<li><a class="reference internal" href="#celeryd-after-setup"><code class="docutils literal notranslate"><span class="pre">celeryd_after_setup</span></code></a></li>
<li><a class="reference internal" href="#celeryd-init"><code class="docutils literal notranslate"><span class="pre">celeryd_init</span></code></a></li>
<li><a class="reference internal" href="#worker-init"><code class="docutils literal notranslate"><span class="pre">worker_init</span></code></a></li>
<li><a class="reference internal" href="#worker-before-create-process"><code class="docutils literal notranslate"><span class="pre">worker_before_create_process</span></code></a></li>
<li><a class="reference internal" href="#worker-ready"><code class="docutils literal notranslate"><span class="pre">worker_ready</span></code></a></li>
<li><a class="reference internal" href="#heartbeat-sent"><code class="docutils literal notranslate"><span class="pre">heartbeat_sent</span></code></a></li>
<li><a class="reference internal" href="#worker-shutting-down"><code class="docutils literal notranslate"><span class="pre">worker_shutting_down</span></code></a></li>
<li><a class="reference internal" href="#worker-process-init"><code class="docutils literal notranslate"><span class="pre">worker_process_init</span></code></a></li>
<li><a class="reference internal" href="#worker-process-shutdown"><code class="docutils literal notranslate"><span class="pre">worker_process_shutdown</span></code></a></li>
<li><a class="reference internal" href="#worker-shutdown"><code class="docutils literal notranslate"><span class="pre">worker_shutdown</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#beat">Beat 信号</a><ul>
<li><a class="reference internal" href="#beat-init"><code class="docutils literal notranslate"><span class="pre">beat_init</span></code></a></li>
<li><a class="reference internal" href="#beat-embedded-init"><code class="docutils literal notranslate"><span class="pre">beat_embedded_init</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">事件信号</a><ul>
<li><a class="reference internal" href="#eventlet-pool-started"><code class="docutils literal notranslate"><span class="pre">eventlet_pool_started</span></code></a></li>
<li><a class="reference internal" href="#eventlet-pool-preshutdown"><code class="docutils literal notranslate"><span class="pre">eventlet_pool_preshutdown</span></code></a></li>
<li><a class="reference internal" href="#eventlet-pool-postshutdown"><code class="docutils literal notranslate"><span class="pre">eventlet_pool_postshutdown</span></code></a></li>
<li><a class="reference internal" href="#eventlet-pool-apply"><code class="docutils literal notranslate"><span class="pre">eventlet_pool_apply</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5">日志信号</a><ul>
<li><a class="reference internal" href="#setup-logging"><code class="docutils literal notranslate"><span class="pre">setup_logging</span></code></a></li>
<li><a class="reference internal" href="#after-setup-logger"><code class="docutils literal notranslate"><span class="pre">after_setup_logger</span></code></a></li>
<li><a class="reference internal" href="#after-setup-task-logger"><code class="docutils literal notranslate"><span class="pre">after_setup_task_logger</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6">命令信号</a><ul>
<li><a class="reference internal" href="#user-preload-options"><code class="docutils literal notranslate"><span class="pre">user_preload_options</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">弃用信号</a><ul>
<li><a class="reference internal" href="#task-sent"><code class="docutils literal notranslate"><span class="pre">task_sent</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=8156d91f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5eb1bb1e"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>